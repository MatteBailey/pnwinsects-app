(function(){var a=function(){return this}.call();a.Z={}})(),Z.showImage=function(b,a,c){Z.Utils.addCrossBrowserPrototypes(),Z.Utils.addCrossBrowserMethods(),Z.Utils.addCrossBrowserEvents(),Z.Utils.declareGlobals(),Z.pageContainerID=b,Z.imagePath=Z.Utils.removeTrailingSlashCharacters(a),Z.parameters=Z.Utils.parseParameters(c),Z.Utils.addEventListener(document,"DOMContentLoaded",Z.initialize),Z.Utils.addEventListener(window,"load",Z.initialize)},Z.initialize=function(){arguments.callee.done||(arguments.callee.done=!0,Z.Utils.detectBrowserInfo(),Z.Utils.setParameters(Z.parameters),Z.Viewer=new Z.ZoomifyImageViewer,Z.Utils.isStrVal(Z.copyrightPath)?Z.Utils.enforceCopyright():Z.Viewer.configureViewer(),Z.debug!=0&&Z.Utils.trace(Z.Utils.getResource("DEFAULT_TRACEDISPLAYDEBUGINFOTEXT")))},Z.ZoomifyImageViewer=function(){Z.ViewerDisplay=Z.Utils.createContainerElement("div","ViewerDisplay","inline-block","relative","hidden","100%","100%","0px","0px","none","0px","transparent none","0px","0px","normal","pointer"),Z.pageContainer=document.getElementById(Z.pageContainerID);var a=Z.Utils.getElementStyle(Z.pageContainer);Z.viewerW=parseFloat(a.width),Z.viewerH=parseFloat(a.height),isNaN(Z.viewerW)&&(Z.viewerW=Z.ViewerDisplay.clientWidth),isNaN(Z.viewerH)&&(Z.viewerH=Z.ViewerDisplay.clientHeight),Z.pageContainer.innerHTML="",Z.pageContainer.appendChild(Z.ViewerDisplay),this.configureViewer=function(){Z.Viewport=new Z.ZoomifyViewport},this.configureComponents=function(){Z.toolbarVisible>0&&(Z.Toolbar=new Z.ZoomifyToolbar(Z.Viewport)),Z.navigatorVisible>0&&(Z.Navigator=new Z.ZoomifyNavigator(Z.Viewport)),Z.Navigator&&Z.Navigator.validateNavigatorGlobals()},this.setSizeAndPosition=function(g,c,h,f,b){Z.viewerW=g,Z.viewerH=c,Z.ViewerDisplay.style.width=g+"px",Z.ViewerDisplay.style.height=c+"px",Z.Viewport&&Z.Viewport.getInitialized()&&Z.Viewport.setSizeAndPosition(g,c,h,f);var d=Z.toolbarPosition==1?c-Z.toolbarH:0;Z.ToolbarDisplay&&Z.Toolbar.getInitialized()&&(Z.Toolbar.setSizeAndPosition(g,null,null,d),Z.toolbarVisible>1&&Z.Toolbar.show(!0)),Z.NavigatorDisplay&&Z.Navigator.getInitialized()&&(Z.Navigator.setSizeAndPosition(null,null,h,f,Z.navigatorFit),Z.navigatorVisible>1&&Z.Navigator.setVisibility(!0)),b&&Z.Viewport.updateView(!0)},this.setImagePath=function(d,b){if(Z.Viewport&&Z.Viewport.getInitialized()){Z.Viewport.zoomAndPanAllStop(!0),Z.imagePath=Z.Utils.removeTrailingSlashCharacters(d);if(b==null){var f=new Z.NetConnector;Z.Viewport.loadImageProperties(f)}else{var c=Z.Utils.convertXMLTextToXMLDoc(b);Z.Viewport.parseImageXML(c)}}},this.setHotspotPath=function(b){Z.Viewport&&Z.Viewport.getInitialized()&&Z.Viewport.setHotspotPath(b)}},Z.ZoomifyViewport=function(){function au(d,g,b,i,a,k,e){Z.imageW=d,Z.imageH=g,eu=a,ek=k,eC=e,ep=i,eM=b,dJ(),c9(),dN=a1(e9,Z.initialZ),ff=a1(fb,Z.initialZ),eO=ff,Z.useCanvas&&ea.scale(ff,ff),fo&&cR(),eN&&aL(),fD(),bh(Z.initialX,Z.initialY,Z.initialZ),Z.fullPageInitial&&eH.toggleFullPageView(!0),e6(),cw(!0),Z.Viewer.configureComponents()}function az(i,d,g,b,h,a,k){cw(!1),cG(),Z.imageW=i,Z.imageH=d,eu=h,ek=a,eC=k,ep=b,eM=g,dJ(),c9(),dN=a1(e9,Z.initialZ),ff=a1(fb,Z.initialZ),eO=ff,Z.useCanvas&&(ea.restore(),ea.scale(ff,ff)),eF&&bH(eF),fh&&bH(fh),e3&&bH(e3),fo&&bH(fo),eN&&bH(eN),el&&bH(el),eQ&&bH(eQ),fo&&cR(),eN&&aL(),fD(),aT(aR,cK,dS,bg),bh(Z.initialX,Z.initialY,Z.initialZ),cw(!0),Z.navigatorVisible>0&&Z.Navigator.setImagePath(Z.imagePath)}function cG(){fG=1,fb=0,e9=0,aW=[],b9=[],bo=[],c4=[],a7=[],bV=[],aM=[],fw=[],dD=[],cA=[],ee=[],dd=[],bL=[],dY=[],aC=[],cm=[],dq=[],fI=0,fo&&(dB=[],aU=[]),eN&&(cN=[],dW=[],eE!=null?bf=[]:(fy=[],eh=[],df=[],dF=[],cC=[]))}function aa(){return ef}function cw(a){ef=a}function dz(){em=Z.Utils.createContainerElement("div","viewportContainer","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent none","0px","0px","normal"),Z.ViewerDisplay.appendChild(em),eI=em,ec=eI.style,ev=Z.Utils.createContainerElement(Z.useCanvas?"canvas":"div","viewportBackfillDisplay","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent none","0px","0px","normal"),em.appendChild(ev),eF=ev,d9=eF.style,eb=Z.Utils.createContainerElement(Z.useCanvas?"canvas":"div","viewportDisplay","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent none","0px","0px","normal"),em.appendChild(eb),fh=eb,eX=fh.style,Z.useCanvas&&(eW=Z.Utils.createContainerElement("canvas","transitionDisplay","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent none","0px","0px","normal"),em.appendChild(eW),e3=eW,fk=e3.style),Z.Utils.isStrVal(Z.watermarkPath)&&(e7=Z.Utils.createContainerElement("div","watermarkDisplay","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent none","0px","0px","normal"),em.appendChild(e7),fo=e7,e2=fo.style);if(Z.Utils.isStrVal(Z.hotspotPath)||Z.Utils.isStrVal(Z.annotationPath)){Z.Utils.isStrVal(Z.annotationPath)&&Z.useCanvas&&(fc=Z.Utils.createContainerElement("canvas","drawingDisplay","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent none","0px","0px","normal"),em.appendChild(fc),el=fc,eY=el.style,Z.editMode&&(d8=Z.Utils.createContainerElement("canvas","editingDisplay","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent none","0px","0px","normal"),em.appendChild(d8),eQ=d8,eP=eQ.style)),e5=Z.Utils.createContainerElement("div","hotspotDisplay","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent none","0px","0px","normal"),em.appendChild(e5),eN=e5,fj=eN.style}Z.useCanvas?(eK=eF.getContext("2d"),ea=fh.getContext("2d"),ez=e3.getContext("2d")):(eF.innerHTML="",fh.innerHTML=""),fo&&(fo.innerHTML=""),eN&&(eN.innerHTML=""),el&&(eT=el.getContext("2d")),eQ&&(eR=eQ.getContext("2d"))}function aT(g,l,d,b){if(typeof d=="undefined"||d===null){d=0}if(typeof b=="undefined"||b===null){b=0}aR=g,cK=l,dh=aR*dx,dH=cK*dx,ac=dh/2,aH=dH/2,c7=-((dh-aR)/2)+d,fB=(dh-aR)/2+d,a2=-((dH-cK)/2)+b,cU=(dH-cK)/2+b,eI.width=dh,eI.height=dH,ec.width=dh+"px",ec.height=dH+"px",ec.left=c7+"px",ec.top=a2+"px",fh.width=dh,fh.height=dH,fo&&(fo.width=dh,fo.height=dH,e2.width=dh+"px",e2.height=dH+"px");if(eN){eN.width=dh,eN.height=dH,fj.width=dh+"px",fj.height=dH+"px";if(e0){var f=parseInt(Z.Utils.getResource("DEFAULT_HOTSPOTLISTWIDTH"),10),m=fR(d6,f,aR,cK);fe.left=m.x+"px",fe.top=m.y+"px"}}el&&(el.width=dh,el.height=dH,eY.width=dh+"px",eY.height=dH+"px"),eQ&&(eQ.width=dh,eQ.height=dH,eP.width=dh+"px",eP.height=dH+"px");if(fm){var c=parseInt(Z.Utils.getResource("DEFAULT_ANNOTATIONPANELWIDTH"),10),k=parseInt(Z.Utils.getResource("DEFAULT_ANNOTATIONPANELHEIGHT"),10),h=c5(aY,c,k,aR,cK);fg.left=h.x+"px",fg.top=h.y+"px"}Z.useCanvas&&(ea.translate(ac,aH),ea.save(),el&&(eT.translate(ac,aH),eT.save()),eQ&&(eR.translate(ac,aH),eR.save()))}function cM(b){if(Z.tileSource=="ZoomifyImageFolder"){var a=Z.Utils.cacheProofPath(Z.imagePath+"/ImageProperties.xml");b.loadXML(a)}else{Z.tileSource=="ZoomifyImageFile"?bj(b):Z.tileSource=="OtherTileSource"&&dk(b)}}function dU(p){if(typeof eH.getInitialized=="undefined"){var d=window.setTimeout(function(){dU(p)},100)}else{var b,g,q,c,m,k,h,e;Z.tileSource=="ZoomifyImageFolder"?(b=parseInt(p.documentElement.getAttribute("WIDTH"),10),g=parseInt(p.documentElement.getAttribute("HEIGHT"),10),c=parseInt(p.documentElement.getAttribute("NUMTILES"),10),m=parseInt(p.documentElement.getAttribute("NUMIMAGES"),10),k=parseInt(p.documentElement.getAttribute("VERSION"),10),q=parseInt(p.documentElement.getAttribute("TILESIZE"),10)):Z.tileSource=="ZoomifyImageFile"&&(b=parseInt(p.documentElement.getAttribute("WIDTH"),10),g=parseInt(p.documentElement.getAttribute("HEIGHT"),10),q=parseInt(p.documentElement.getAttribute("TILESIZE"),10),c=parseInt(p.documentElement.getAttribute("NUMTILES"),10),m=parseInt(p.documentElement.getAttribute("NUMIMAGES"),10),k=parseInt(p.documentElement.getAttribute("VERSION"),10),h=parseInt(p.documentElement.getAttribute("HEADERSIZE"),10),e=1060+h),!isNaN(b)&&b>0&&!isNaN(g)&&g>0&&!isNaN(q)&&q>0?eH.getInitialized()?az(b,g,q,c,k,h,e):au(b,g,q,c,k,h,e):Z.Utils.showMessage(Z.Utils.getResource("ERROR_IMAGEXMLINVALID"))}}function bj(f){var b=1,g=0,d=1060,a=Z.imagePath.replace(".","%2E"),c=Z.tileHandlerPathFull+"?file="+a+"&requestType="+b+"&begin="+g+"&end="+d;f.loadXML(c)}function dk(a){}function dJ(){var a=ae();a!=ep&&(a=aJ(),a!=ep&&Z.Utils.showMessage(Z.Utils.getResource("ERROR_IMAGETILECOUNTINVALID")))}function ae(){var c=Z.imageW,a=Z.imageH;while(c>eM||a>eM){c/=2,a/=2,fG++}c=Z.imageW,a=Z.imageH;var d=0;for(var b=fG-1;b>=0;b--){bo[b]=c,c4[b]=a,a7[b]=Math.ceil(bo[b]/eM),bV[b]=Math.ceil(c4[b]/eM),aM[b]=a7[b]*bV[b],c/=2,a/=2,d+=aM[b]}return d}function aJ(){bo=[],c4=[],a7=[],bV=[],fG=0;var d="DIV2",b=Z.imageW,f=Z.imageH;fG=1;var c=2;while(b>eM||f>eM){d=="Div2"?(b=Math.floor(b/2),f=Math.floor(f/2)):d=="Plus1Div2"?(b=Math.floor((b+1)/2),f=Math.floor((f+1)/2)):(b=Math.floor(Z.imageW/c),f=Math.floor(Z.imageH/c),c*=2,b%2&&b++,f%2&&f++),fG++}b=Z.imageW,f=Z.imageH,c=2,tileCounter=0;for(var a=fG-1;a>=0;a--){a7[a]=Math.floor(b/eM),b%eM&&a7[a]++,bV[a]=Math.floor(f/eM),f%eM&&bV[a]++,aM[a]=a7[a]*bV[a],tileCounter+=aM[a],bo[a]=b,c4[a]=f,d=="Div2"?(b=Math.floor(b/2),f=Math.floor(f/2)):d=="Plus1Div2"?(b=Math.floor((b+1)/2),f=Math.floor((f+1)/2)):(b=Math.floor(Z.imageW/c),f=Math.floor(Z.imageH/c),c*=2,b%2&&b++,f%2&&f++)}return tileCounter}function c9(){var f=parseFloat(Z.Utils.getResource("DEFAULT_INITIALX")),b=parseFloat(Z.Utils.getResource("DEFAULT_INITIALY")),g=parseFloat(Z.Utils.getResource("DEFAULT_INITIALZOOM")),d=parseFloat(Z.Utils.getResource("DEFAULT_MINZOOM")),a=parseFloat(Z.Utils.getResource("DEFAULT_MAXZOOM"));niX=isNaN(f)?null:f,niY=isNaN(b)?null:b,niZ=isNaN(g)?null:g,nmnZ=isNaN(d)?null:d,nmxZ=isNaN(a)?null:a;if(!Z.parameters){Z.initialX=niX,Z.initialY=niY,Z.initialZ=niZ,Z.minZ=nmnZ,Z.maxZ=nmxZ}else{var c=Z.parameters.toString();c.indexOf("zInitialX")==-1&&(Z.initialX=niX),c.indexOf("zInitialY")==-1&&(Z.initialY=niY),c.indexOf("zInitialZoom")==-1&&(Z.initialZ=niZ),c.indexOf("zMinZ")==-1&&(Z.minZ=nmnZ),c.indexOf("zMaxZ")==-1&&(Z.maxZ=nmxZ)}Z.initialX==null&&(Z.initialX=Z.imageW/2),Z.initialY==null&&(Z.initialY=Z.imageH/2),Z.fitZ=cJ(),Z.initialZ==null&&(Z.initialZ=Z.fitZ),Z.minZ==null&&(Z.minZ=Z.fitZ),Z.maxZ==null&&(Z.maxZ=Z.fitZ),Z.initialZ<Z.minZ&&(Z.initialZ=Z.minZ),Z.initialZ>Z.maxZ&&(Z.initialZ=Z.maxZ)}function fD(){a4(cu),fG>ax&&(a4(fS),fG>ap&&a4(cE)),b9.sort(),b9=Z.Utils.removeDups(b9),bR(b9,eB,0,"backfill")}function a4(d){var b=a7[d]-1,f=bV[d]-1;for(var c=0;c<=f;c++){for(var a=0;a<=b;a++){b9.push(d+"-"+a+"-"+c)}}}function cW(b,a){}function ak(b){var e=!1;if(b||parseFloat(eX.width)!=fh.width){Z.useCanvas&&(eX.width=fh.width+"px",eX.height=fh.height+"px",eX.left="0px",eX.top="0px",ea.restore(),ea.save(),ea.scale(ff,ff),el&&(eY.width=el.width+"px",eY.height=el.height+"px",eY.left="0px",eY.top="0px"),eQ&&(eP.width=eQ.width+"px",eP.height=eQ.height+"px",eP.left="0px",eP.top="0px")),e=!0}if(b||parseFloat(ec.left)!=c7||parseFloat(ec.top)!=a2){var d=parseFloat(ec.left)-c7,a=parseFloat(ec.top)-a2;ec.left=c7+"px",ec.top=a2+"px",bB=parseFloat(d9.left)+d,cO=parseFloat(d9.top)+a,d9.left=bB+"px",d9.top=cO+"px";var c=eH.getZoom();Z.imageX=Z.imageX-d/c,Z.imageY=Z.imageY-a/c,e=!0}e&&ch(fh,fb,cA,"centerOut",!1,"1. Updating view: resetting display positions")}function e8(){ff!=eO&&(Z.imageZ=ce),Z.imageZ<Z.minZ&&(Z.imageZ=Z.minZ);var b=eG,a=fG;while(b/2>=Z.imageZ){a--,b/=2}a=a-1<0?0:a-1;var c=a1(a,Z.imageZ);if(a!=fb||c!=ff){Z.useCanvas&&(ea.restore(),ea.save(),ea.scale(c,c)),fb!=a&&(eZ=!0),fb=a,ff=c}eO=ff}function bD(){e9=fb>ap?cE:fb>ax?fS:cu,dN=a1(e9,Z.imageZ),tierBackfillW=bo[e9],tierBackfillH=c4[e9],eF.width=tierBackfillW,eF.height=tierBackfillH;var c=tierBackfillW*dN,a=tierBackfillH*dN,d=Z.imageX*Z.imageZ,b=Z.imageY*Z.imageZ;ah=c,e4=a,bB=ac-d,cO=aH-b,Z.useCanvas&&(d9.width=ah+"px",d9.height=e4+"px"),d9.left=bB+"px",d9.top=cO+"px"}function cQ(){var g=d4();for(var l=g.top,d=g.bottom;l<=d;l++){for(var b=g.left,f=g.right;b<=f;b++){dD.push(fb+"-"+b+"-"+l)}}ee.sort(),dD.sort(),ee=Z.Utils.removeDups(ee),dD=Z.Utils.removeDups(dD),Z.debug==2&&Z.Utils.trace("Tiles required: "+dD.join(", "));var m=Z.Utils.intersect(dD,ee);dD=Z.Utils.subtract(dD,ee),fI=tilesLoadingNamesLength=dD.length,Z.ToolbarDisplay&&Z.Toolbar.getInitialized()&&Z.Toolbar.updateProgress(fI,tilesLoadingNamesLength),ee=Z.Utils.subtract(ee,m),ee=ee.concat(m);if(tilesLoadingNamesLength!=0){for(var c=0,k=fw.length;c<k;c++){var h=fw[c];h.alpha=1}fw=[]}}function ch(v,z,g,b,m,A){if(g.length>0){var d=d4();m||bH(v);if(b=="canvasCopy"){bH(fh),ea.restore(),ea.save(),ea.scale(1,1),ea.drawImage(e3,-ac,-aH),ea.restore(),ea.save(),ea.scale(ff,ff)}else{if(b=="centerOut"){var y=Math.floor(g.length/2);for(var x=y,q=g.length;x<q;x++){var k=g[x];k&&k.t==z&&(z==e9||k.c>=d.left&&k.c<=d.right&&k.r>=d.top&&k.r<=d.bottom)&&d5(v,z,k);if(g.length-x-1!=x){var k=g[g.length-x-1];k&&k.t==z&&(z==e9||k.c>=d.left&&k.c<=d.right&&k.r>=d.top&&k.r<=d.bottom)&&d5(v,z,k)}}}else{for(var x=0,q=g.length;x<q;x++){var k=g[x];k&&k.t==z&&(z==e9||k.c>=d.left&&k.c<=d.right&&k.r>=d.top&&k.r<=d.bottom)&&d5(v,z,k)}}}if(Z.debug==2&&v.id=="viewportDisplay"){var w=[];for(var x=0,q=g.length;x<q;x++){k&&g[x].t==z&&(z==e9||g[x].c>=d.left&&g[x].c<=d.right&&g[x].r>=d.top&&g[x].r<=d.bottom)&&w.push(g[x].name)}w.length>0&&(w.sort(),w=Z.Utils.removeDups(w));var p=w.length>0?w.join(", "):"No cached tiles to redisplay";Z.Utils.trace("Tiles redisplaying - "+A+": "+p)}}}function fu(f,b){var g=d4();e3.width=fh.width,e3.height=fh.height,fk.width=eX.width,fk.height=eX.height,fk.left=eX.left,fk.top=eX.top,ez.restore(),ez.save(),ez.translate(ac,aH),ez.scale(ff,ff);for(var d=0,a=b.length;d<a;d++){var c=b[d];c&&c.t==f&&(f==e9||c.c>=g.left&&c.c<=g.right&&c.r>=g.top&&c.r<=g.bottom)&&d5(e3,f,c)}}function bR(m,v,d,b){if(m.length>0){var h=(new Date).getTime();if(d){var w=Math.floor(m.length/2);for(var c=w,q=m.length;c<q;c++){var p=m[c];if(p){var k=new be(p,b);dK(k,h,v)}if(m.length-c-1!=c){var p=m[m.length-c-1];if(p){var k=new be(p,b);dK(k,h,v)}}}}else{for(var c=0,q=m.length;c<q;c++){var p=m[c];if(p){var k=new be(p,b);dK(k,h,v)}}}var g=typeof b!="undefined"&&b!==null?" - "+b+": ":": ";Z.debug==2&&g!=" - backfill: "&&Z.Utils.trace("Tiles to be requested"+g+m.join(", "))}else{Z.debug==2&&Z.Utils.trace("No new tiles requested.")}}function bH(b){if(b){if(Z.useCanvas&&b.tagName=="CANVAS"){var a=b.getContext("2d");a.save(),a.setTransform(1,0,0,1,0,0),a.clearRect(0,0,a.canvas.width,a.canvas.height),a.restore()}else{while(b.hasChildNodes()){b.removeChild(b.lastChild)}}}}function b1(){if(Z.ToolbarDisplay&&Z.Toolbar.getInitialized()){var a=eH.getZoom();Z.Toolbar.syncSliderToViewport(a)}}function b7(){Z.Navigator&&Z.Navigator.getInitialized()&&Z.Navigator.syncToViewport()}function eA(){return new bx(c0(),fb)}function d4(){return new bx(fP(),fb)}function c0(){var p=parseFloat(ec.left)-c7,d=parseFloat(ec.top)-a2;if(Z.useCanvas){var b=parseFloat(ec.width)/eI.width;p/=b,d/=b}var g=eH.getZoom();p!=0&&(p/=g),d!=0&&(d/=g);var q=Z.imageX-p,c=Z.imageY-d,m=-(aR/2),k=aR/2,h=-(cK/2),e=cK/2;return new bd(q,c,m,k,h,e,g)}function fP(){var p=parseFloat(ec.left)-c7,d=parseFloat(ec.top)-a2;if(Z.useCanvas){var b=parseFloat(ec.width)/eI.width;p/=b,d/=b}var g=eH.getZoom();p!=0&&(p/=g),d!=0&&(d/=g);var q=Z.imageX-p,c=Z.imageY-d,m=-(dh/2),k=dh/2,h=-(dH/2),e=dH/2;return new bd(q,c,m,k,h,e,g)}function bx(f,b){var h=dV(b,1),d=Math.floor(f.left*h/eM),a=Math.floor(f.right*h/eM),c=Math.floor(f.top*h/eM),g=Math.floor(f.bottom*h/eM);d<0&&(d=0),a>a7[fb]-1&&(a=a7[fb]-1),c<0&&(c=0),g>bV[fb]-1&&(g=bV[fb]-1),this.left=d,this.right=a,this.top=c,this.bottom=g}function bd(f,b,h,d,a,c,g){this.left=f+h/g,this.right=f+d/g,this.top=b+a/g,this.bottom=b+c/g}function dV(b,a){var c=a*(bo[b]/Z.imageW);return c}function a1(b,a){var c=a/(bo[b]/Z.imageW);return c}function cj(c,a){var d=c-Z.Utils.getElementPosition(Z.ViewerDisplay).x,b=a-Z.Utils.getElementPosition(Z.ViewerDisplay).y;return new Z.Utils.Point(d,b)}function by(k,p){var d=parseFloat(ec.left)+ac,b=parseFloat(ec.top)+aH,g=k-d,q=p-b,c=g/Z.imageZ,m=q/Z.imageZ,l=Z.imageX+c,h=Z.imageY+m;return new Z.Utils.Point(l,h)}function da(g,l,d){var b=Z.imageX-g,f=Z.imageY-l,m=b*d,c=f*d,k=c7+m,h=a2+c;return new Z.Utils.Point(k,h)}function be(a,b){this.name=a,this.t=parseInt(a.substring(0,a.indexOf("-")),10),this.c=parseInt(a.substring(a.indexOf("-")+1,a.lastIndexOf("-")),10),this.r=parseInt(a.substring(a.lastIndexOf("-")+1),10),this.x=Math.floor(this.c*eM),this.y=Math.floor(this.r*eM),this.image=null,this.alpha=0,this.url=eH.formatTilePath(this.t,this.c,this.r,b),this.loadTime=null,this.elmt=null,this.style=null}function b2(d,b,g){var c=0;for(var a=fG-1;a>=d;a--){c+=aM[a]}c+=g*a7[d]+b;var f=Math.floor(c/ej);return f}function aQ(f,b,h){dY[f]=h;var d=2,a=Z.imagePath.replace(".","%2E"),c=Z.tileHandlerPathFull+"?file="+a+"&requestType="+d+"&begin="+f+"&end="+b,g=new Z.NetConnector;g.loadXML(c)}function fE(c){for(var a=0,d=aC.length;a<d;a++){var b=aC[a].split(",");b[0]==c&&(b[4]!=undefined&&b[4]!="backfill"?cm.push(b[1]+"-"+b[2]+"-"+b[3]):dq.push(b[1]+"-"+b[2]+"-"+b[3]),aC.splice(a,1),a--,d--)}cm.length>0&&(bR(cm,bS,0),Z.debug==2&&Z.Utils.trace("Tiles being requested - offset chunk now loaded: "+cm.join(", "))),dq.length>0&&bR(dq,eB,0,"backfill")}function dK(b,a,c){b.url.substr(0,8)=="skipTile"?cH(b):b.url!="offsetLoading"&&(b.loadTime=a,b.loading=eS.loadImage(b.url,Z.Utils.createCallback(null,c,b),"tile"),Z.debug==2&&Z.Utils.trace("Tile actually requested: "+b.name)),Z.debug==2&&Z.Utils.trace("Tile not yet requested - offset chunk loading in progress: "+b.name)}function cH(b){eJ>0&&(cA.push(b),ee.push(b.name));var a=dD.indexOf(b.name);a!=-1&&dD.splice(a,1),Z.tileSource=="ZoomifyImageFile"&&(a=cm.indexOf(b.name),a!=-1&&cm.splice(a,1)),fw.push(b)}function eB(c,a){if(c&&a){c.image=a;var d=c.name;aW.push(c);var b=b9.indexOf(d);b!=-1&&b9.splice(b,1),Z.tileSource=="ZoomifyImageFile"&&(b=dq.indexOf(d),b!=-1&&dq.splice(b,1)),c.alpha=1,c.t==e9&&d5(eF,e9,c)}else{a==null&&(Z.mobileDevice?console.log(Z.Utils.getResource("ERROR_TILEPATHINVALID")+c.name+".jpg"):Z.Utils.showMessage(Z.Utils.getResource("ERROR_TILEPATHINVALID")+c.name+".jpg"))}}function dl(b,a){if(b&&a){b.image=a;var c=b.name;d5(fh,fb,b)}else{a==null&&(Z.mobileDevice?console.log(Z.Utils.getResource("ERROR_TILEPATHINVALID")+b.name+".jpg"):Z.Utils.showMessage(Z.Utils.getResource("ERROR_TILEPATHINVALID")+b.name+".jpg"))}}function bS(f,b){if(f&&b){f.image=b;var g=f.name;eJ>0&&(cA.push(f),ee.push(g));var d=dD.indexOf(g);d!=-1&&dD.splice(d,1),Z.tileSource=="ZoomifyImageFile"&&(d=cm.indexOf(g),d!=-1&&cm.splice(d,1)),fw.push(f),dG||(dG=window.setInterval(aw,50)),Z.debug==2&&(Z.Utils.trace("Tile received: "+f.name),a==0&&Z.Utils.trace("Tile loading complete: all requested tiles received."));var a=dD.length;if(a==0){if(Z.useCanvas&&eJ>0){if(!eZ){ch(fh,fb,cA,"centerOut",!1,"4. Updating view: all new tiles loaded")}else{fu(fb,cA),ch(fh,fb,cA,"canvasCopy",!1,"4. Updating view: all new tiles loaded");var c=window.setTimeout(function(){bH(e3)},200);eZ=!1}}ee.length>eJ&&aB(),fI=0}Z.ToolbarDisplay&&Z.Toolbar.getInitialized()&&Z.Toolbar.updateProgress(fI,a)}else{b==null&&(Z.mobileDevice?console.log(Z.Utils.getResource("ERROR_TILEPATHINVALID")+f.name+".jpg"):Z.Utils.showMessage(Z.Utils.getResource("ERROR_TILEPATHINVALID")+f.name+".jpg"))}}function d5(f,b,h){if(h.url.substr(0,8)!="skipTile"){var d=h.x,a=h.y,c=dV(b,1);if(Z.useCanvas){if(f==fh||f==e3){d-=Z.imageX*c,a-=Z.imageY*c}aG(f,h,d,a)}else{var g;f==fh?(d-=Z.imageX*c-ac/ff,a-=Z.imageY*c-aH/ff,g=ff):g=dN,cx(f,h,d,a,g)}}}function aG(d,b,f,c){var a=d.getContext("2d");Z.alphaSupported&&b.alpha<1&&d.id!="transitionDisplay"?(a.globalAlpha=b.alpha,a.drawImage(b.image,f,c),a.globalAlpha=1):a.drawImage(b.image,f,c),Z.debug==2&&dA(d,b.name,f,c,ff)}function cx(f,b,g,d,a){b.elmt||(b.elmt=Z.Utils.createContainerElement("img"),b.elmt.onmousedown=Z.Utils.preventDefault,Z.Utils.addEventListener(b.elmt,"contextmenu",Z.Utils.preventDefault),b.elmt.src=b.url,b.style=b.elmt.style,b.style.position="absolute",Z.Utils.renderQuality(b,Z.renderQuality),Z.cssTransformsSupported&&(b.style[Z.cssTransformProperty+"Origin"]="0px 0px")),b.elmt.parentNode!=f&&f.appendChild(b.elmt);var c=b.style;c.display="none",Z.cssTransformsSupported?c[Z.cssTransformProperty]=["matrix(",(b.image.width/b.elmt.width*a).toFixed(8),",0,0,",(b.image.height/b.elmt.height*a).toFixed(8),",",(g*a).toFixed(8),Z.cssTransformNoUnits?",":"px,",(d*a).toFixed(8),Z.cssTransformNoUnits?")":"px)"].join(""):(c.width=b.image.width*a+"px",c.height=b.image.height*a+"px",c.left=g*a+"px",c.top=d*a+"px"),c.display="inline-block",Z.Utils.setOpacity(b,b.alpha),Z.debug==2&&dA(f,b.name,g,d,a)}function dA(d,b,f,c,a){Z.useCanvas?fM(d,b,f,c,a):fa(d,b,f,c,a)}function fM(q,x,d,a,k){var y=parseInt(Z.Utils.getResource("DEFAULT_HOTSPOTCAPTIONFONTSIZE"),10),b=parseInt(Z.Utils.getResource("DEFAULT_MINHOTSPOTCAPTIONFONTSIZE"),10),w=parseInt(Z.Utils.getResource("DEFAULT_MAXHOTSPOTCAPTIONFONTSIZE"),10),p=Math.round(y*k),g=2*(p<b?b:p>w?w:p),v=q.getContext("2d");v.font=g+"px verdana",v.textAlign="left",v.textBaseline="top";var m=eM*k/2;v.fillStyle="#ffffff",v.fillText(x,d+m,a+m),v.fillStyle="#000000",v.fillText(x,d+m+1,a+m+1)}function fa(L,z,E,B,H){var A=parseInt(Z.Utils.getResource("DEFAULT_HOTSPOTCAPTIONFONTSIZE"),10),D=parseInt(Z.Utils.getResource("DEFAULT_MINHOTSPOTCAPTIONFONTSIZE"),10),x=parseInt(Z.Utils.getResource("DEFAULT_MAXHOTSPOTCAPTIONFONTSIZE"),10),K=Math.round(A*H),G=2*(K<D?D:K>x?x:K),N=parseInt(Z.Utils.getResource("DEFAULT_HOTSPOTCAPTIONPADDING"),10)*H,I=Z.Utils.createContainerElement("div","tileNameTextBox","inline-block","absolute","hidden","auto","auto","1px","1px","none","0px","transparent none","0px",N+"px","nowrap"),C=document.createTextNode(z);I.appendChild(C),L.appendChild(I),Z.Utils.setTextStyle(C,"white","verdana",G+"px","none","normal","normal","normal","normal","1em","center","none");var M=Z.Utils.createContainerElement("div","tileNameTextBox2","inline-block","absolute","hidden","auto","auto","1px","1px","none","0px","transparent none","0px",N+"px","nowrap"),q=document.createTextNode(z);M.appendChild(q),L.appendChild(M),Z.Utils.setTextStyle(q,"black","verdana",G+"px","none","normal","normal","normal","normal","1em","center","none");var N=parseFloat(I.style.padding),F=parseFloat(Z.Utils.getElementStyleProperty(I,"width"));if(isNaN(F)){var J=parseFloat(Z.Utils.getResource("DEFAULT_FONTTOPIXELSCONVERSIONFACTOR")),a=parseFloat(I.style.fontSize)/J;F=Math.round(parseFloat(z.length*a))}var O=eM*H/2,k=eM*H/2;I.style.left=E*H+(O-F/2-N)+"px",I.style.top=B*H+k+"px",M.style.left=1+E*H+(O-F/2-N)+"px",M.style.top=1+B*H+k+"px",Z.Utils.addEventListener(I,"contextmenu",Z.Utils.preventDefault),Z.Utils.disableTextInteraction(C),Z.Utils.addEventListener(M,"contextmenu",Z.Utils.preventDefault),Z.Utils.disableTextInteraction(q)}function aw(d){var b=0;for(var f=0,c=fw.length;f<c;f++){var a=fw[f];a.t==fb&&(a.alpha<1?(fA==0?a.alpha=1:a.alpha+=fA,a.alpha>1&&(a.alpha=1),d5(fh,fb,a)):(b++,b>=c&&(window.clearInterval(dG),dG=null),Z.debug==2&&Z.Utils.trace("Fading-in tile complete: "+a.name)))}}function aB(){while(ee.length>eJ&&cA.length>0){j=ee.indexOf(cA[0].name),j!=-1&&ee.splice(j,1),cA.splice(0,1)}}function cJ(){return Z.imageW/Z.imageH>aR/cK?aR/Z.imageW:cK/Z.imageH}function af(g,c,k){if(Z.constrainPan){k===null&&(k=Z.imageZ);var f=new bd(g,c,-(aR/2),aR/2,-(cK/2),cK/2,k),b=f.left,d=f.right,h=f.top,a=f.bottom;Z.imageW*k>aR?b<0?g=aR/2/k:d>Z.imageW&&(g=Z.imageW-aR/2/k):g=Z.imageW/2,Z.imageH*k>cK?h<0?c=cK/2/k:a>Z.imageH&&(c=Z.imageH-cK/2/k):c=Z.imageH/2}return new Z.Utils.Point(g,c)}function cz(p,d){if(Z.constrainPan){var b=eH.getZoom(),g=Z.imageX,q=Z.imageY,c=new bd(g,q,-(aR/2),aR/2,-(cK/2),cK/2,b),m=c.left,k=c.right,h=c.top,e=c.bottom;Z.imageW*b>aR?m<0?p+=m*b:k>Z.imageW&&(p-=(Z.imageW-k)*b):p+=(g-Z.imageW/2)*b,Z.imageH*b>cK?h<0?d+=h*b:e>Z.imageH&&(d-=(Z.imageH-e)*b):d+=(q-Z.imageH/2)*b}return new Z.Utils.Point(p,d)}function dC(p,d){if(Z.constrainPan){var b=eH.getZoom(),g=Z.imageX-(p-c7)/b,q=Z.imageY-(d-a2)/b,c=new bd(g,q,-(aR/2),aR/2,-(cK/2),cK/2,b),m=c.left,k=c.right,h=c.top,e=c.bottom;Z.imageW*b>aR?m<0?p+=m*b:k>Z.imageW&&(p-=(Z.imageW-k)*b):p+=(g-Z.imageW/2)*b,Z.imageH*b>cK?h<0?d+=h*b:e>Z.imageH&&(d-=(Z.imageH-e)*b):d+=(q-Z.imageH/2)*b}return new Z.Utils.Point(p,d)}function aV(a){return a>Z.maxZ?a=Z.maxZ:a<Z.minZ&&(a=Z.minZ),a}function cR(){ab=new Image,cy=parseFloat(Z.Utils.getResource("DEFAULT_WATERMARKALPHA")),ab.url=Z.watermarkPath,ab.onload=dX,ab.onerror=al,ab.src=Z.watermarkPath}function dX(){if(fo){var F=parseFloat(Z.Utils.getResource("DEFAULT_WATERMARKMINSCALE")),K=parseFloat(Z.Utils.getResource("DEFAULT_WATERMARKSPANW")),H=parseFloat(Z.Utils.getResource("DEFAULT_WATERMARKSPANH")),N=eH.getZoom(),G=(Z.imageW*N-fo.width)/2,J=(Z.imageH*N-fo.height)/2,C=(Z.imageW/2-Z.imageX)*N,W=(Z.imageH/2-Z.imageY)*N,Q=N<F?F:N,M=Math.round(Z.imageW/K),U=Math.round(Z.imageH/H),O=fP(),I=ab.width*Q,R=ab.height*Q,B=0,L=0;for(var P=1;P<=M;P++){for(var q=1;q<=U;q++){var V=Math.round(Z.imageW/(M+1)*P),A=Math.round(Z.imageH/(U+1)*q);if(V>O.left&&V<O.right&&A>O.top&&A<O.bottom){var D=Math.round(V*N-I/2-G+C),k=Math.round(A*N-R/2-J+W);if(Z.imageW>4000){var z=B+100,e=L+100;if(D<z&&k<e){continue}B=D,L=k}bm(I,R,D,k)}}}}}function bm(c,a,d,b){dp(c,a,d,b)}function dp(f,b,g,d){var a=ab.cloneNode(!1);Z.Utils.setOpacity(a,cy),a.width=f,a.height=b;var c=Z.Utils.createContainerElement("div","wiC","inline-block","absolute","hidden",f+"px",b+"px",g+"px",d+"px","none","0px","transparent none","0px","0px","normal");c.appendChild(a),fo.appendChild(c),Z.Utils.addEventListener(a,"contextmenu",Z.Utils.preventDefault),Z.Utils.addEventListener(a,"mousedown",Z.Utils.preventDefault)}function dM(){fo&&(bH(fo),dX())}function al(){Z.Utils.showMessage(Z.Utils.getResource("ERROR_WATERMARKPATHINVALID")+this.url)}function aL(){var b;Z.Utils.isStrVal(Z.hotspotPath)?b=Z.Utils.cacheProofPath(Z.hotspotPath+"/"+Z.Utils.getResource("DEFAULT_HOTSPOTSXMLFILE")):Z.Utils.isStrVal(Z.annotationPath)&&(b=Z.Utils.cacheProofPath(Z.annotationPath+"/"+Z.Utils.getResource("DEFAULT_ANNOTATIONSXMLFILE")));var a=new Z.NetConnector;a.loadXML(b)}function dc(z){this.id=z.getAttribute("ID"),this.internalID=parseInt(z.getAttribute("INTERNALID")),this.name=z.getAttribute("NAME"),this.mediaType=z.getAttribute("MEDIATYPE"),this.media=z.getAttribute("MEDIA"),this.image=null,this.iW=null,this.iH=null;var F=parseFloat(z.getAttribute("X"));this.x=isNaN(F)?0:F;var m=parseFloat(z.getAttribute("Y"));this.y=isNaN(m)?0:m;var b=parseFloat(z.getAttribute("ZOOM"));this.zoom=isNaN(b)?-1:b;var w=parseFloat(z.getAttribute("XSCALE"));this.xScale=isNaN(w)?100:w;var G=parseFloat(z.getAttribute("YSCALE"));this.yScale=isNaN(G)?100:G,this.url=z.getAttribute("URL"),this.urlTarget=z.getAttribute("URLTARGET");var k=z.getAttribute("ROLLOVER");this.rollover=k=="1"||k=="true",this.caption=z.getAttribute("CAPTION"),this.tooltip=z.getAttribute("TOOLTIP"),this.textColor="#"+z.getAttribute("TEXTCOLOR"),this.backColor="#"+z.getAttribute("BACKCOLOR"),this.lineColor="#"+z.getAttribute("LINECOLOR"),this.fillColor="#"+z.getAttribute("FILLCOLOR"),this.textVisible=z.getAttribute("TEXTVISIBLE")!="0",this.backVisible=z.getAttribute("BACKVISIBLE")!="0",this.lineVisible=z.getAttribute("LINEVISIBLE")!="0",this.fillVisible=z.getAttribute("FILLVISIBLE")!="0";var E=z.getAttribute("CAPTIONPOSITION");this.captionPosition=Z.Utils.isStrVal(E)?E:"8",this.saved=!0,this.visibility=!0,this.polygonPts=null;if(z.getAttribute("MEDIA")=="polygon"){var C=z.getElementsByTagName("POLYGON"),y=C[0].getElementsByTagName("POINT"),q=[];for(var B=0,x=y.length;B<x;B++){q.push({x:y[B].getAttribute("X"),y:y[B].getAttribute("Y")})}this.polygonPts=q}var g=1,A=2,D=z.getAttribute("MEDIATYPE");this.mediaType=D=="symbol"?g:A}function fH(c){var a=(new Date).getTime();for(var d=0,b=c.length;d<b;d++){a6(c[d],a)}}function a6(b,a){var c=fF.loadImage(b,Z.Utils.createCallback(null,c1,b,a),"hotspot")}function c1(g,c,k){if(g&&c&&k){var f=new bK;for(var b=0,d=cN.length;b<d;b++){if(cN[b].media==g){dW.push(k.cloneNode(!1)),cN[b].image=k.cloneNode(!1),cN[b].iW=k.width,cN[b].iH=k.height;var h=cN[b].x,a=cN[b].y;h>f.bounds.left&&h<f.bounds.right&&a>f.bounds.top&&a<f.bounds.bottom&&cT(cN[b],f)}}}else{Z.Utils.showMessage(Z.Utils.getResource("ERROR_HOTSPOTPATHINVALID"))}}function ao(){eN&&(bH(eN),el&&bH(el),eQ&&bH(eQ),bI())}function fl(){var d=new bK;for(var b=0,f=cN.length;b<f;b++){if(cN[b].media==""||cN[b].media=="polygon"){var c=cN[b].x,a=cN[b].y;c>d.bounds.left&&c<d.bounds.right&&a>d.bounds.top&&a<d.bounds.bottom&&cT(cN[b],d)}}}function bI(){var f=new bK;for(var b=0,g=cN.length;b<g;b++){var d=cN[b].x,a=cN[b].y;d>f.bounds.left&&d<f.bounds.right&&a>f.bounds.top&&a<f.bounds.bottom&&cT(cN[b],f)}if(eN.childNodes.length==0){var c=Z.Utils.createContainerElement("div","hotspotImmortal","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent none","0px","0px","normal");eN.appendChild(c)}}function cT(b,a){b.media=="polygon"&&eU(b,a),cl(b,a)}function cl(B,H){if(!Z.Utils.isStrVal(B.media)&&!Z.Utils.isStrVal(B.caption)||(B.iW==null||B.iH==null)&&B.media!="polygon"&&(el||!Z.Utils.isStrVal(B.caption))){return}var q=cN.indexOfObjectValue("internalID",B.internalID);q!=-1&&fz(cN[q]);if(Z.useCanvas&&B.media=="polygon"){var b=B.polygonPts,y=Z.Utils.getDimensionsFromPolygonPoints(B.polygonPts);B.iW=y.x,B.iH=y.y}if((B.iW===null||B.iH==null)&&B.media!="polygon"&&B.media!=""){return}var I=B.iW*H.constrainedScale*(B.xScale/100/(B.zoom/100)),k=B.iH*H.constrainedScale*(B.yScale/100/(B.zoom/100)),G;B.image&&(G=B.image,G.align="top",G.width=I,G.height=k);var E=Math.round(B.x*H.currentZ-I/2-H.displayOffsetL+H.imageOffsetL),A=Math.round(B.y*H.currentZ-k/2-H.displayOffsetT+H.imageOffsetT),x;Z.Utils.isStrVal(B.caption)&&(x=b4(B,H));var D=Z.Utils.createContainerElement("div","hCloak","inline-block","absolute","visible"),z="hot"+B.internalID.toString(),g=Z.Utils.createContainerElement("div",z,"inline-block","absolute","visible",I+"px",k+"px",E+"px",A+"px","none","0px","transparent none","0px","0px","normal");Z.Utils.isStrVal(B.tooltip)&&(g.title=unescape(B.tooltip));if(Z.Utils.isStrVal(B.url)){if(G){var C=document.createElement("a");C.setAttribute("href",B.url),C.setAttribute("target",B.urlTarget),C.setAttribute("outline","none"),C.appendChild(G),G.style.cursor="help",G.style.border="none"}if(x){var F=document.createElement("a");F.setAttribute("href",B.url),F.setAttribute("target",B.urlTarget),F.setAttribute("outline","none"),F.appendChild(x),x.style.cursor="help"}D.style.border="none"}Z.Utils.isStrVal(B.url)?(C&&D.appendChild(C),F&&D.appendChild(F)):(G&&D.appendChild(G),x&&D.appendChild(x)),g.appendChild(D),eN.appendChild(g),B.rollover&&(D.rollover=B.rollover),c3(g,!B.rollover&&B.visibility);if(x){var w=cc(x,B.captionPosition,I,k);x.style.left=w.x+"px",x.style.top=w.y+"px"}B.rollover&&(Z.Utils.addEventListener(g,"mouseover",aN),Z.Utils.addEventListener(g,"mouseout",fx)),Z.Utils.addEventListener(g,"mousedown",Z.Utils.preventDefault),Z.Utils.addEventListener(g,"contextmenu",Z.Utils.preventDefault)}function fz(b){var a=document.getElementById("hot"+b.internalID);a!==null&&a.parentNode.removeChild(a)}function bU(d){var b=0,f=[];switch(d){case"poi":for(var c=0,a=fy.length;c<a;c++){f.push(fy[c].value)}break;case"note":for(var c=0,a=notesListDP.length;c<a;c++){f.push(notesListDP[c].value)}break;case"label":for(var c=0,a=dF.length;c<a;c++){f.push(dF[c].value)}break;case"labelExternal":for(var c=0,a=cN.length;c<a;c++){f.push(cN[c].id)}break;case"hotspot":for(var c=0,a=cN.length;c<a;c++){f.push(cN[c].internalID)}}f.sort();for(var c=0,a=f.length;c<a;c++){f[c]!=b?c=a:b++}return b}function bK(){this.bounds=fP(),this.currentZ=eH.getZoom(),this.constrainedScale=this.currentZ<fQ?fQ:this.currentZ>bz?bz:this.currentZ,this.displayOffsetL=(Z.imageW*this.currentZ-eN.width)/2,this.displayOffsetT=(Z.imageH*this.currentZ-eN.height)/2,this.imageOffsetL=(Z.imageW/2-Z.imageX)*this.currentZ,this.imageOffsetT=(Z.imageH/2-Z.imageY)*this.currentZ}function b4(g,l){var d=l.constrainedScale*(g.xScale/100/(g.zoom/100)),b=Math.round(ck*d),f=b<fv?fv:b>bT?bT:b,m=bJ*d,c=m<b3?b3:m>b8?b8:m,k=Z.Utils.createContainerElement("div","captionTextBox","inline-block","absolute","hidden","auto","auto","1px","1px","solid","1px","white","0px",c+"px","nowrap"),h=document.createTextNode(unescape(g.caption));return k.appendChild(h),Z.Utils.setTextStyle(h,"black","verdana",f+"px","none","normal","normal","normal","normal","1em","center","none"),Z.Utils.addEventListener(k,"contextmenu",Z.Utils.preventDefault),Z.Utils.disableTextInteraction(h),k}function cc(x,e,b,k){var y=parseFloat(x.style.padding),d=parseFloat(Z.Utils.getElementStyleProperty(x,"width"));if(isNaN(d)){var w=parseFloat(Z.Utils.getResource("DEFAULT_FONTTOPIXELSCONVERSIONFACTOR")),v=parseFloat(x.style.fontSize)/w;d=Math.round(parseFloat(x.firstChild.length*v))}var p=eH.getZoom(),g=20*p,q,m;switch(e){case"1":q=-d-y,m=-g-y;break;case"2":q=(b-d)/2-y,m=-g-y;break;case"3":q=b+y,m=-g-y;break;case"4":q=-d-y,m=(k-g)/2;break;case"5":q=(b-d)/2-y,m=(k-g)/2;break;case"6":q=b+y,m=(k-g)/2;break;case"7":q=-d-y,m=k+y;break;case"8":q=(b-d)/2-y,m=k+y;break;case"9":q=b+y,m=k+y}return new Z.Utils.Point(q,m)}function eL(f,b){var g=parseInt(Z.Utils.getResource("DEFAULT_HOTSPOTLISTWIDTH"),10),d=fR(d6,g,aR,cK),a=d6=="0"?"hidden":"visible",c=document.getElementById("hotspotList");c&&Z.ViewerDisplay.removeChild(c),eE=new Z.Utils.createSelectElement("hotspotList",f,b,g,d.x,d.y,a,dZ),e0=eE,fe=e0.style,Z.ViewerDisplay.appendChild(eE)}function d7(b,a){var c=document.getElementById("hotspotList");c!=null&&(c.options[c.options.length]=new Option(b,a))}function c3(g,c){var k=g.childNodes[0];if(k&&k.style){k.style.visibility="visible";var f=c?"visible":"hidden",b=c?"":"#ffffff",d=c?1:0.01;if(Z.browser!=Z.browsers.IE){k.style.visibility=f}else{k.style.backgroundColor=b,Z.Utils.setOpacity(k,d);var h=g.childNodes[0].childNodes[1];h&&h.style&&(h.style.visibility=f)}var a=cN.indexOfObjectValue("internalID",g.internalID);a!=-1&&(cN[a].visibility=c)}}function fR(f,b,h,d){var a,c,g=25;switch(f){case"0":a=0,c=0;break;case"1":a=g,c=g;break;case"2":a=h-b-g,c=20;break;case"3":a=h-b-g,toolbar!=null?c=d-g:c=d-g;break;case"4":a=g,toolbar!=null?c=d-g:c=d-g;break;default:a=h-b,c=g}return new Z.Utils.Point(a,c)}function bA(a){return Z.Utils.isStrVal(a.media)||Z.Utils.isStrVal(a.caption)}function bk(b){var a="[Hotspot ";return a+="id:"+b.id+", ",a+="internalID:"+b.internalID.toString()+", ",a+="name:"+b.name+", ",a+="mediaType:"+b.mediaType+", ",a+="media:"+b.media+", ",a+="x:"+b.x.toString()+", ",a+="y:"+b.y.toString()+", ",a+="zoom:"+b.zoom.toString()+", ",a+="xScale:"+b.xScale.toString()+", ",a+="yScale:"+b.yScale.toString()+", ",a+="url:"+b.url+", ",a+="urlTarget:"+b.urlTarget+", ",a+="rollover:"+b.rollover+", ",a+="caption:"+b.caption+", ",a+="tooltip:"+b.tooltip,a+="]",a}function dO(bs){var P,Y,U=Z.imageW/2,at=Z.imageH/2,Q="<ZAS></ZAS>",X=Z.Utils.convertXMLTextToXMLDoc(Q),K=X.getElementsByTagName("ZAS")[0],cr=X.createElement("LABELSETUP");cr.setAttribute("PANELPOSITION","2"),cr.setAttribute("INITIALVISIBILITY","1"),cr.setAttribute("NOTEVISIBILITY","1"),cr.setAttribute("MINSCALE","1"),cr.setAttribute("MAXSCALE","1"),K.appendChild(cr);var br=bs.getElementsByTagName("LABELSETUP")[0];P=br.getAttribute("PANELPOSITION"),Z.Utils.isStrVal(P)&&cr.setAttribute("PANELPOSITION",P);var an=br.getAttribute("INITIALVISIBILITY");if(Z.Utils.isStrVal(an)){var ci=Z.Utils.getResource("DEFAULT_HOTSPOTSINITIALVISIBILITY");ci?initVis=an!="0"&&an!="hide"?"1":"0":initVis=an!="1"&&an!="show"?"0":"1",cr.setAttribute("INITIALVISIBILITY",initVis)}var an=br.getAttribute("NOTEVISIBILITY");if(Z.Utils.isStrVal(an)){var ci=Z.Utils.getResource("DEFAULT_ANNOTATIONNOTEVISIBILITY");ci?initVis=an!="0"&&an!="hide"?"1":"0":initVis=an!="1"&&an!="show"?"0":"1",cr.setAttribute("NOTEVISIBILITY",initVis)}P=br.getAttribute("MINSCALE"),Z.Utils.isStrVal(P)&&!isNaN(parseFloat(P))&&parseFloat(P)>0&&cr.setAttribute("MINSCALE",P),P=br.getAttribute("MAXSCALE"),Z.Utils.isStrVal(P)&&!isNaN(parseFloat(P))&&parseFloat(P)>0&&cr.setAttribute("MAXSCALE",P);var bi=bs.getElementsByTagName("POI");for(var W=0,bt=bi.length;W<bt;W++){var J=X.createElement("POI");J.setAttribute("ID","0"),J.setAttribute("NAME",Z.Utils.getResource("CONTENT_POINAME")),J.setAttribute("X","center"),J.setAttribute("Y","center"),J.setAttribute("ZOOM","-1"),J.setAttribute("USER",Z.Utils.getResource("CONTENT_POIUSER")),J.setAttribute("DATE",Z.Utils.getCurrentUTCDateAsString()),K.appendChild(J);var ai=bs.getElementsByTagName("POI")[W];P=ai.getAttribute("ID"),Z.Utils.isStrVal(P)&&J.setAttribute("ID",P),P=ai.getAttribute("NAME"),Z.Utils.isStrVal(P)&&J.setAttribute("NAME",P),P=ai.getAttribute("X"),Z.Utils.isStrVal(P)&&!isNaN(parseFloat(P))&&J.setAttribute("X",P=="center"?U.toString():P),P=ai.getAttribute("Y"),Z.Utils.isStrVal(P)&&!isNaN(parseFloat(P))&&J.setAttribute("Y",P=="center"?at.toString():P),P=ai.getAttribute("ZOOM"),Z.Utils.isStrVal(P)&&!isNaN(parseFloat(P))&&J.setAttribute("ZOOM",P),P=ai.getAttribute("USER"),Z.Utils.isStrVal(P)&&J.setAttribute("USER",P),P=ai.getAttribute("DATE"),Z.Utils.isStrVal(P)&&J.setAttribute("DATE",P),K.appendChild(J),J=K.getElementsByTagName("POI")[W];var bn=bi[W].getElementsByTagName("NOTES")[0];if(bn){var G=X.createElement("NOTES");J.appendChild(G);var cn=bn.getElementsByTagName("NOTE");for(var I=0,M=cn.length;I<M;I++){var z=X.createElement("NOTE");z.setAttribute("ID","0"),z.setAttribute("NAME",Z.Utils.getResource("CONTENT_NOTENAME")),z.setAttribute("TEXT",Z.Utils.getResource("CONTENT_NOTETEXT")),z.setAttribute("USER",Z.Utils.getResource("CONTENT_NOTEUSER")),z.setAttribute("DATE",Z.Utils.getCurrentUTCDateAsString()),G.appendChild(z);var H=bn.getElementsByTagName("NOTE")[I];P=H.getAttribute("ID"),Z.Utils.isStrVal(P)&&z.setAttribute("ID",P),P=H.getAttribute("NAME"),Z.Utils.isStrVal(P)&&z.setAttribute("NAME",P),P=H.getAttribute("TEXT"),Z.Utils.isStrVal(P)&&z.setAttribute("TEXT",P),P=H.getAttribute("USER"),Z.Utils.isStrVal(P)&&z.setAttribute("USER",P),P=H.getAttribute("DATE"),Z.Utils.isStrVal(P)&&z.setAttribute("DATE",P),G.appendChild(z)}}var q=bi[W].getElementsByTagName("LABELS")[0];if(q){var D=X.createElement("LABELS");J.appendChild(D);var R=q.getElementsByTagName("LABEL");for(var ar=0,F=R.length;ar<F;ar++){var V=X.createElement("LABEL");V.setAttribute("INTERNALID","0"),V.setAttribute("ID","0"),V.setAttribute("NAME",Z.Utils.getResource("CONTENT_LABELNAME")),V.setAttribute("MEDIATYPE","url"),V.setAttribute("MEDIA","circle"),V.setAttribute("X","center"),V.setAttribute("Y","center"),V.setAttribute("ZOOM","100"),V.setAttribute("XSCALE","100"),V.setAttribute("YSCALE","100"),V.setAttribute("URL",""),V.setAttribute("URLTARGET","_blank"),V.setAttribute("ROLLOVER","0"),V.setAttribute("CAPTION",""),V.setAttribute("TOOLTIP",""),V.setAttribute("USER",Z.Utils.getResource("CONTENT_LABELUSER")),V.setAttribute("DATE",Z.Utils.getCurrentUTCDateAsString()),V.setAttribute("TOOLTIP",""),V.setAttribute("TEXTCOLOR",Z.Utils.getResource("CONTENT_ANNOTATIONSCAPTIONTEXTCOLOR")),V.setAttribute("BACKCOLOR",Z.Utils.getResource("CONTENT_ANNOTATIONSCAPTIONBACKCOLOR")),V.setAttribute("BACKVISIBLE",Z.Utils.getResource("CONTENT_ANNOTATIONSCAPTIONBACKVISIBLE")),V.setAttribute("LINECOLOR",Z.Utils.getResource("CONTENT_POLYGONLINECOLOR")),V.setAttribute("FILLCOLOR",Z.Utils.getResource("CONTENT_POLYGONFILLCOLOR")),V.setAttribute("LINEVISIBLE",Z.Utils.getResource("CONTENT_POLYGONLINEVISIBLE")),V.setAttribute("FILLVISIBLE",Z.Utils.getResource("CONTENT_POLYGONFILLVISIBLE")),V.setAttribute("CAPTIONPOSITION",Z.Utils.getResource("CONTENT_ANNOTATIONSCAPTIONPOSITION")),D.appendChild(V);var B=q.getElementsByTagName("LABEL")[ar];P=B.getAttribute("ID"),Z.Utils.isStrVal(P)&&V.setAttribute("ID",P),P=B.getAttribute("NAME"),Z.Utils.isStrVal(P)&&V.setAttribute("NAME",P),P=B.getAttribute("MEDIATYPE"),Z.Utils.isStrVal(P)&&V.setAttribute("MEDIATYPE",P),P=B.getAttribute("MEDIA"),Z.Utils.isStrVal(P)&&V.setAttribute("MEDIA",P),P=B.getAttribute("X"),Z.Utils.isStrVal(P)&&!isNaN(parseFloat(P))&&V.setAttribute("X",P=="center"?U.toString():P),P=B.getAttribute("Y"),Z.Utils.isStrVal(P)&&!isNaN(parseFloat(P))&&V.setAttribute("Y",P=="center"?at.toString():P),P=B.getAttribute("ZOOM"),Z.Utils.isStrVal(P)&&!isNaN(parseFloat(P))&&V.setAttribute("ZOOM",P),P=B.getAttribute("XSCALE"),Z.Utils.isStrVal(P)&&!isNaN(parseFloat(P))&&V.setAttribute("XSCALE",P),P=B.getAttribute("YSCALE"),Z.Utils.isStrVal(P)&&!isNaN(parseFloat(P))&&V.setAttribute("YSCALE",P),P=B.getAttribute("URL"),Z.Utils.isStrVal(P)&&V.setAttribute("URL",P),P=B.getAttribute("URLTARGET"),Z.Utils.isStrVal(P)&&V.setAttribute("URLTARGET",P),P=B.getAttribute("ROLLOVER"),Z.Utils.isStrVal(P)&&V.setAttribute("ROLLOVER",P),P=B.getAttribute("CAPTION"),Z.Utils.isStrVal(P)&&V.setAttribute("CAPTION",P),P=B.getAttribute("TOOLTIP"),Z.Utils.isStrVal(P)&&V.setAttribute("TOOLTIP",P),P=B.getAttribute("USER"),Z.Utils.isStrVal(P)&&V.setAttribute("USER",P),P=B.getAttribute("DATE"),Z.Utils.isStrVal(P)&&V.setAttribute("DATE",P),P=B.getAttribute("TEXTCOLOR"),Z.Utils.isStrVal(P)&&V.setAttribute("TEXTCOLOR",P),P=B.getAttribute("BACKCOLOR"),Z.Utils.isStrVal(P)&&V.setAttribute("BACKCOLOR",P),P=B.getAttribute("LINECOLOR"),Z.Utils.isStrVal(P)&&V.setAttribute("LINECOLOR",P),P=B.getAttribute("FILLCOLOR"),Z.Utils.isStrVal(P)&&V.setAttribute("FILLCOLOR",P),P=B.getAttribute("TEXTVISIBLE"),Z.Utils.isStrVal(P)&&V.setAttribute("TEXTVISIBLE",P),P=B.getAttribute("BACKVISIBLE"),Z.Utils.isStrVal(P)&&V.setAttribute("BACKVISIBLE",P),P=B.getAttribute("LINEVISIBLE"),Z.Utils.isStrVal(P)&&V.setAttribute("LINEVISIBLE",P),P=B.getAttribute("FILLVISIBLE"),Z.Utils.isStrVal(P)&&V.setAttribute("FILLVISIBLE",P),P=B.getAttribute("CAPTIONPOSITION"),Z.Utils.isStrVal(P)&&V.setAttribute("CAPTIONPOSITION",P),Y=B.getElementsByTagName("CAPTION")[0],Y!=undefined&&V.appendChild(Y),Y=B.getElementsByTagName("TOOLTIP")[0],Y!=undefined&&V.appendChild(Y),Y=B.getElementsByTagName("POLYGON")[0],Y!=undefined&&V.appendChild(Y),D.appendChild(V)}}}return X}function aX(){dF.sort(ca),cC.sort(ca)}function ca(d,b){var f=d.text.toLowerCase(),c=b.text.toLowerCase(),a=0;return f<c?a=-1:f>c&&(a=1),a}function bp(){var ct=9,W=9,bn=51,an=12,ci=25,Y=40,bi=20,U=5,ds=parseInt(Z.Utils.getResource("DEFAULT_ANNOTATIONPANELWIDTH"),10),cs=parseInt(Z.Utils.getResource("DEFAULT_ANNOTATIONPANELHEIGHT"),10);c6||(cs-=131);var bs=parseInt(Z.Utils.getResource("DEFAULT_ANNOTATIONLISTWIDTH"),10),dn=parseInt(Z.Utils.getResource("DEFAULT_ANNOTATIONNOTEWIDTH"),10),cn=parseInt(Z.Utils.getResource("DEFAULT_ANNOTATIONNOTEHEIGHT"),10),at=c5(aY,ds,cs,aR,cK),di=aY=="0"?"hidden":"visible",R=document.getElementById("poiList");R&&Z.AnnotationPanelDisplay.removeChild(R);var br=document.getElementById("labelList");br&&Z.AnnotationPanelDisplay.removeChild(br);var cr=document.getElementById("noteList");cr&&Z.AnnotationPanelDisplay.removeChild(cr),Z.AnnotationPanelDisplay||(Z.AnnotationPanelDisplay=Z.Utils.createContainerElement("div","AnnotationPanelDisplay","inline-block","absolute","hidden",ds+"px",cs+"px",at.x+"px",at.y+"px","solid","1px","transparent none","0px","0px","normal","default"),fm=Z.AnnotationPanelDisplay,fg=fm.style);var J=parseFloat(Z.Utils.getResource("DEFAULT_ANNOTATIONPANELBACKALPHA")),dr=Z.Utils.getResource("DEFAULT_ANNOTATIONPANELBACKCOLOR"),Q=Z.Utils.getResource("DEFAULT_ANNOTATIONPANELBACKCOLORNOALPHA"),V=Z.Utils.createContainerElement("div","annotationPanelBackground","inline-block","absolute","hidden",ds+"px",cs+"px","0px","0px","none","0px",dr,"0px","0px","normal");Z.Utils.setOpacity(V,J,Q);var z=parseInt(Z.Utils.getResource("DEFAULT_ANNOTATIONPANELLABELFONTSIZE"),10),K=Z.Utils.createContainerElement("div","labelPOITextBox","inline-block","absolute","hidden",Y+"px",bi+"px",ct+"px",an+U+"px","none","0px","transparent none","0px","0px","nowrap"),q=document.createTextNode(Z.Utils.getResource("UI_ANNOTATIONPANELLABELPOI"));K.appendChild(q),Z.Utils.setTextStyle(q,"black","verdana",z+"px","none","normal","normal","normal","normal","1em","left","none");var G=Z.Utils.createContainerElement("div","labelLabelTextBox","inline-block","absolute","hidden",Y+"px",bi+"px",ct+"px",an+ci+U+"px","none","0px","transparent none","0px","0px","nowrap"),ai=document.createTextNode(Z.Utils.getResource("UI_ANNOTATIONPANELLABELLABEL"));G.appendChild(ai),Z.Utils.setTextStyle(ai,"black","verdana",z+"px","none","normal","normal","normal","normal","1em","left","none");var bt=Z.Utils.createContainerElement("div","labelNoteTextBox","inline-block","absolute","hidden",Y+"px",bi+"px",ct+"px",an+ci*2+U+"px","none","0px","transparent none","0px","0px","nowrap"),I=document.createTextNode(Z.Utils.getResource("UI_ANNOTATIONPANELLABELNOTE"));bt.appendChild(I),Z.Utils.setTextStyle(I,"black","verdana",z+"px","none","normal","normal","normal","normal","1em","left","none");var ar=Z.Utils.getResource("CONTENT_ANNOTATIONPLACEHOLDERLISTTEXT"),F=[{text:ar,value:"0"}];cb=new Z.Utils.createSelectElement("poiList","",F,bs,bn,an,di,aD),a9=new Z.Utils.createSelectElement("labelList","",F,bs,bn,an+ci,di,co);if(c6){bq=new Z.Utils.createSelectElement("noteList","",F,bs,bn,an+ci*2,di,du);var H=Z.Utils.getResource("CONTENT_ANNOTATIONPLACEHOLDERNOTETEXT"),dt=parseInt(Z.Utils.getResource("DEFAULT_ANNOTATIONNOTEPADDING"),10),X=parseInt(Z.Utils.getResource("DEFAULT_ANNOTATIONNOTEFONTSIZE"),10),B=Z.Utils.createTextElement("noteTextArea",H,dn+"px",cn+"px",W+"px",an+ci*3+3+"px",dt+"px","solid","1px","auto",!0,"verdana",X+"px","none")}Z.AnnotationPanelDisplay.appendChild(V),Z.AnnotationPanelDisplay.appendChild(K),Z.AnnotationPanelDisplay.appendChild(G),Z.AnnotationPanelDisplay.appendChild(cb),Z.AnnotationPanelDisplay.appendChild(a9),bq&&(Z.AnnotationPanelDisplay.appendChild(bt),Z.AnnotationPanelDisplay.appendChild(bq),Z.AnnotationPanelDisplay.appendChild(B)),Z.ViewerDisplay.appendChild(Z.AnnotationPanelDisplay),Z.Utils.updateSelectElement(cb,fy),aD()}function c5(g,c,k,f,b){var d,h,a=15;switch(g){case"0":d=0,h=0;break;case"1":d=a,h=a;break;case"2":d=f-c-a,h=a;break;case"3":d=f-c-a,toolbar!=null?h=b-k-a:h=b-a;break;case"4":d=a,toolbar!=null?h=b-k-a:h=b-a;break;default:d=f-c-a,h=a}return new Z.Utils.Point(d,h)}function a8(c,a,d){dF.push({text:c,value:a,poiID:d}),cC.push({text:c,value:a,poiID:d});var b=document.getElementById("labelList");Z.Utils.updateSelectElement(b,cC),b.selectedIndex=b.length-1}function bW(c){var a=document.getElementById("labelList");if(a!=null){var d=dF.indexOfObjectValue("value",c);d!=-1&&dF.splice(d,1);var d=cC.indexOfObjectValue("value",c);if(d!=-1){cC.splice(d,1),Z.Utils.updateSelectElement(a,cC);var b=a.length;b!=0&&(a.selectedIndex=d>b-1?b-1:d)}}}function aN(b){var b=Z.Utils.event(b);if(b){var a=Z.Utils.target(b);Z.browser!=Z.browsers.IE&&a&&Z.Utils.isStrVal(a.id)?c3(a,!0):Z.browser==Z.browsers.IE&&(a.parentNode.parentNode&&a.parentNode.parentNode.id.indexOf("hot")!=-1?c3(a.parentNode.parentNode,!0):a.parentNode.parentNode.parentNode&&a.parentNode.parentNode.parentNode.id.indexOf("hot")!=-1&&c3(a.parentNode.parentNode.parentNode,!0))}}function fx(b){var b=Z.Utils.event(b);if(b){var a=Z.Utils.target(b),c=Z.Utils.relatedTarget(b);if(Z.browser!=Z.browsers.IE&&c&&Z.Utils.isStrVal(c.id)||Z.browser==Z.browsers.IE&&a.parentNode.parentNode.parentNode&&Z.Utils.isStrVal(a.parentNode.parentNode.parentNode.id)){a.parentNode.parentNode&&a.parentNode.parentNode.id.indexOf("hot")!=-1?c3(a.parentNode.parentNode,!1):a.parentNode.parentNode.parentNode&&a.parentNode.parentNode.parentNode.id.indexOf("hot")!=-1&&c3(a.parentNode.parentNode.parentNode,!1)}}}function dE(a){}function cB(a){}function eg(a){}function de(a){}function bM(a){}function dZ(b){var d="0",b=Z.Utils.event(b);if(b){var c=Z.Utils.target(b),d=c.options[c.selectedIndex].value}if(Z.Utils.isStrVal(d)){var a=cN.indexOfObjectValue("id",d);a!=-1&&eH.zoomAndPanToView(cN[a].x,cN[a].y,cN[a].zoom/100)}}function aD(p){var d="0",p=Z.Utils.event(p);if(p){var b=Z.Utils.target(p);d=b.options[b.selectedIndex].value}if(Z.Utils.isStrVal(d)){var g=fy.indexOfObjectValue("value",d);if(g!=-1){var q=Z.imageW/2,c=Z.imageH/2,m;m=fy[g].x;var k=m=="center"?q:parseFloat(m);m=fy[g].y;var h=m=="center"?c:parseFloat(m);m=fy[g].zoom;var e=m=="-1"?Z.fitZ:parseFloat(m);dv?eH.zoomAndPanToView(k,h,e/100):(dv=!0,ao())}}cC=fJ(dF,d),Z.Utils.updateSelectElement(a9,cC),bq&&(df=fJ(eh,d),Z.Utils.updateSelectElement(bq,df),du()),Z.editMode&&(bl=parseInt(a9.options[a9.selectedIndex].value))}function co(p){var p=Z.Utils.event(p),d=Z.Utils.target(p),b=d.options[d.selectedIndex].value;if(b!==null){bl=parseInt(b),ag=!0;var g=cN.indexOfObjectValue("internalID",bl);if(g!=-1){var q=Z.imageW/2,c=Z.imageH/2,m;m=cN[g].x;var k=m=="center"?q:parseFloat(m);m=cN[g].y;var h=m=="center"?c:parseFloat(m);m=cN[g].zoom;var e=m=="-1"?Z.fitZ:parseFloat(m);Z.polygonEditing?ao():eH.zoomAndPanToView(k,h,e/100)}}}function du(d){var b=document.getElementById("noteTextArea");b.value="";var f="0",d=Z.Utils.event(d);if(d){var c=Z.Utils.target(d);f=c.options[c.selectedIndex].value}else{df.length>0&&(f=df[0].value)}if(Z.Utils.isStrVal(f)){var a=df.indexOfObjectValue("value",f);a!=-1&&(b.value=df[a].noteText)}}function fJ(d,b){var f=[];for(var c=0,a=d.length;c<a;c++){d[c].poiID==b&&f.push(d[c])}return f}function eU(z,F){if(Z.useCanvas){var m=z.internalID;!Z.polygonEditing||m!==bl?targetCtx=eT:targetCtx=eR,targetCtx.save(),targetCtx.translate((z.x-Z.imageX)*Z.imageZ,(z.y-Z.imageY)*Z.imageZ);var b=ff/eO,w=F.constrainedScale*(z.xScale/100/(z.zoom/100))/b,G=F.constrainedScale*(z.yScale/100/(z.zoom/100))/b;targetCtx.scale(w,G);var k=z.polygonPts,E=z.x,C=z.y;targetCtx.lineWidth=a5;if(!z.fillVisible||!ag){targetCtx.lineWidth*=3}targetCtx.strokeStyle=z.lineColor,targetCtx.fillStyle=z.fillColor,targetCtx.beginPath();var y=k[0].x-E,q=k[0].y-C;targetCtx.moveTo(y,q);for(var B=1,x=k.length;B<x;B++){var g=k[B].x-E,A=k[B].y-C;targetCtx.lineTo(g,A)}if(ag||m!=bl||cf&&aK==0){targetCtx.lineTo(y,q),targetCtx.closePath(),z.fillVisible&&(ag||m!=bl)&&(targetCtx.globalAlpha=0.5,targetCtx.fill()),targetCtx.globalAlpha=1}targetCtx.stroke();var D=(w+G)/2;if(Z.polygonEditing&&z.internalID==bl){for(var B=0,x=k.length;B<x;B++){var g=k[B].x-E,A=k[B].y-C;aq(g,A,!ag&&B==0,D)}}targetCtx.restore()}else{dL||(Z.Utils.showMessage(Z.Utils.getResource("ALERT_POLYGONSREQUIRECANVAS")),dL=!0)}}function aq(d,b,f,c){var a=cS;c!==undefined&&c!==null&&(a/=c),eR.lineWidth=cX,eR.strokeStyle=am,eR.fillStyle=f?fd:bE,eR.beginPath(),eR.arc(d,b,a,0,Math.PI*2,!1),eR.closePath(),eR.globalAlpha=0.5,eR.fill(),eR.globalAlpha=1,eR.stroke()}function ay(m,v){bH(eQ);var d=new bK,b=cN.indexOfObjectValue("internalID",bl);if(b!=-1){eU(cN[b],d);var h=Z.imageX,w=Z.imageY,c=Z.imageZ,q=cN[b].polygonPts,p=q[q.length-1],k=(p.x-h)*c,g=(p.y-w)*c;ag||(eR.lineWidth=cX,eR.strokeStyle=am,eR.moveTo(k,g),eR.lineTo(m,v),eR.stroke())}}function cF(f){el&&bH(el),eQ&&bH(eQ);var b=new bK;for(var g=0,d=cN.length;g<d;g++){if(cN[g].media=="polygon"){var a=cN[g].x,c=cN[g].y;a>b.bounds.left&&a<b.bounds.right&&c>b.bounds.top&&c<b.bounds.bottom&&(f||!Z.polygonEditing||bl===null||bl!==g)&&eU(cN[g],b)}}}function fT(d,b,f){db=!0,bH(eQ);var c=new bK,a=cN.indexOfObjectValue("internalID",d);a!=-1&&(cN[a].polygonPts[b]=f,eU(cN[a],c))}function cv(b,a){if(bl===null){dy(null,!0,a)}else{var c=cN.indexOfObjectValue("internalID",bl);c!=-1&&(dm=cN[c].polygonPts,dm===null?dy(bl,!0,a):(aK=aS(b,a),ag?aK===null&&dy(null,!0,a):aK===null?dy(bl,!1,a):aK==0&&cN[c].polygonPts.length>2&&cL(bl)))}}function dy(z,F,m){var b=!1,w=!1;if(z===null){var G=bU("label"),k=bU("labelExternal"),E="<LABEL ID='"+k.toString()+"' INTERNALID='"+G.toString()+"' NAME='Polygon "+G.toString()+"' MEDIATYPE='symbol' MEDIA='polygon' X='"+m.x.toString()+"' Y='"+m.y.toString()+"' ZOOM='100' XSCALE='100' YSCALE='100' URL='' URLTARGET='' ROLLOVER='0' CAPTION='' TOOLTIP='' LINECOLOR='ffffff' FILLCOLOR='999999' FILLVISIBLE='1' CAPTIONPOSITION='8' ><POLYGON><POINT X='"+m.x.toString()+"' Y='"+m.y.toString()+"' ></POINT></POLYGON></LABEL>",C=Z.Utils.convertXMLTextToXMLDoc(E),y=C.getElementsByTagName("LABEL"),q=new dc(y[0]);poiCurrentID=cb.options[cb.selectedIndex].value,q.poiInternalID=poiCurrentID,q.saved=!1,cN.push(q);var B=cb.options[cb.selectedIndex].value;bl=G,a8(q.name,bl,B),w=!0,b=!0}else{var x=cN.indexOfObjectValue("internalID",z);if(x!=-1){var g=cN[x].polygonPts;g.push({x:m.x,y:m.y}),cN[x].polygonPts=g,cN[x].saved=!1}}var A=(m.x-Z.imageX)*Z.imageZ,D=(m.y-Z.imageY)*Z.imageZ;aq(A,D,b),ag=!1,w?ao():F&&cF()}function aS(g,l){var d=null,b=(cS+1)/Z.imageZ;for(var f=0,m=cN.length;f<m;f++){if(cN[f].media=="polygon"&&cN[f].internalID==bl){var c=cN[f].polygonPts;for(var k=0,h=c.length;k<h;k++){Z.Utils.calculatePointsDistance(l.x,l.y,c[k].x,c[k].y)<b&&(d=k)}}}return d}function cL(c){bH(eQ),ag=!0;var a=cN.indexOfObjectValue("internalID",c);if(a!=-1){var d=Z.Utils.getCenterOfPolygonPoints(cN[a].polygonPts);cN[a].x=d.x,cN[a].y=d.y,cN[a].caption="Polygon "+c.toString();var b=new bK;cT(cN[a],b)}}function dT(bs){var P,Y,U=Z.imageW/2,at=Z.imageH/2,Q="<ZAS></ZAS>",X=Z.Utils.convertXMLTextToXMLDoc(Q),K=X.getElementsByTagName("ZAS")[0],cr=X.createElement("LABELSETUP");cr.setAttribute("PANELPOSITION","2"),cr.setAttribute("INITIALVISIBILITY","1"),cr.setAttribute("MINSCALE","1"),cr.setAttribute("MAXSCALE","1");var br=bs.getElementsByTagName("LABELSETUP")[0];P=br.getAttribute("PANELPOSITION"),Z.Utils.isStrVal(P)&&cr.setAttribute("PANELPOSITION",P),P=br.getAttribute("INITIALVISIBILITY"),Z.Utils.isStrVal(P)&&cr.setAttribute("INITIALVISIBILITY",P),P=br.getAttribute("MINSCALE"),Z.Utils.isStrVal(P)&&!isNaN(parseFloat(P))&&parseFloat(P)>0&&cr.setAttribute("MINSCALE",P),P=br.getAttribute("MAXSCALE"),Z.Utils.isStrVal(P)&&!isNaN(parseFloat(P))&&parseFloat(P)>0&&cr.setAttribute("MAXSCALE",P),K.appendChild(cr);var an=bs.getElementsByTagName("POI");for(var ci=0,bi=an.length;ci<bi;ci++){var W=X.createElement("POI");W.setAttribute("ID","0"),W.setAttribute("NAME",Z.Utils.getResource("CONTENT_POINAME")),W.setAttribute("X","center"),W.setAttribute("Y","center"),W.setAttribute("ZOOM","-1"),W.setAttribute("USER",Z.Utils.getResource("CONTENT_POIUSER")),W.setAttribute("DATE",Z.Utils.getCurrentUTCDateAsString());var bt=an[ci];P=bt.getAttribute("ID"),Z.Utils.isStrVal(P)&&W.setAttribute("ID",P),P=bt.getAttribute("NAME"),Z.Utils.isStrVal(P)&&W.setAttribute("NAME",P),P=bt.getAttribute("X"),Z.Utils.isStrVal(P)&&!isNaN(parseFloat(P))&&W.setAttribute("X",P=="center"?U.toString():P),P=bt.getAttribute("Y"),Z.Utils.isStrVal(P)&&!isNaN(parseFloat(P))&&W.setAttribute("Y",P=="center"?at.toString():P),P=bt.getAttribute("ZOOM"),Z.Utils.isStrVal(P)&&!isNaN(parseFloat(P))&&W.setAttribute("ZOOM",P),P=bt.getAttribute("USER"),Z.Utils.isStrVal(P)&&W.setAttribute("USER",P),P=bt.getAttribute("DATE"),Z.Utils.isStrVal(P)&&W.setAttribute("DATE",P),K.appendChild(W);var J=an[ci].getElementsByTagName("NOTES")[0];if(typeof J!="undefined"){var ai=X.createElement("NOTES");W.appendChild(ai);var bn=J.getElementsByTagName("NOTE");for(var G=0,cn=bn.length;G<cn;G++){var I=X.createElement("NOTE");I.setAttribute("ID","0"),I.setAttribute("NAME",Z.Utils.getResource("CONTENT_NOTENAME")),I.setAttribute("TEXT",Z.Utils.getResource("CONTENT_NOTETEXT")),I.setAttribute("USER",Z.Utils.getResource("CONTENT_NOTEUSER")),I.setAttribute("DATE",Z.Utils.getCurrentUTCDateAsString());var M=bn[G];P=M.getAttribute("ID"),Z.Utils.isStrVal(P)&&I.setAttribute("ID",P),P=M.getAttribute("NAME"),Z.Utils.isStrVal(P)&&I.setAttribute("NAME",P),P=M.getAttribute("TEXT"),Z.Utils.isStrVal(P)&&I.setAttribute("TEXT",P),P=M.getAttribute("USER"),Z.Utils.isStrVal(P)&&I.setAttribute("USER",P),P=M.getAttribute("DATE"),Z.Utils.isStrVal(P)&&I.setAttribute("DATE",P),ai.appendChild(I)}}if(cN.length>0){var z=X.createElement("LABELS");W.appendChild(z);for(var H=0,q=cN.length;H<q;H++){var D=X.createElement("LABEL");D.setAttribute("ID",cN[H].id),D.setAttribute("NAME",cN[H].name),D.setAttribute("MEDIATYPE",cN[H].mediaType),D.setAttribute("MEDIA",cN[H].media),D.setAttribute("X",cN[H].x),D.setAttribute("Y",cN[H].y),D.setAttribute("ZOOM",cN[H].zoom),D.setAttribute("XSCALE",cN[H].xScale),D.setAttribute("YSCALE",cN[H].yScale),D.setAttribute("URL",cN[H].url),D.setAttribute("URLTARGET",cN[H].urlTarget),D.setAttribute("ROLLOVER",cN[H].rollover),D.setAttribute("CAPTION",cN[H].caption),D.setAttribute("TOOLTIP",cN[H].tooltip),D.setAttribute("CAPTIONPOSITION",cN[H].captionPosition),D.setAttribute("USER",Z.Utils.getResource("CONTENT_LABELUSER")),D.setAttribute("DATE",Z.Utils.getCurrentUTCDateAsString());var R=cN[H].polygonPts;if(R!=null){var ar=X.createElement("POLYGON");for(var F=0,V=R.length;F<V;F++){var B=X.createElement("POINT");B.setAttribute("X",R[F].x),B.setAttribute("Y",R[F].y),ar.appendChild(B)}D.appendChild(ar)}z.appendChild(D)}}}return X}function bh(b,d,c){eH.zoomAndPanAllStop(),Z.imageZ=aV(c);var a=af(b,d);Z.imageX=a.x,Z.imageY=a.y,eH.updateView(!0)}function dj(){ba&&(bv!=0||bb!=0||dR!=0)&&(dI(bv,bb,dR),ba=window.setTimeout(dj,bu))}function dI(m,v,d){var b=!1,h=!1,w=!1;if(d!=0){var c=ff*(1+d),q=dV(fb,c);constrainedZoom=aV(q);if(constrainedZoom!=Z.imageZ){var h=w=fC(constrainedZoom)}}if(m!=0||v!=0){var p=parseFloat(ec.left)+m,k=parseFloat(ec.top)+v,g=dC(p,k);ec.left=g.x+"px",ec.top=g.y+"px",b=!0,w=!0}a0%2==0&&(dM(),ao(),h&&b1(),w&&b7())}function ad(B,k,b,q,C){bO++;var g=q/C,A=bO*g,z=Z.Utils.easing(Z.imageX,B,A,q),w=Z.Utils.easing(Z.imageY,k,A,q),m=Z.Utils.easing(Z.imageZ,b,A,q),y=da(z,w,m),v=y.x,e=y.y;if(v!=parseFloat(ec.left)||e!=parseFloat(ec.top)){syncNav=!0}var x=syncNav=fC(m);ec.left=v+"px",ec.top=e+"px",ao(),bO%2==0&&(x&&b1(),syncNav&&b7()),bO<C+1?dg=window.setTimeout(function(){ad(B,k,b,q,C)},g):(c8(),eH.updateView(),eH.toggleWatermarks(!0))}function aI(){ba&&(window.clearTimeout(ba),ba=null),bv=0,bb=0,dR=0,a0=0}function c8(){dg&&(window.clearTimeout(dg),dg=null)}function fC(v){var z=!1,g=a1(fb,v);if(g!=ff){ff=g,dN=a1(e9,v);var b=g/eO,m=dh*b,A=dH*b,d=(dh-m)/2,y=(dH-A)/2;if(g<eO){var x=cz(d,y);ec.left=c7+x.x-d+"px",ec.top=a2+x.y-y+"px"}if(Z.useCanvas){eX.width=m+"px",eX.height=A+"px",eX.left=d+"px",eX.top=y+"px",el&&(eY.width=m+"px",eY.height=A+"px",eY.left=d+"px",eY.top=y+"px"),eQ&&(eP.width=m+"px",eP.height=A+"px",eP.left=d+"px",eP.top=y+"px"),m=ah*b,A=e4*b,d=bB+Z.imageX*(1-b)*Z.imageZ,y=cO+Z.imageY*(1-b)*Z.imageZ,d9.width=m+"px",d9.height=A+"px",d9.left=d+"px",d9.top=y+"px"}else{ch(fh,fb,cA,"centerOut",!1,"Scaling: non-canvas zoom"),tierBackfillW=bo[e9],tierBackfillH=c4[e9],eF.width=tierBackfillW,eF.height=tierBackfillH;var q=tierBackfillW*dN,k=tierBackfillH*dN,w=Z.imageX*v,p=Z.imageY*v;bB=ac-w,cO=aH-p,d9.left=bB+"px",d9.top=cO+"px",ch(eF,e9,aW,"simple",!1,"Scaling: non-canvas zoom - backfill")}z=!0}return z}function a3(a){a?(aA||cV(),aA.elmt.style.display="inline-block"):aA&&(aA.elmt.style.display="none")}function cV(){var f=Z.Utils.getResource("DEFAULT_FPCANCELBUTTONTEXT"),b=34,h=34,d=20,a=parseFloat(Z.viewerW)-(b+d),c=parseFloat(Z.viewerH)-(h+d),g=Z.Utils.getResource("DEFAULT_FPCANCELBUTTONCOLOR");aA=new Z.Utils.Button("buttonFPCancel",f,null,null,null,null,b+"px",h+"px",a+"px",c+"px","mousedown",aj,"TIP_CANCELFULLPAGE","solid","1px",g,"0px","0px"),Z.ViewerDisplay.appendChild(aA.elmt)}function aj(){eH.toggleFullPageView(!1)}function e6(){Z.Utils.addEventListener(document,"keydown",aZ),Z.Utils.addEventListener(document,"keyup",cd),Z.mobileDevice?(Z.Utils.addEventListener(eI,"touchstart",bG),Z.Utils.addEventListener(eI,"touchmove",b0),Z.Utils.addEventListener(eI,"touchend",b6),Z.Utils.addEventListener(eI,"touchcancel",ey),Z.Utils.addEventListener(eI,"gesturestart",d3),Z.Utils.addEventListener(eI,"gesturechange",cZ),Z.Utils.addEventListener(eI,"gestureend",fO),document.getElementsByTagName("body")[0].onorientationchange=dQ):(Z.Utils.addEventListener(Z.ViewerDisplay,"mouseover",bC),Z.Utils.addEventListener(Z.ViewerDisplay,"mouseout",bQ),Z.Utils.addEventListener(Z.ViewerDisplay,"mousemove",Z.Utils.preventDefault),Z.Utils.addEventListener(eI,"mousedown",cP),Z.Utils.addEventListener(eI,"mousemove",Z.Utils.preventDefault)),Z.Utils.addEventListener(eF,"contextmenu",Z.Utils.preventDefault),Z.Utils.addEventListener(fh,"contextmenu",Z.Utils.preventDefault),fo&&Z.Utils.addEventListener(fo,"contextmenu",Z.Utils.preventDefault),eN&&Z.Utils.addEventListener(eN,"contextmenu",Z.Utils.preventDefault)}function bC(b){var a=Z.Utils.nodeIsInViewer(Z.Utils.target(Z.Utils.event(b))),c=Z.Utils.nodeIsInViewer(Z.Utils.relatedTarget(b));if(!a||!c){Z.ToolbarDisplay&&Z.toolbarVisible>1&&Z.Toolbar.show(!0),Z.NavigatorDisplay&&Z.navigatorVisible>1&&Z.Navigator.setVisibility(!0),fp=null}}function cP(b){var d=window.setTimeout(function(){eH.zoomAndPanAllStop()},1);if(Z.Utils.isRightMouseButton(b)){return}cf=!0;var c=Z.Utils.getMousePosition(b);bP=new Z.Utils.Point(c.x,c.y),eI.mouseXPrior=c.x,eI.mouseYPrior=c.y;if(Z.polygonEditing&&bl!==null){var a=eH.getClickZoomCoords3D(b,bP,fb,ff);aK=aS(b,a)}return Z.Utils.addEventListener(document,"mousemove",cg),Z.Utils.addEventListener(eI,"mouseup",fq),Z.Utils.addEventListener(document,"mouseup",fq),!1}function cg(v){var v=Z.Utils.event(v),e=Z.Utils.getMousePosition(v);bF=new Z.Utils.Point(e.x,e.y);var b=eH.getClickZoomCoords3D(v,bF,fb,ff);if(Z.polygonEditing&&aK!==null&&cf){fT(bl,aK,b)}else{if(Z.polygonEditing&&!ag&&(!cf||cf&&aK!==null)){var h=(b.x-Z.imageX)*Z.imageZ,w=(b.y-Z.imageY)*Z.imageZ;ay(h,w)}else{if(!Z.mousePan){return}var d=e.x-eI.mouseXPrior,q=e.y-eI.mouseYPrior;if(!isNaN(d)&&!isNaN(q)){var p=parseFloat(ec.left)+d,k=parseFloat(ec.top)+q,g=dC(p,k);ec.left=g.x+"px",ec.top=g.y+"px",eI.mouseXPrior=e.x,eI.mouseYPrior=e.y;if(Z.Navigator){var m=eH.calculateCurrentCenterCoordinates(g);Z.Navigator.syncNavigatorRectanglePosition(m)}}}}return !1}function fq(l){cf=!1,document.mousemove=null,document.mouseup=null,Z.Utils.removeEventListener(document,"mousemove",cg),Z.Utils.removeEventListener(eI,"mouseup",fq),Z.Utils.removeEventListener(document,"mouseup",fq);var l=Z.Utils.event(l),d=Z.Utils.getMousePosition(l),b;fp?b=fp:b=new Z.Utils.Point(d.x,d.y);var e=Z.Utils.calculatePointsDistance(bP.x,bP.y,b.x,b.y,2);if(e<4){var m=eH.getClickZoomCoords3D(l,b,fb,ff);if(Z.clickZoom&&!Z.polygonEditing){var c=window.setTimeout(function(){eH.zoomAndPanToView(m.x,m.y,m.z)},1)}else{Z.clickPan&&!Z.polygonEditing?eH.zoomAndPanToView(m.x,m.y,Z.imageZ):Z.polygonEditing&&(cv(l,m),ag||Z.Utils.addEventListener(document,"mousemove",cg))}}else{if(Z.polygonEditing&&(db||aK===null&&!ag)){aK=null,db=!1;var k=new bK,h=cN.indexOfObjectValue("internalID",bl);if(h!=-1){var g=Z.Utils.getCenterOfPolygonPoints(cN[h].polygonPts);cN[h].x=g.x,cN[h].y=g.y,bH(eQ),cT(cN[h],k),ag||Z.Utils.addEventListener(document,"mousemove",cg)}}bF=null,Z.mousePan&&eH.updateView()}fp&&(Z.ToolbarDisplay&&Z.toolbarVisible>1&&Z.Toolbar.show(!1),Z.NavigatorDisplay&&Z.navigatorVisible>1&&Z.Navigator.setVisibility(!1))}function bQ(c){var a=Z.Utils.nodeIsInViewer(Z.Utils.target(c)),d=Z.Utils.nodeIsInViewer(Z.Utils.relatedTarget(Z.Utils.event(c)));if(!a||!d){if(!cf){Z.ToolbarDisplay&&Z.toolbarVisible>1&&Z.Toolbar.show(!1),Z.NavigatorDisplay&&Z.navigatorVisible>1&&Z.Navigator.setVisibility(!1)}else{var b=Z.Utils.getMousePosition(c);fp=new Z.Utils.Point(b.x,b.y)}}}function bG(b){eH.zoomAndPanAllStop();var b=Z.Utils.event(b),e=Z.Utils.getFirstTouch(b);if(e&&!bZ){ew=!1;var d=e.target,a=new Z.Utils.Point(e.pageX,e.pageY);bP=new Z.Utils.Point(a.x,a.y),eI.mouseXPrior=a.x,eI.mouseYPrior=a.y;if(Z.polygonEditing){cf=!0;if(bl!==null){var c=eH.getClickZoomCoords3D(b,bP,fb,ff);aK=aS(b,c)}}}}function b0(v){var v=Z.Utils.event(v);v.preventDefault();var e=Z.Utils.getFirstTouch(v),b=new Z.Utils.Point(e.pageX,e.pageY);bF=new Z.Utils.Point(b.x,b.y);var h=eH.getClickZoomCoords3D(v,bF,fb,ff);if(Z.polygonEditing&&aK!==null&&cf){fT(bl,aK,h)}else{if(!Z.mousePan){return}if(e&&!bZ&&!ew){var w=e.target,d=b.x-eI.mouseXPrior,q=b.y-eI.mouseYPrior;if(!isNaN(d)&&!isNaN(q)){var p=parseFloat(ec.left)+d,k=parseFloat(ec.top)+q,g=dC(p,k);ec.left=g.x+"px",ec.top=g.y+"px",eI.mouseXPrior=b.x,eI.mouseYPrior=b.y;if(Z.Navigator){var m=eH.calculateCurrentCenterCoordinates(g);Z.Navigator.syncNavigatorRectanglePosition(m)}}}}return !1}function b6(b){var b=Z.Utils.event(b);if(!bZ&&!ew){cf=!1,typeof bF!="undefined"&&bF!==null?dragPtEnd=bF:dragPtEnd=bP;var f=Z.Utils.calculatePointsDistance(bP.x,bP.y,dragPtEnd.x,dragPtEnd.y,2);if(f<4){var d=eH.getClickZoomCoords3D(b,dragPtEnd,fb,ff);Z.clickZoom&&!Z.polygonEditing?eH.zoomAndPanToView(d.x,d.y,d.z):Z.clickPan&&!Z.polygonEditing?eH.zoomAndPanToView(d.x,d.y,Z.imageZ):Z.polygonEditing&&cv(b,d)}else{if(Z.polygonEditing&&(db||aK===null&&!ag)){aK=null,db=!1;var a=new bK,c=cN.indexOfObjectValue("internalID",bl);if(c!=-1){var e=Z.Utils.getCenterOfPolygonPoints(cN[c].polygonPts);cN[c].x=e.x,cN[c].y=e.y,bH(eQ),cT(cN[c],a),ag||Z.Utils.addEventListener(document,"mousemove",cg)}}Z.mousePan&&eH.updateView()}bF=null}}function ey(c){var c=Z.Utils.event(c);if(!bZ&&!ew){cf=!1;var g=!1;typeof bF!="undefined"&&bF!==null?dragPtEnd=bF:dragPtEnd=bP;var e=Z.Utils.calculatePointsDistance(bP.x,bP.y,dragPtEnd.x,dragPtEnd.y,2);if(e<4){var b=eH.getClickZoomCoords3D(c,dragPtEnd,fb,ff);Z.clickZoom&&!Z.polygonEditing?eH.zoomAndPanToView(b.x,b.y,b.z):Z.clickPan&&!Z.polygonEditing?eH.zoomAndPanToView(b.x,b.y,Z.imageZ):Z.polygonEditing&&cv(c,b)}else{if(Z.polygonEditing&&(db||aK===null&&!ag)){aK=null,db=!1;var d=new bK,f=cN.indexOfObjectValue("internalID",bl);if(f!=-1){var a=Z.Utils.getCenterOfPolygonPoints(cN[f].polygonPts);cN[f].x=a.x,cN[f].y=a.y,bH(eQ),cT(cN[f],d),ag||Z.Utils.addEventListener(document,"mousemove",cg)}}Z.mousePan&&eH.updateView()}bF=null}}function d3(a){eH.zoomAndPanAllStop();var a=Z.Utils.event(a);cZ(a),bZ||(bZ=window.setInterval(bw,d2))}function cZ(a){var a=Z.Utils.event(a);a.preventDefault(),b5=Math.round(a.scale*100)/100}function fO(a){bZ&&(window.clearInterval(bZ),ew=!0,bZ=null),Z.mousePan&&eH.updateView()}function bw(b){if(!Z.mousePan){return}var a=bc(fb,eO,b5),c=aV(a);a!=Z.imageZ&&fC(c)}function bc(d,b,f){var c=b*f,a=dV(d,c);return a}function dQ(a){Z.fullPage&&(Z.ToolbarDisplay&&Z.toolbarVisible>1&&Z.Toolbar.show(!1),Z.NavigatorDisplay&&Z.navigatorVisible>1&&Z.Navigator.setVisibility(!1),eH.toggleFullPageView(!1),eH.toggleFullPageView(!0),Z.ToolbarDisplay&&Z.toolbarVisible>1&&Z.Toolbar.show(!0),Z.NavigatorDisplay&&Z.navigatorVisible>1&&Z.Navigator.setVisibility(!0))}function aZ(a){if(!Z.keys){return}a.altKey||c8();var a=Z.Utils.event(a);switch(a.keyCode){case 90:eH.zoom("out");break;case 17:eH.zoom("out");break;case 65:eH.zoom("in");break;case 16:eH.zoom("in");break;case 37:eH.pan("left");break;case 38:eH.pan("up");break;case 40:eH.pan("down");break;case 39:eH.pan("right");break;case 27:Z.fullPage?eH.toggleFullPageView(!1):eH.reset()}}function cd(a){if(!Z.keys){return}var a=Z.Utils.event(a),b=a.keyCode;b==90||b==17||b==65||b==16?eH.zoom("stop"):b==37||b==39?eH.pan("horizontalStop"):(b==38||b==40)&&eH.pan("verticalStop")}var eH=this,ef=!1,eu=-1,ek=0,eC=0,ej=256,ep=0,ed=256,eM,eG=parseFloat(Z.Utils.getResource("DEFAULT_TIERSMAXSCALEUP")),ex=eG/2,eJ=parseInt(Z.Utils.getResource("DEFAULT_TILESMAXCACHE"),10),eD=Z.toolbarVisible==1?Z.toolbarH:0,em,eI,ec,ev,eF,d9,eK,eb,fh,eX,ea,eW,e3,fk,ez,e7,fo,e2,e5,eN,fj,e0,fe,fm,fg,fc,el,eY,eT,d8,eQ,eP,eR;dz();var fG=1,fb=0,e9=0,eZ=!1,ff,eO,dN,aW=[],b9=[],bo=[],c4=[],a7=[],bV=[],aM=[],fw=[],dD=[],cA=[],ee=[],dd=[],bL=[],dY=[],aC=[],cm=[],dq=[],fI=0,eS=new Z.NetConnector,ap=parseInt(Z.Utils.getResource("DEFAULT_BACKFILLTHRESHOLD2"),10),ax=parseInt(Z.Utils.getResource("DEFAULT_BACKFILLTHRESHOLD1"),10),cE=parseInt(Z.Utils.getResource("DEFAULT_BACKFILLCHOICE2"),10),fS=parseInt(Z.Utils.getResource("DEFAULT_BACKFILLCHOICE1"),10),cu=parseInt(Z.Utils.getResource("DEFAULT_BACKFILLCHOICE0"),10),dx=parseFloat(Z.Utils.getResource("DEFAULT_PANBUFFER"),10),aR,cK,dS,bg,dh,dH,ac,aH,c7,fB,a2,cU,ah,e4,bB,cO;aR=Z.viewerW,cK=Z.viewerH,dS=bg=0,cK-=eD,Z.toolbarPosition==0&&(bg+=eD);var cf=!1,fp=null,bP,bF,bZ=null,b5=null,ew=!1,d2=parseInt(Z.Utils.getResource("DEFAULT_GESTURETESTDURATION"),10),cY=parseFloat(Z.Utils.getResource("DEFAULT_ZOOMSTEPDISTANCE"))*Z.zoomSpeed;Z.mobileDevice&&(cY/=2);var fN=Math.round(parseFloat(Z.Utils.getResource("DEFAULT_PANSTEPDISTANCE"))*Z.panSpeed),bv=0,bb=0,dR=0,a0=0,ce=0,bu=parseInt(Z.Utils.getResource("DEFAULT_ZAPSTEPDURATION"),10),ba,bY,aP,fA=parseFloat(Z.Utils.getResource("DEFAULT_FADEINSTEP"))*Z.fadeInSpeed,dG,cD=parseFloat(Z.Utils.getResource("DEFAULT_ZAPTVDURATION")),eq=parseFloat(Z.Utils.getResource("DEFAULT_ZAPTVSTEPS"));Z.mobileDevice&&(eq/=2);var dg=null,bO=0,d1,aF,cq,dw,fL,e1,av,aA,cI;if(Z.Utils.isStrVal(Z.watermarkPath)){var ab,cy,dB=[],aU=[]}if(Z.Utils.isStrVal(Z.hotspotPath)||Z.Utils.isStrVal(Z.annotationPath)){var cN=[],dW=[],bl=null,dm=null,dL=!1,ag=!0,aK=null,db=!1,fF=new Z.NetConnector,a5=Z.Utils.getResource("DEFAULT_POLYGONLINEWIDTH"),cX=Z.Utils.getResource("DEFAULT_CONTROLPOINTLINEWIDTH"),am=Z.Utils.getResource("DEFAULT_CONTROLPOINTSTROKECOLOR"),fd=Z.Utils.getResource("DEFAULT_FIRSTCONTROLPOINTFILLCOLOR"),bE=Z.Utils.getResource("DEFAULT_STANDARDCONTROLPOINTFILLCOLOR"),cS=parseInt(Z.Utils.getResource("DEFAULT_CONTROLPOINTRADIUS"),10),ck=parseInt(Z.Utils.getResource("DEFAULT_HOTSPOTCAPTIONFONTSIZE"),10),fv=parseInt(Z.Utils.getResource("DEFAULT_MINHOTSPOTCAPTIONFONTSIZE"),10),bT=parseInt(Z.Utils.getResource("DEFAULT_MAXHOTSPOTCAPTIONFONTSIZE"),10),bJ=parseInt(Z.Utils.getResource("DEFAULT_HOTSPOTCAPTIONPADDING"),10),b3=parseInt(Z.Utils.getResource("DEFAULT_MINHOTSPOTCAPTIONPADDING"),10),b8=parseInt(Z.Utils.getResource("DEFAULT_MAXHOTSPOTCAPTIONPADDING"),10);Z.mobileDevice&&(cS*=2);if(Z.Utils.isStrVal(Z.hotspotPath)){var eE,d6,c2,fQ,bz,bf=[]}else{if(Z.Utils.isStrVal(Z.annotationPath)){var dP,aY,cb,bq,c6,a9,bX,aO,fy=[],dF=[],cC=[],eh=[],df=[],bN=[],d0=[],aE=[],cp=[],dv=!1}}}aT(aR,cK,dS,bg);if(Z.imageProperties==null){var fK=new Z.NetConnector;cM(fK)}else{var eV=Z.Utils.convertXMLTextToXMLDoc(Z.imageProperties);dU(eV)}this.getInitialized=function(){return aa()},this.getW=function(){return dh},this.getH=function(){return dH},this.getTierCount=function(){return fG},this.getTileSize=function(){return eM},this.getTierCurrent=function(){return fb},this.getTierScale=function(){return ff},this.getX=function(){var a=parseFloat(ec.left)-c7,c=eH.getZoom(),b=Z.imageX-a/c;return b},this.getY=function(){var a=parseFloat(ec.top)-a2,c=eH.getZoom(),b=Z.imageY-a/c;return b},this.getZoom=function(){var a=dV(fb,ff);return a},this.getTiersMaxScaleUp=function(){return eG},this.getTiersMaxScaleDown=function(){return ex},this.getTilesMaxCache=function(){return eJ},this.getTierWs=function(){return bo.join(",")},this.getTierHs=function(){return c4.join(", ")},this.getTierTileCounts=function(){return aM.join(", ")},this.getTilesLoadingNames=function(){var a=dD.join(", ")==""?"Current view loading complete":dD.join(", ");return a},this.setSizeAndPosition=function(c,a,d,b){aT(c,a,d,b)},this.setHotspotPath=function(a){eN&&(Z.hotspotPath=Z.Utils.removeTrailingSlashCharacters(a))},this.loadImageProperties=function(a){cM(a)},this.parseImageXML=function(a){dU(a)},this.updateView=function(b){if(typeof b!="undefined"&&b===!0||ff!=eO||Z.imageZ!=ce||parseFloat(ec.left)!=c7||parseFloat(ec.top)!=a2){ak(b),ce=eH.getZoom();var a=!1;b||ff!=eO||Z.imageZ!=ce||!ef?(e8(),bD(),ch(eF,e9,aW,"simple",!1,"2. Updating view: changing tier - backfill"),!b&&eJ>0&&(a=!0)):Z.debug==2&&Z.Utils.trace("2. Updating view: no change to tier."),cQ(),ch(fh,fb,cA,"centerOut",a,"3. Updating view: prior to loading of any new tiles"),bR(dD,bS,0),dM(),ao(),b1(),b7()}},this.formatTilePath=function(Y,H,at,X){var R;if(Z.tileSource=="ZoomifyImageFolder"){var an=at*a7[Y]+H;for(var V=0;V<Y;V++){an+=aM[V]}var P=Math.floor(an/ed);R=Z.imagePath+"/TileGroup"+P+"/"+Y+"-"+H+"-"+at+".jpg",R=Z.Utils.cacheProofPath(R)}else{if(Z.tileSource=="ZoomifyImageFile"){var ai=0,F=0,Q,W,u,ar,B,G,n,z,R="offsetLoading";for(var i=fG-1;i>Y;i--){ai+=aM[i]}ai+=at*a7[Y]+H,Q=Math.floor(ai/ej),F=ai-1==-1?0:ai-1,W=Math.floor(F/ej);if(bL[Q]==undefined||bL[Q]=="offsetLoading"||bL[W]==undefined||bL[W]=="offsetLoading"){var q=b2(Y,H,at);aC.push(q+","+Y+","+H+","+at+","+X),Z.debug==2&&Z.Utils.trace("Tile recorded for load retry after load chunk: "+q+","+Y+","+H+","+at+","+X),bL[Q]==undefined&&(bL[Q]="offsetLoading",B=eC+ej*Q*8,G=B+ej*8,aQ(B,G,q)),bL[W]==undefined&&(bL[W]="offsetLoading",n=eC+ej*W*8,z=n+ej*8,aQ(n,z,q))}else{var J=Math.floor(bL[Q][0]),U=Math.floor(bL[W][0]),s=bL[W][1],K=bL[Q][1];ar=9*(F%ej);var o=Math.floor(parseFloat(s.substring(ar,ar+9)));u=9*(ai%ej);var r=Math.floor(parseFloat(K.substring(u,u+9))),bi=ai==0?eC+ep*8:U+o,I=J+r;I-bi>0?R=Z.tileHandlerPathFull+"?file="+Z.imagePath+"&requestType=0&begin="+bi.toString()+"&end="+I.toString()+"&vers="+eu.toString()+"&head="+ek.toString():R="skipTile:"+Y+"-"+H+"-"+at}}}return R},this.parseOffsetChunk=function(c){var a=parseInt(c.documentElement.getAttribute("BEGIN"),10),f=c.documentElement.getAttribute("REPLYDATA"),b=dY[a],d=Math.floor((a-eC)/8/ej);bL[d]=new Array,bL[d]=f.split(",",2),fE(b)},this.parseHotspotsXML=function(P){var C=P.getElementsByTagName("HOTSPOTSETUP")[0],I=C.getAttribute("CHOICELIST");d6=Z.Utils.isStrVal(I)?I:Z.Utils.getResource("DEFAULT_HOTSPOTLISTPOSITION");var F=C.getAttribute("LISTSOURCE"),L=Z.Utils.isStrVal(F)?F:Z.Utils.getResource("DEFAULT_HOTSPOTLISTSOURCE"),D=C.getAttribute("LISTTITLE"),H=Z.hotspotListTitle!==null?Z.hotspotListTitle:Z.Utils.isStrVal(D)?D:Z.Utils.getResource("DEFAULT_HOTSPOTLISTTITLE"),A=Z.Utils.getResource("DEFAULT_HOTSPOTSINITIALVISIBILITY"),U=C.getAttribute("INITIALVISIBILITY");A?c2=U!="0"&&U!="hide":c2=U!="1"&&U!="show";var O=parseFloat(C.getAttribute("MINSCALE")),K=parseFloat(C.getAttribute("MAXSCALE"));fQ=isNaN(O)?1:O,bz=isNaN(K)?1:K;var R=[];bf=[],dW=[];var M=!1,G=-1,Q=P.getElementsByTagName("HOTSPOT");for(var z=0,J=Q.length;z<J;z++){var N=new dc(Q[z]);G++,N.internalID=G;if(bA(N)){cN.push(N);if(Q[z].getAttribute("MEDIATYPE")!="symbol"){var q=Q[z].getAttribute("MEDIA");Z.Utils.isStrVal(q)&&R.push(q)}else{Q[z].getAttribute("MEDIA")!="polygon"&&(M=!0)}var T=unescape(Q[z].getAttribute("ID")),x=unescape(Q[z].getAttribute("NAME")),B=unescape(Q[z].getAttribute("CAPTION")),k=unescape(Q[z].getAttribute("TOOLTIP"));switch(L){case"CAPTION":bf.push({text:B,value:T});break;case"TOOLTIP":bf.push({text:k,value:T});break;default:bf.push({text:x,value:T})}}}Z.debug==2&&M&&Z.Utils.trace(Z.Utils.getResource("ERROR_HOTSPOTMEDIAINVALID")),fj.visibility=c2?"visible":"hidden",eL(H,bf),fl(),R.sort(),R=Z.Utils.removeDups(R),fH(R)},this.createHotspot=function(R,F,K,H,N,G,J,C,W,Q,M,U,O,I){var T="<HOTSPOT ID='"+R+"' NAME='"+F+"' MEDIATYPE='"+K+"' MEDIA='"+H+"' X='"+N.toString()+"' Y='"+G.toString()+"' ZOOM='"+J.toString()+"' XSCALE='"+C.toString()+"' YSCALE='"+W.toString()+"' URL='"+Q+"' URLTARGET='"+M+"' ROLLOVER='"+U+"' CAPTION='"+O+"' TOOLTIP='"+I+"'></HOTSPOT>",B=Z.Utils.convertXMLTextToXMLDoc(T),L=B.getElementsByTagName("HOTSPOT"),P=new dc(L[0]);P.internalID=bU("hotspot");var q=dW.indexOfObjectValueSubstring("src",P.media),H=dW[q];if(q!=-1){var V=new Image;V.src=P.media;var A=V.width,D=V.height;V=null,P.image=H.cloneNode(!1),P.iW=A,P.iH=D;var k=new bK;cT(P,k)}else{var z=(new Date).getTime();a6(P.media,z)}cN.push(P),d7(P.name,P.internalID)},this.modifyHotspot=function(){},this.setHotspotsVisibility=function(a){fj.visibility=a?"visible":"hidden"},this.setHotspotsVisibilityByFilter=function(g,c,k){if(cN.length>0){if(eN&&eN.childNodes.length>0){for(var f=0,b=cN.length;f<b;f++){if(cN[f][g]==c){var d=cN[f].id,h=document.getElementById("hot"+d);h!=null&&c3(h,k)}}}else{var a=window.setTimeout(function(){setHotspotsVisibilityByFilter(g,c,k)},100)}}},this.setHotspotVisibilityByID=function(f,b){if(cN.length>0){if(eN&&eN.childNodes.length>0){var g=cN.indexOfObjectValue("id",f);if(g!=-1){var d=cN[g].id,a=document.getElementById("hot"+d);a!=null&&c3(a,b)}}else{var c=window.setTimeout(function(){setHotspotVisibilityByID(f,b)},100)}}},this.parseAnnotationsXML=function(at){dP=dO(at);var K,U=-1,P=dP.getElementsByTagName("LABELSETUP")[0];aY=P.getAttribute("PANELPOSITION"),c2=P.getAttribute("INITIALVISIBILITY")!="0",c6=P.getAttribute("NOTEVISIBILITY")!="0",fQ=parseFloat(P.getAttribute("MINSCALE")),bz=parseFloat(P.getAttribute("MAXSCALE")),fy=[],eh=[],df=[],dF=[],cC=[],dW=[];var Y=[],M=!1,R=dP.getElementsByTagName("POI");for(var I=0,bs=R.length;I<bs;I++){var ar=unescape(R[I].getAttribute("ID")),W=unescape(R[I].getAttribute("NAME")),bn=unescape(R[I].getAttribute("X")),ai=unescape(R[I].getAttribute("Y")),Q=unescape(R[I].getAttribute("ZOOM"));fy.push({text:W,value:ar,x:bn,y:ai,zoom:Q});var bi=R[I].getElementsByTagName("NOTES")[0];if(bi){var H=bi.getElementsByTagName("NOTE");for(var V=0,an=H.length;V<an;V++){var D=unescape(H[V].getAttribute("ID")),br=unescape(H[V].getAttribute("NAME")),G=unescape(H[V].getAttribute("TEXT"));eh.push({text:br,value:D,noteText:G,poiID:ar})}}var J=R[I].getElementsByTagName("LABELS")[0];if(J){var z=J.getElementsByTagName("LABEL");for(var F=0,q=z.length;F<q;F++){var A=unescape(z[F].getAttribute("NAME"));U++,z[F].setAttribute("INTERNALID",U.toString()),dF.push({text:A,value:U,poiID:ar});if(z[F].getAttribute("MEDIA")!="polygon"){if(z[F].getAttribute("MEDIATYPE")=="symbol"){var O=z[F].getAttribute("MEDIA"),X;switch(O){case"circle":X=Z.annotationPath+"/circle.png";break;case"square":X=Z.annotationPath+"/square.png";break;case"triangle":X=Z.annotationPath+"/triangle.png";break;case"arrowDown":X=Z.annotationPath+"/arrowDown.png";break;case"arrowDownLeft":X=Z.annotationPath+"/arrowDownLeft.png";break;case"arrowLeft":X=Z.annotationPath+"/arrowLeft.png";break;case"arrowUpLeft":X=Z.annotationPath+"/arrowUpLeft.png";break;case"arrowUp":X=Z.annotationPath+"/arrowUp.png";break;case"arrowUpRight":X=Z.annotationPath+"/arrowUpRight.png";break;case"arrowRight":X=Z.annotationPath+"/arrowRight.png";break;case"arrowRightDown":X=Z.annotationPath+"/arrowRightDown.png";break;case"lineHorizontal":X=Z.annotationPath+"/lineHorizontal.png";break;case"lineVertical":X=Z.annotationPath+"/lineVertical.png";break;default:X=Z.annotationPath+"/noSubstitutePlaceholder.png"}z[F].setAttribute("MEDIA",X),M=!0}Y.push(z[F].getAttribute("MEDIA"))}var B=new dc(z[F]);cN.push(B)}}}aX(),fj.visibility=c2?"visible":"hidden",bp(),Y.sort(),Y=Z.Utils.removeDups(Y),fH(Y)},this.togglePolygonEditing=function(g){bl!==null&&(Z.polygonEditing=g?g:!Z.polygonEditing,dm=null,aK=null,db=!1,ag=!0,cF(!0));var l=document.getElementById("buttonEditMode");if(l){var d=l.style}var b=document.getElementById("buttonEditDelete");if(b){var f=b.style}var m=document.getElementById("buttonEditCancel");if(m){var c=m.style}var k=document.getElementById("buttonEditSave");if(k){var h=k.style}d&&c&&f&&h&&(Z.polygonEditing?(Z.Toolbar.buttonGraphicsReset(l,"hidden"),Z.Toolbar.buttonGraphicsReset(b,"visible"),Z.Toolbar.buttonGraphicsReset(m,"visible"),Z.Toolbar.buttonGraphicsReset(k,"visible")):(Z.Toolbar.buttonGraphicsReset(l,"visible"),Z.Toolbar.buttonGraphicsReset(b,"hidden"),Z.Toolbar.buttonGraphicsReset(m,"hidden"),Z.Toolbar.buttonGraphicsReset(k,"hidden"))),Z.mobileDevice&&Z.polygonEditing&&Z.progressVisible?Z.Toolbar.hideProgress():Z.progressVisible&&Z.Toolbar.showProgress(),Z.polygonEditing?(bN=Z.Utils.clone("hotspots",cN,bN),aE=Z.Utils.clone("labels",dF,aE)):(Z.Utils.removeEventListener(document,"mousemove",cg),g!=0&&(Z.Utils.showMessage(Z.Utils.getResource("ALERT_SAVINGUNSAVEDEDITS")),this.saveAnnotations()))},this.deleteCurrentLabel=function(){bW(bl);var a=cN.indexOfObjectValue("internalID",bl);a!=-1&&(cN.splice(a,1),cN.length>0?bl=parseInt(a9.options[a9.selectedIndex].value):bl=null,dm=null,aK=null,ao())},this.cancelLabelEdits=function(){Z.Utils.showMessage(Z.Utils.getResource("ALERT_CANCELLINGUNSAVEDEDITS")),cN=Z.Utils.clone("hotspots",bN,cN),dF=Z.Utils.clone("labels",aE,dF);var a=cb.options[cb.selectedIndex].value;cC=fJ(dF,a),Z.Utils.updateSelectElement(a9,cC),bl=parseInt(a9.options[a9.selectedIndex].value),ao(),this.togglePolygonEditing(!1)},this.saveAnnotations=function(){dP=dT(dP);if(Z.Utils.isStrVal(Z.saveHandlerPath)){if(Z.saveHandlerPath.indexOf(Z.Utils.getResource("ALERT_SAVEDISABLEDFORDEMOKEY"))!=-1){Z.Utils.showMessage(Z.Utils.getResource("ALERT_SAVEDISABLEDFORDEMOTEXT"))}else{var a=new Z.NetConnector;a.postXML(Z.saveHandlerPath,dP)}}else{Z.Utils.showMessage(Z.Utils.getResource("ERROR_XMLSAVEHANDLERPATHINVALID"))}this.togglePolygonEditing(!1)},this.setAllHotspotsSaved=function(){for(var b=0,a=cN.length;b<a;b++){cN[b].saved==1}},this.setView=function(b,a,c){if(b==undefined||b==null){b=Z.imageW/2}if(a==undefined||a==null){a=Z.imageH/2}c==undefined||c==null?c=Z.fitZ:c>1&&(c/=100),bh(b,a,c)},this.zoom=function(a){switch(a){case"out":dR>=0&&(dR-=cY);break;case"in":dR<=0&&(dR+=cY);break;case"stop":dR=0}Z.zooming=dR==0?"stop":dR>0?"in":"out",dR!=0?ba||((dR<0&&Z.imageZ>Z.minZ||dR>0&&Z.imageZ<Z.maxZ)&&eH.toggleWatermarks(!1),Z.useCanvas||bH(fo),ba=window.setTimeout(dj,bu)):(aI(),eH.updateView(),eH.toggleWatermarks(!0))},this.pan=function(a){switch(a){case"left":bv<=0&&(bv+=fN);break;case"up":bb<=0&&(bb+=fN);break;case"down":bb>=0&&(bb-=fN);break;case"right":bv>=0&&(bv-=fN);break;case"horizontalStop":bv=0;break;case"verticalStop":bb=0;break;case"stop":bv=0,bb=0}Z.panningX=bv==0?"stop":bv>0?"left":"right",Z.panningY=bb==0?"stop":bb>0?"up":"down",bY=Z.imageX*dV(fb,1),aP=Z.imageY*dV(fb,1),bv!=0||bb!=0?ba||(eH.toggleWatermarks(!1),Z.useCanvas||bH(fo),ba=window.setTimeout(dj,bu)):(aI(),eH.updateView(),eH.toggleWatermarks(!0))},this.zoomAndPanToView=function(b,f,d,a,c){eH.zoomAndPanAllStop();if(typeof a=="undefined"||a===null){a=cD}if(typeof c=="undefined"||c===null){c=eq}eH.toggleWatermarks(!1),Z.useCanvas||bH(fo),b==null&&(b=Z.initialX),f==null&&(f=Z.initialY),d==null?d=Z.initialZ:d>1&&d<2&&d%1!=0?d=1:d>1?d/=100:d>0.99&&d<1&&d*100%1!=0&&(d=1);var e=af(b,f,d);b=e.x,f=e.y,d=aV(d),bO=0,ad(b,f,d,a,c)},this.zoomAndPanAllStop=function(a){aI(),c8(),a||eH.updateView()},this.scaleTierToZoom=function(b){var a=fC(b);a&&(dM(),ao(),b7())},this.reset=function(){eH.zoomAndPanToView(Z.initialX,Z.initialY,Z.initialZ)},this.toggleFullPageViewExternal=function(){cI=!0,eH.toggleFullPageView()},this.toggleFullPageView=function(a){window.scrollTo(0,0);setTimeout(function(){jQuery("#slideshow-copyright").toggleClass("fullscreen_copyright"),jQuery("#zoomify-factsheet").length?jQuery("#zoomify-factsheet").attr("id","zoomify-factsheet-full"):jQuery("#zoomify-factsheet-full").length&&jQuery("#zoomify-factsheet-full").attr("id","zoomify-factsheet"),jQuery("#ViewerDisplay").length?jQuery("#ViewerDisplay").attr("id","ViewerDisplayFull"):jQuery("#ViewerDisplayFull").length&&jQuery("#ViewerDisplayFull").attr("id","ViewerDisplay"),jQuery("#ToolbarDisplay").length?jQuery("#ToolbarDisplay").attr("id","ToolbarDisplayFull"):jQuery("#ToolbarDisplayFull").length&&jQuery("#ToolbarDisplayFull").attr("id","ToolbarDisplay"),eH.zoomAndPanAllStop(),Z.fullPage=a?a:!Z.fullPage;var g=document.body,b=g.style,m=document.documentElement.style,y=Z.ViewerDisplay.style,e=null,x=null;if(Z.fullPage){d1=b.width,aF=b.height,cq=b.overflow,dw=m.overflow,fL=y.backgroundColor,e1=y.position,av=y.zIndex;var w;Z.mobileDevice?(w=Z.Utils.getWindowSize(),b.width=w.x,b.height=w.y):(b.width="100%",b.height="100%"),b.overflow="hidden",m.overflow="hidden",y.backgroundColor=Z.Utils.getResource("DEFAULT_FULLPAGEBACKCOLOR"),y.position="fixed",y.zIndex="99999999",w=Z.Utils.getWindowSize(),e=w.x,x=w.y}else{b.width=d1,b.height=aF,b.overflow=cq,m.overflow=dw,y.backgroundColor=fL,y.position="relative",y.zIndex=av;var t=Z.Utils.getElementStyle(Z.pageContainer);e=parseFloat(t.width),x=parseFloat(t.height),isNaN(e)&&(e=Z.ViewerDisplay.clientWidth),isNaN(x)&&(x=Z.ViewerDisplay.clientHeight),cI=!1}Z.viewerW=e,Z.viewerH=x,aT(e,x),a3(cI);if(Z.ToolbarDisplay&&Z.Toolbar.getInitialized()){Z.toolbarCurrentW=Z.toolbarW==-1?e:Z.toolbarW;var k=Z.toolbarPosition==1?Z.viewerH-Z.toolbarH:0;Z.Toolbar.setSizeAndPosition(Z.toolbarCurrentW,null,null,k)}Z.NavigatorDisplay&&Z.Navigator.getInitialized()&&Z.Navigator.setSizeAndPosition(Z.navigatorW,Z.navigatorH,Z.navigatorL-1,Z.navigatorT-1),c9(),Z.imageZ=aV(Z.imageZ);var v=parseFloat(ec.left),q=parseFloat(ec.top),d=dC(v,q);ec.left=d.x+"px",ec.top=d.y+"px",eH.updateView(!0)},100)},this.toggleBackfill=function(){var a=Z.ViewerDisplay.firstChild.childNodes[0].style;a.display=a.display=="none"?"inline-block":"none"},this.toggleDisplay=function(){var a=Z.ViewerDisplay.firstChild.childNodes[1].style;a.display=a.display=="none"?"inline-block":"none"},this.toggleWatermarks=function(b){if(e2){var a=b?b:e2.display!="inline-block";e2.display=a?"inline-block":"none"}},this.toggleConstrainPan=function(){Z.constrainPan=!Z.constrainPan;if(Z.constrainPan){var a=parseFloat(eX.left),c=parseFloat(eX.top),b=dC(a,c);ec.left=b.x+"px",ec.top=b.y+"px",eH.updateView()}},this.getClickZoomCoords3D=function(g,c,k,f){var b=parseFloat(Z.Utils.getResource("DEFAULT_CLICKZOOMTIERSKIPTHRESHOLD")),d=cj(c.x,c.y),h=by(d.x,d.y),a=dV(k,f);return g.altKey?(f>1+b?a=dV(k,1):k>0&&(a=dV(k-1,1)),a-Z.fitZ<b&&(a=Z.fitZ)):f<1-b?a=dV(k,1):k<fG-1&&(a=dV(k+1,1)),new Z.Utils.Point3D(h.x,h.y,a)},this.syncToNavigator=function(g,l){var d=-(g-Z.imageX),b=-(l-Z.imageY),f=d*Z.imageZ,m=b*Z.imageZ,c=f+c7,k=m+a2,h=dC(c,k);ec.left=h.x+"px",ec.top=h.y+"px"},this.calculateCurrentCenterCoordinates=function(f){if(!f){var f=new Z.Utils.Point(parseFloat(ec.left),parseFloat(ec.top))}var b=f.x-c7,h=f.y-a2,d=b/Z.imageZ,a=h/Z.imageZ,c=Z.imageX-d,g=Z.imageY-a;return new Z.Utils.Point(c,g)}},Z.ZoomifyToolbar=function(aH){function aK(aY,P){Z.ToolbarDisplay=Z.Utils.createContainerElement("div","ToolbarDisplay","inline-block","absolute","hidden","1px","1px","0px","1px","none","0px","transparent none","0px","0px","normal","default"),at=Z.ToolbarDisplay.style;var aQ=new Z.Utils.Graphic("background",Z.skinPath,P[0],"1px","1px","0px","0px");Z.ToolbarDisplay.appendChild(aQ.elmt),toolbarSkinSizes=aY;if(Z.logoVisible){var U;if(!Z.Utils.isStrVal(Z.logoCustomPath)){U=new Z.Utils.Graphic("toolbarLogo",Z.skinPath,P[1],"1px","1px","1px","1px")}else{var aP=Z.Utils.cacheProofPath(Z.logoCustomPath);U=new Z.Utils.Graphic("toolbarLogo",aP,null,"1px","1px","1px","1px")}Z.ToolbarDisplay.appendChild(U.elmt);if(Z.toolbarVisible==0||Z.toolbarVisible==1){var L=new Z.Utils.Graphic("logoDivider",Z.skinPath,P[2],"1px","1px","1px","1px");Z.ToolbarDisplay.appendChild(L.elmt)}}var a2=Z.Utils.createContainerElement("div","buttonContainer","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent none","0px","0px","normal","default");Z.ToolbarDisplay.appendChild(a2),Z.mobileDevice?Z.Utils.addEventListener(a2,"touchstart",Z.Utils.preventDefault):(Z.Utils.addEventListener(a2,"mousedown",Z.Utils.preventDefault),Z.Utils.addEventListener(a2,"mouseover",X));var aX=new Z.Utils.Graphic("buttonBackground",Z.skinPath,P[0],"1px","1px","0px","0px");a2.appendChild(aX.elmt);if(Z.toolbarVisible!=0&&Z.toolbarVisible!=1||Z.mobileDevice){var aS=new Z.Utils.Button("buttonMinimize",null,Z.skinPath,P[3],P[4],P[5],"1px","1px","1px","1px","mouseover",ae,"TIP_MINIMIZE");Z.ToolbarDisplay.appendChild(aS.elmt);var a0=new Z.Utils.Button("buttonExpand",null,Z.skinPath,P[6],P[7],P[8],"1px","1px","1px","1px","mouseover",ae,"TIP_EXPAND");Z.ToolbarDisplay.appendChild(a0.elmt)}var aV=new Z.Utils.Button("buttonZoomOut",null,Z.skinPath,P[9],P[10],P[11],"1px","1px","1px","1px","mouseover",ae,"TIP_ZOOMOUT");a2.appendChild(aV.elmt);if(Z.sliderVisible){var aO=new Z.Utils.Graphic("trackSlider",Z.skinPath,P[12],"1px","1px","0px","0px");a2.appendChild(aO.elmt),Z.Utils.addEventListener(aO.elmt,"mousedown",ae),Z.Utils.addEventListener(aO.elmt,"touchstart",ae);var aZ=new Z.Utils.Button("buttonSlider",null,Z.skinPath,P[14],P[15],P[16],"1px","1px","1px","1px","mouseover",ae,"TIP_SLIDER");a2.appendChild(aZ.elmt)}var H=new Z.Utils.Button("buttonZoomIn",null,Z.skinPath,P[17],P[18],P[19],"1px","1px","1px","1px","mouseover",ae,"TIP_ZOOMIN");a2.appendChild(H.elmt);var aR=new Z.Utils.Graphic("panDivider",Z.skinPath,P[20],"1px","1px","1px","1px");a2.appendChild(aR.elmt);var aW=new Z.Utils.Button("buttonPanLeft",null,Z.skinPath,P[21],P[22],P[23],"1px","1px","1px","1px","mouseover",ae,"TIP_PANLEFT");a2.appendChild(aW.elmt);var x=new Z.Utils.Button("buttonPanUp",null,Z.skinPath,P[24],P[25],P[26],"1px","1px","1px","1px","mouseover",ae,"TIP_PANUP");a2.appendChild(x.elmt);var a1=new Z.Utils.Button("buttonPanDown",null,Z.skinPath,P[27],P[28],P[29],"1px","1px","1px","1px","mouseover",ae,"TIP_PANDOWN");a2.appendChild(a1.elmt);var z=new Z.Utils.Button("buttonPanRight",null,Z.skinPath,P[30],P[31],P[32],"1px","1px","1px","1px","mouseover",ae,"TIP_PANRIGHT");a2.appendChild(z.elmt);var N=new Z.Utils.Button("buttonReset",null,Z.skinPath,P[33],P[34],P[35],"1px","1px","1px","1px","mouseover",ae,"TIP_RESET");a2.appendChild(N.elmt);if(Z.fullPageVisible){var i=new Z.Utils.Graphic("fullPageDivider",Z.skinPath,P[36],"1px","1px","1px","1px");a2.appendChild(i.elmt);var S=new Z.Utils.Button("buttonFullPage",null,Z.skinPath,P[37],P[38],P[39],"1px","1px","1px","1px","mouseover",ae,"TIP_TOGGLEFULLPAGE");a2.appendChild(S.elmt)}if(Z.editMode&&Z.useCanvas){var aT=new Z.Utils.Button("buttonEditMode",null,Z.skinPath,P[40],P[41],P[42],"1px","1px","1px","1px","mouseover",ae,"TIP_TOGGLEEDITMODE");a2.appendChild(aT.elmt);var aN=new Z.Utils.Button("buttonEditCancel",null,Z.skinPath,P[43],P[44],P[45],"1px","1px","1px","1px","mouseover",ae,"TIP_EDITCANCEL");a2.appendChild(aN.elmt);var q=new Z.Utils.Button("buttonEditDelete",null,Z.skinPath,P[46],P[47],P[48],"1px","1px","1px","1px","mouseover",ae,"TIP_EDITDELETE");a2.appendChild(q.elmt);var s=new Z.Utils.Button("buttonEditSave",null,Z.skinPath,P[49],P[50],P[51],"1px","1px","1px","1px","mouseover",ae,"TIP_EDITSAVE");a2.appendChild(s.elmt)}if(Z.progressVisible){var a3=Z.Utils.createContainerElement("div","progressTextBox","inline-block","absolute","hidden","1px","1px","1px","1px","none","0px","transparent none","0px","0px","normal"),R=toolbarSkinSizes[16];a2.appendChild(a3);var W=document.createTextNode(Z.Utils.getResource("DEFAULT_PROGRESSTEXT"));a3.appendChild(Z.Utils.createCenteredElement(W)),Z.Utils.setTextStyle(W,"black","verdana",R+"px","none","normal","normal","normal","normal","1em","left","none"),Z.Utils.addEventListener(a3,"contextmenu",Z.Utils.preventDefault),Z.Utils.disableTextInteraction(W)}Z.ViewerDisplay.appendChild(Z.ToolbarDisplay),Z.toolbarW=toolbarSkinSizes[0],Z.toolbarCurrentW=Z.toolbarW==-1?Z.viewerW:Z.toolbarW,Z.toolbarH=aD=toolbarSkinSizes[1];var aU=Z.toolbarPosition==1?Z.viewerH-aD:0;an(Z.toolbarCurrentW,Z.toolbarH,0,aU);if(Z.Viewport&&Z.Viewport.getInitialized()){var I=Z.Viewport.getZoom();ac(I)}aa(Z.toolbarVisible==1||Z.toolbarVisible==2||Z.toolbarVisible==4),Z.Utils.addEventListener(Z.ToolbarDisplay,"mouseover",Z.Utils.stopPropagation),Q(!0)}function ao(){window.clearInterval(ap),ap=null;var a=document.getElementById("progressTextBox").firstChild.firstChild.firstChild.firstChild;a&&(a.nodeValue="")}function ag(){return ay}function Q(a){ay=a}function an(d,a,f,c){typeof d=="undefined"||d===null?d=Z.toolbarVisible>0?Z.toolbarCurrentW:0:Z.toolbarCurrentW=d;if(typeof a=="undefined"||a===null){a=Z.toolbarVisible>0?aD:0}if(typeof f=="undefined"||f===null){f=0}if(typeof c=="undefined"||c===null){c=Z.toolbarPosition==1?Z.viewerH-aD:0}var b=Z.ToolbarDisplay.style;b.width=d+"px",b.height=a+"px",b.left=f+"px",b.top=c+"px",K(d,a)}function K(bd,aZ){var a6=bd,a1=aZ,ba=toolbarSkinSizes[2],a0=toolbarSkinSizes[3],a5=toolbarSkinSizes[4],aY=toolbarSkinSizes[5],bi=toolbarSkinSizes[6],bc=toolbarSkinSizes[7],a7=toolbarSkinSizes[8],bf=toolbarSkinSizes[9],bb=toolbarSkinSizes[10],a4=toolbarSkinSizes[11],be=toolbarSkinSizes[12],aX=toolbarSkinSizes[13],bg=toolbarSkinSizes[14],aV=toolbarSkinSizes[15],bK=0,bv=(a1-a0)/2+1,aU=(a1-aY)/2,bs=(a1-bc)/2,bB=bs*1.3,bM=bs+4,a8=bs+2,bD=Z.logoVisible==1?0:a7/2,bP=Z.logoVisible==1?0:a7/2,bA=a7-(bi-a5),bC=Z.fullPageVisible?8:7,bj=20,bL=bC*a7+2*bA;Z.sliderVisible&&(bL+=aX),az=aF=am=!1;var bz=Z.logoVisible==1?ba+2:0,bH=Z.toolbarVisible!=0&&Z.toolbarVisible!=1?a7:0,bO=bz+bH,a9=bO+bj+bL+bj+bg;a9>a6&&(az=!0,a9-aX>a6&&(aF=!0,a9-aX-bg>a6&&(am=!0,bO=0),bg=0),bL-=aX);var bJ=bO+(a6-bg-bO-bL)/2,bG=document.getElementById("background");bG.style.width=a6+"px",bG.firstChild.style.width=a6+"px",bG.style.height=a1+"px",bG.firstChild.style.height=a1+"px";var a3=document.getElementById("buttonContainer");a3.style.width=bL+bj*2+"px",a3.style.height=a1+"px",a3.style.left=bJ-bj+"px";var bx=document.getElementById("buttonBackground");bx.style.width=a6+"px",Z.Utils.graphicSize(bx,parseFloat(a3.style.width),parseFloat(a3.style.height)),bx.style.left="0px";var br=document.getElementById("toolbarLogo");if(br){var aT=br.style;if(aT){if(!am){aT.display="inline-block",Z.Utils.graphicSize(br,ba,a0),aT.left=bK+"px",aT.top=bv+"px",bK+=ba+2;var bp=document.getElementById("logoDivider");if(bp){Z.Utils.graphicSize(bp,a5,aY);var bo=bp.style;bo.left=bK+"px",bo.top=aU+"px"}}else{aT.display="none"}}}if(Z.toolbarVisible!=0&&Z.toolbarVisible!=1){var bq=document.getElementById("buttonMinimize"),bW=document.getElementById("buttonExpand");if(bq&&bW){var bF=bq.style,bE=bW.style;bF&&bE&&(am?(bF.display="none",bE.display="none"):(bF.display="inline-block",bE.display="inline-block",Z.Utils.buttonSize(bq,bi,bc),Z.Utils.buttonSize(bW,bi,bc),bF.left=bK+bD+"px",bF.top=bB+"px",bE.left=bK+bP+"px",bE.top=bB+"px"))}}bK=bj;var by=document.getElementById("buttonZoomOut");Z.Utils.buttonSize(by,bi,bc);var bI=by.style;bI.left=bK+"px",bI.top=bs+"px",bK+=a7;var bm=document.getElementById("trackSlider"),b3=document.getElementById("buttonSlider");if(bm&&b3){var bu=bm.style,bn=b3.style;bu&&bn&&(az?(bu.display="none",bn.display="none"):(bu.display="inline-block",bn.display="inline-block",Z.Utils.graphicSize(bm,a4,be),bu.left=bK-2+"px",bu.top=bM+"px",Z.Utils.buttonSize(b3,bf,bb),bn.left=parseFloat(bu.left)+"px",bn.top=a8+"px",bK+=aX))}var b0=document.getElementById("buttonZoomIn");Z.Utils.buttonSize(b0,bi,bc);var aS=b0.style;aS.left=bK+"px",aS.top=bs+"px",bK+=a7+1;var bS=document.getElementById("panDivider");Z.Utils.graphicSize(bS,a5,aY);var aW=bS.style;aW.left=bK+"px",aW.top=aU+"px",bK+=bA;var a2=document.getElementById("buttonPanLeft");Z.Utils.buttonSize(a2,bi,bc);var bN=a2.style;bN.left=bK+"px",bN.top=bs+"px",bK+=a7;var bX=document.getElementById("buttonPanUp");Z.Utils.buttonSize(bX,bi,bc);var bZ=bX.style;bZ.left=bK+"px",bZ.top=bs+"px",bK+=a7;var aR=document.getElementById("buttonPanDown");Z.Utils.buttonSize(aR,bi,bc);var bk=aR.style;bk.left=bK+"px",bk.top=bs+"px",bK+=a7;var aP=document.getElementById("buttonPanRight");Z.Utils.buttonSize(aP,bi,bc);var aN=aP.style;aN.left=bK+"px",aN.top=bs+"px",bK+=a7;var aQ=document.getElementById("buttonReset");Z.Utils.buttonSize(aQ,bi,bc);var bR=aQ.style;bR.left=bK+"px",bR.top=bs+"px",bK+=a7+1;var bQ=document.getElementById("fullPageDivider");if(bQ){Z.Utils.graphicSize(bQ,a5,aY);var bU=bQ.style;bU.left=bK+"px",bU.top=aU+"px",bK+=bA;var bh=document.getElementById("buttonFullPage");Z.Utils.buttonSize(bh,bi,bc);var y=bh.style;y.left=bK+"px",y.top=bs+"px"}var aO=document.getElementById("buttonEditMode");if(aO){bK+=a7+10,Z.Utils.buttonSize(aO,bi,bc);var b2=aO.style;b2.left=bK+"px",b2.top=bs+"px"}var b1=document.getElementById("buttonEditCancel");if(b1){Z.Utils.buttonSize(b1,bi,bc);var bV=b1.style;bV.left=bK+"px",bV.top=bs+"px",bV.visibility="hidden"}var bT=document.getElementById("buttonEditDelete");if(bT){bK+=a7+1,Z.Utils.buttonSize(bT,bi,bc);var bl=bT.style;bl.left=bK+"px",bl.top=bs+"px",bl.visibility="hidden"}var g=document.getElementById("buttonEditSave");if(g){bK+=a7+1,Z.Utils.buttonSize(g,bi,bc);var m=g.style;m.left=bK+"px",m.top=bs+"px",m.visibility="hidden"}var bY=document.getElementById("progressTextBox");if(bY){var bw=bY.style;bw&&(aF?bw.display="none":(bw.display="inline-block",bw.width=bg+"px",bw.height=aV+"px",bw.left=a6-parseFloat(a3.style.left)-parseFloat(bw.width)+"px",bw.top=(a1-parseFloat(bw.height))/2+"px"))}}function aa(a){Z.toolbarVisible<4&&!Z.mobileDevice?ai(a):aB(!a)}function ai(a){at&&(a?at.display="inline-block":at.display="none")}function aB(h){if(at){var f=document.getElementById("buttonContainer"),l=document.getElementById("background"),g=document.getElementById("buttonMinimize"),d=document.getElementById("buttonExpand"),k=document.getElementById("logoDivider"),c=0;am||(c=parseFloat(d.style.left)+parseFloat(d.style.width)+4);var b=Z.toolbarCurrentW;h?(f.style.display="none",am||(k&&(k.style.display="none"),g.style.display="none",d.style.display="inline-block"),at.width=c+"px",l.style.width=c+"px"):(f.style.display="inline-block",am||(k&&(k.style.display="inline-block"),g.style.display="inline-block",d.style.display="none"),at.width=b+"px",l.style.width=b+"px")}}function ac(d){if(Z.sliderVisible){ax||(ax=document.getElementById("trackSlider")),aq||(aq=ax.style),aL||(aL=document.getElementById("buttonSlider")),aG||(aG=aL.style);if(aq&&aG){var b=Z.maxZ-Z.minZ,f=(d-Z.minZ)/b;trackL=parseFloat(aq.left),trackR=parseFloat(aq.left)+parseFloat(aq.width)-parseFloat(aG.width);var c=trackR-trackL,a=f*c+trackL;aG.left=a+"px"}}}function ak(b){ax||(ax=document.getElementById("trackSlider")),aq||(aq=ax.style);if(ax&&aq){var d,c=Z.Utils.getElementPosition(ax);Z.mobileDevice?d=Z.Utils.getMousePosition(b).x-c.x:d=b.clientX-c.x;var a=ah(d,0,parseFloat(aq.width));a<Z.minZ+0.1&&(a=Z.minZ),a>Z.maxZ-0.1&&(a=Z.maxZ),aH.scaleTierToZoom(a),aH.updateView()}}function Y(b){aE=!0,aL||(aL=document.getElementById("buttonSlider"));if(aL){var a=Z.Utils.getMousePosition(b);aL.mouseXPrior=a.x,aL.mouseYPrior=a.y}}function ab(a){ax||(ax=document.getElementById("trackSlider")),aq||(aq=ax.style),aL||(aL=document.getElementById("buttonSlider")),aG||(aG=aL.style);if(aq&&aL&&aG){trackL=parseFloat(aq.left),trackR=parseFloat(aq.left)+parseFloat(aq.width)-parseFloat(aG.width);var c=parseFloat(aG.left)+(aI.x-aL.mouseXPrior);c<trackL?c=trackL:c>trackR?c=trackR:aL.mouseXPrior=aI.x,aG.left=c+"px";var b=ah(c,trackL,trackR);aH.scaleTierToZoom(b)}}function aM(){aE=!1,aH.updateView()}function ah(f,b,h){var d=h-b,a=(f-b)/d,c=Z.maxZ-Z.minZ,g=Z.minZ+c*a;return g}function X(b){var b=Z.Utils.event(b),a=Z.Utils.relatedTarget(b);if(!aE&&a){var c=a.parentNode;aj(c)}}function ae(d){Z.mobileDevice&&d.preventDefault();var d=Z.Utils.event(d),b=Z.Utils.target(d),f=Z.Utils.relatedTarget(d);if(b){var c=b.parentNode;c&&(targetParentID=c.id)}if(f){var a=f.parentNode;a&&(relatedTargetParentID=a.id)}if(!aE||d.type=="mouseup"||d.type=="touchend"||d.type=="touchcancel"){ad(),b&&!Z.Utils.isRightMouseButton(d)&&(targetParentID&&targetParentID!="trackSlider"&&d.type!="mousemove"&&(av(d),V(d)),J(d))}}function aj(a){aH&&aH.zoomAndPanAllStop(true),a&&Z.Utils.isStrVal(a.id)&&(a.id.indexOf("button")!=-1?(aC(a),af(a,null)):a.id.indexOf("background")!=-1&&ad())}function aC(a){Z.Utils.removeEventListener(a,"mousedown",ae),Z.Utils.removeEventListener(a,"mouseup",ae),Z.Utils.removeEventListener(a,"mouseout",ae),Z.Utils.addEventListener(a,"mouseover",ae)}function af(d,b){var f=document.getElementById(d._imgUpID),c=document.getElementById(d._imgOverID),a=document.getElementById(d._imgDownID);f&&(f.style.visibility=b!==null?b:"visible"),c&&(c.style.visibility="hidden"),a&&(a.style.visibility="hidden")}function ad(){var g=Z.ToolbarDisplay.childNodes,c=null;for(var k=0,f=g.length;k<f;k++){c=g[k];if(c.id&&c.id.indexOf("button")!=-1){if(c.id!="buttonContainer"){aC(c),af(c,null)}else{var b=c.childNodes,d=null;for(var h=0,a=b.length;h<a;h++){d=b[h],d.id&&d.id.indexOf("button")!=-1&&(!Z.editMode||d.id!="buttonEditMode"&&d.id!="buttonEditCancel"&&d.id!="buttonEditDelete"&&d.id!="buttonEditSave")&&(aC(d),af(d,null))}}}}}function av(b){var a=Z.Utils.target(b);if(a){var c=a.parentNode;c&&(Z.mobileDevice?(Z.Utils.removeEventListener(c,"touchstart",ae),Z.Utils.removeEventListener(c,"touchend",ae),Z.Utils.removeEventListener(c,"touchcancel",ae)):(Z.Utils.removeEventListener(c,"mouseover",ae),Z.Utils.removeEventListener(c,"mousedown",ae),Z.Utils.removeEventListener(c,"mouseup",ae),Z.Utils.removeEventListener(c,"mouseout",ae)))}}function V(g){var l=Z.Utils.target(g);if(l){var d=Z.Utils.target(g).parentNode;if(d){if(!d._imgUpID){aj(d)}else{var b=document.getElementById(d._imgUpID),f=document.getElementById(d._imgOverID),m=document.getElementById(d._imgDownID);if(b&&f&&m){var c=b.style,k=f.style,h=m.style;c.visibility="hidden",k.visibility="hidden",h.visibility="hidden";switch(g.type){case"mouseover":k.visibility="visible";break;case"mousedown":h.visibility="visible";break;case"mousemove":h.visibility="visible";break;case"mouseup":k.visibility="visible";break;case"mouseout":c.visibility="visible";break;case"touchstart":h.visibility="visible";break;case"touchend":c.visibility="visible";break;case"touchcancel":c.visibility="visible"}}}}}}function J(c){var b=Z.Utils.target(c).parentNode;if(b){var a=b.id;switch(c.type){case"mouseover":Z.Utils.addEventListener(b,"mousedown",ae);break;case"mousedown":Z.Utils.addEventListener(b,"mouseup",ae);if(aH){switch(a){case"buttonMinimize":ar.minimize(!0),Z.Navigator.setVisibility(!1);break;case"buttonExpand":ar.minimize(!1),Z.Navigator.setVisibility(!0);break;case"buttonZoomOut":aH.zoom("out");break;case"buttonSlider":Y(c),al(c),Z.Utils.addEventListener(document,"mousemove",al),aw||(aw=window.setInterval(ab,aJ)),Z.Utils.addEventListener(document,"mouseup",ae);break;case"trackSlider":ak(c);break;case"buttonZoomIn":aH.zoom("in");break;case"buttonPanLeft":aH.pan("left");break;case"buttonPanUp":aH.pan("up");break;case"buttonPanDown":aH.pan("down");break;case"buttonPanRight":aH.pan("right");break;case"buttonReset":aH.reset()}}break;case"mouseup":Z.Utils.addEventListener(b,"mousedown",ae),aH&&(a=="buttonSlider"||aE?(aw&&(window.clearInterval(aw),aw=null),aM(),Z.Utils.removeEventListener(document,"mousemove",al),Z.Utils.removeEventListener(document,"mouseup",ae),ad()):a=="buttonZoomOut"||a=="buttonZoomIn"?aH.zoom("stop"):a=="buttonPanLeft"||a=="buttonPanRight"?aH.pan("horizontalStop"):a=="buttonPanUp"||a=="buttonPanDown"?aH.pan("verticalStop"):a=="buttonFullPage"?aH.toggleFullPageView():a=="buttonEditMode"?aH.togglePolygonEditing():a=="buttonEditDelete"?aH.deleteCurrentLabel():a=="buttonEditCancel"?aH.cancelLabelEdits():a=="buttonEditSave"&&aH.saveAnnotations());break;case"mouseout":Z.Utils.addEventListener(b,"mouseover",ae),aH&&(a=="buttonZoomOut"||a=="buttonZoomIn"?aH.zoom("stop"):a=="buttonPanLeft"||a=="buttonPanRight"?aH.pan("horizontalStop"):(a=="buttonPanUp"||a=="buttonPanDown")&&aH.pan("verticalStop"));break;case"touchstart":Z.Utils.addEventListener(b,"touchend",ae),Z.Utils.addEventListener(b,"touchcancel",ae);if(aH){switch(a){case"buttonMinimize":ar.minimize(!0),Z.Navigator.setVisibility(!1);break;case"buttonExpand":ar.minimize(!1),Z.Navigator.setVisibility(!0);break;case"buttonZoomOut":aH.zoom("out");break;case"buttonSlider":Y(c),G(c),Z.Utils.addEventListener(document,"touchmove",G),aw||(aw=window.setInterval(ab,aJ)),Z.Utils.addEventListener(b,"touchend",ae),Z.Utils.addEventListener(b,"touchcancel",ae);break;case"trackSlider":ak(c);break;case"buttonZoomIn":aH.zoom("in");break;case"buttonPanLeft":aH.pan("left");break;case"buttonPanUp":aH.pan("up");break;case"buttonPanDown":aH.pan("down");break;case"buttonPanRight":aH.pan("right");break;case"buttonReset":aH.reset()}}break;case"touchend":Z.Utils.addEventListener(b,"touchstart",ae),aH&&(a=="buttonZoomOut"||a=="buttonZoomIn"?(aH.zoom("stop"),Z.debug==0&&a=="buttonZoomOut"&&c.altKey&&Z.Utils.showGlobals()):a=="buttonSlider"?(aw&&(window.clearInterval(aw),aw=null),aM(),Z.Utils.removeEventListener(document,"touchmove",G)):a=="buttonPanLeft"||a=="buttonPanRight"?aH.pan("horizontalStop"):a=="buttonPanUp"||a=="buttonPanDown"?aH.pan("verticalStop"):a=="buttonFullPage"?aH.toggleFullPageView():a=="buttonEditMode"?aH.togglePolygonEditing():a=="buttonEditDelete"?aH.deleteCurrentLabel():a=="buttonEditCancel"?aH.cancelLabelEdits():a=="buttonEditSave"&&aH.saveAnnotations());break;case"touchcancel":Z.Utils.addEventListener(b,"touchstart",ae),aH&&(a=="buttonZoomOut"||a=="buttonZoomIn"?(aH.zoom("stop"),Z.debug==0&&a=="buttonZoomOut"&&c.altKey&&Z.Utils.showGlobals()):a=="buttonSlider"?(aw&&(window.clearInterval(aw),aw=null),aM(),Z.Utils.removeEventListener(document,"touchmove",G)):a=="buttonPanLeft"||a=="buttonPanRight"?aH.pan("horizontalStop"):a=="buttonPanUp"||a=="buttonPanDown"?aH.pan("verticalStop"):a=="buttonFullPage"?aH.toggleFullPageView():a=="buttonEditMode"?aH.togglePolygonEditing():a=="buttonEditDelete"?aH.deleteCurrentLabel():a=="buttonEditCancel"?aH.cancelLabelEdits():a=="buttonEditSave"&&aH.saveAnnotations())}}}function al(a){aI=new Z.Utils.Point(a.clientX,a.clientY)}function G(b){var a=Z.Utils.getFirstTouch(b);if(a){var c=a.target;aI=new Z.Utils.Point(a.pageX,a.pageY)}}var ar=this,ay=!1;Z.skinPath=Z.Utils.removeTrailingSlashCharacters(Z.skinPath);var au=new Z.NetConnector;au.loadXML(Z.skinPath+"/"+Z.Utils.getResource("DEFAULT_SKINXMLFILE"));var aD,at,ax,aq,aL,aG,aA=[],aJ=parseInt(Z.Utils.getResource("DEFAULT_SLIDERTESTDURATION"),10),aE=!1,aw=null,aI=null,ap=null,az,aF,am;this.getInitialized=function(){return ag()},this.setSizeAndPosition=function(c,a,d,b){an(c,a,d,b)},this.show=function(a){aa(a)},this.setVisibility=function(a){ai(a)},this.minimize=function(a){aB(a)},this.showProgress=function(){var b=document.getElementById("progressTextBox");if(b){var a=b.style;a&&(a.display="inline-block")}},this.hideProgress=function(){var b=document.getElementById("progressTextBox");if(b){var a=b.style;a&&(a.display="none")}},this.updateProgress=function(c,a){if(Z.progressVisible){ap&&window.clearInterval(ap);var d,b=document.getElementById("progressTextBox").firstChild.firstChild.firstChild.firstChild;b&&(c==0||a==0?(b.nodeValue="llllllllll",ap=window.setInterval(ao,parseInt(Z.Utils.getResource("DEFAULT_PROGRESSDURATION")),10)):(d=Math.round(100-a/c*100),b.nodeValue="l".multiply(Math.round(d/10))))}},this.parseSkinXML=function(v){Z.skinMode=v.getElementsByTagName("SETUP")[0].attributes.getNamedItem("SKINMODE").nodeValue;var z,g;Z.skinMode==1||Z.skinMode==0&&!Z.mobileDevice?(z=v.getElementsByTagName("SETUP")[0].attributes.getNamedItem("FOLDERSTANDARD").nodeValue,g="SIZESSTANDARD"):(z=v.getElementsByTagName("SETUP")[0].attributes.getNamedItem("FOLDERLARGE").nodeValue,g="SIZESLARGE");var b=[];b.push(parseFloat(v.getElementsByTagName(g)[0].attributes.getNamedItem("TOOLBARW").nodeValue)),b.push(parseFloat(v.getElementsByTagName(g)[0].attributes.getNamedItem("TOOLBARH").nodeValue)),b.push(parseFloat(v.getElementsByTagName(g)[0].attributes.getNamedItem("LOGOW").nodeValue)),b.push(parseFloat(v.getElementsByTagName(g)[0].attributes.getNamedItem("LOGOH").nodeValue)),b.push(parseFloat(v.getElementsByTagName(g)[0].attributes.getNamedItem("DIVIDERW").nodeValue)),b.push(parseFloat(v.getElementsByTagName(g)[0].attributes.getNamedItem("DIVIDERH").nodeValue)),b.push(parseFloat(v.getElementsByTagName(g)[0].attributes.getNamedItem("BUTTONW").nodeValue)),b.push(parseFloat(v.getElementsByTagName(g)[0].attributes.getNamedItem("BUTTONH").nodeValue)),b.push(parseFloat(v.getElementsByTagName(g)[0].attributes.getNamedItem("BUTTONSPAN").nodeValue)),b.push(parseFloat(v.getElementsByTagName(g)[0].attributes.getNamedItem("SLIDERBUTTONW").nodeValue)),b.push(parseFloat(v.getElementsByTagName(g)[0].attributes.getNamedItem("SLIDERBUTTONH").nodeValue)),b.push(parseFloat(v.getElementsByTagName(g)[0].attributes.getNamedItem("SLIDERTRACKW").nodeValue)),b.push(parseFloat(v.getElementsByTagName(g)[0].attributes.getNamedItem("SLIDERTRACKH").nodeValue)),b.push(parseFloat(v.getElementsByTagName(g)[0].attributes.getNamedItem("SLIDERSPAN").nodeValue)),b.push(parseFloat(v.getElementsByTagName(g)[0].attributes.getNamedItem("PROGRESSW").nodeValue)),b.push(parseFloat(v.getElementsByTagName(g)[0].attributes.getNamedItem("PROGRESSH").nodeValue)),b.push(parseFloat(v.getElementsByTagName(g)[0].attributes.getNamedItem("PROGRESSFONTSIZE").nodeValue));var m=[],A,d,y,x,q;A=Z.editMode?51:39,d=v.getElementsByTagName("FILES")[0].attributes.getNamedItem("SKIN0"),d!==null&&(y=d.nodeValue),x=v.getElementsByTagName("FILES")[0].attributes.getNamedItem("SKIN"+A.toString()),x!==null&&(q=x.nodeValue);if(typeof y!="undefined"&&Z.Utils.isStrVal(y)&&typeof q!="undefined"&&Z.Utils.isStrVal(q)){var k=!1;for(var w=0;w<A+1;w++){var p=v.getElementsByTagName("FILES")[0].attributes.getNamedItem("SKIN"+w).nodeValue;Z.Utils.isStrVal(p)?m[w]=z+"/"+p:(m[w]="null",k=!0)}k&&Z.Utils.showMessage(Z.Utils.getResource("ERROR_SKINXMLMISSINGNAMES")),aK(b,m)}else{Z.Utils.showMessage(Z.Utils.getResource("ERROR_SKINXMLINVALID"))}},this.syncSliderToViewport=function(a){ac(a)},this.buttonGraphicsReset=function(b,a){af(b,a)}},Z.ZoomifyNavigator=function(aJ){function ap(g){Z.NavigatorDisplay=Z.Utils.createContainerElement("div","NavigatorDisplay","inline-block","absolute","hidden",aK+"px",ar+"px",aB+"px",aH+"px","solid","1px","transparent none","0px","0px","normal"),aF=Z.NavigatorDisplay,av=aF.style;var d=Z.Utils.getResource("DEFAULT_NAVIGATORBACKCOLOR"),h=Z.Utils.getResource("DEFAULT_NAVIGATORBACKCOLORNOALPHA"),f=Z.Utils.createContainerElement("div","navigatorBackground","inline-block","absolute","hidden",aK+"px",ar+"px","0px","0px","none","0px",d,"0px","0px","normal");Z.Utils.setOpacity(f,ai,h),Z.NavigatorDisplay.appendChild(f),az=f,at=az.style;var a=Z.Utils.createContainerElement("div","navigatorImageContainer","inline-block","absolute","hidden",aK+"px",ar+"px","0px","0px","none","0px","transparent none","0px","0px","normal");a.appendChild(ay),Z.NavigatorDisplay.appendChild(a),aN=a,aI=aN.style,aC=ay;var c=Z.Utils.createContainerElement("div","navigatorRectangle","inline-block","absolute","hidden",aK+1+"px",ar+1+"px",aB+"px",aH+"px","solid","1px","transparent none","0px","0px","normal");c.style.borderColor=Z.Utils.getResource("DEFAULT_NAVIGATORRECTANGLECOLOR"),Z.NavigatorDisplay.appendChild(c),aL=c,aG=aL.style,Z.ViewerDisplay.appendChild(Z.NavigatorDisplay),am(aK,ar,aB,aH,ao),aa(Z.navigatorVisible==1||Z.navigatorVisible==2),aO(),Z.mobileDevice?(Z.Utils.addEventListener(aF,"touchstart",K),Z.Utils.addEventListener(aF,"touchmove",an),Z.Utils.addEventListener(aF,"touchend",J),Z.Utils.addEventListener(aF,"touchcancel",G)):(Z.Utils.addEventListener(aC,"mousedown",Z.Utils.preventDefault),Z.Utils.addEventListener(aF,"mousedown",Z.Utils.preventDefault),Z.Utils.addEventListener(aF,"mouseover",Z.Utils.stopPropagation),Z.Utils.addEventListener(aF,"mousedown",af)),Z.Utils.addEventListener(ay,"contextmenu",Z.Utils.preventDefault),Z.Utils.addEventListener(f,"contextmenu",Z.Utils.preventDefault),Z.Utils.addEventListener(c,"contextmenu",Z.Utils.preventDefault),ae(!0),aj()}function Q(b){Z.tileSource=="ZoomifyImageFolder"?V=Z.Utils.cacheProofPath(Z.imagePath+"/TileGroup0/0-0-0.jpg"):Z.tileSource=="ZoomifyImageFile"&&(V=Z.Viewport.formatTilePath(0,0,0)),ay=null,ay=new Image,ay.onload=b,ay.onerror=ah;if(V!="offsetLoading"){ay.src=V}else{var a=window.setTimeout(function(){Q(b)},100)}}function ac(a){aN.appendChild(ay),aC=Z.NavigatorDisplay.childNodes[1].firstChild,am(aK,ar,aB,aH,ao),aa(Z.navigatorVisible==1||Z.navigatorVisible==2),aO(),aj()}function ak(){if(aD()){aw&&(window.clearInterval(aw),aw=null);if(!aF||!av||!az||!at||!aN||!aI||!aC||!aL||!aG){aF=Z.NavigatorDisplay,av=aF.style,az=Z.NavigatorDisplay.childNodes[0],at=az.style,aN=Z.NavigatorDisplay.childNodes[1],aI=aN.style,aC=Z.NavigatorDisplay.childNodes[1].firstChild,aL=Z.NavigatorDisplay.childNodes[2],aG=aL.style}}}function aD(){return aA}function ae(a){aA=a}function am(g,d,i,f,h){g||(g=Z.navigatorW),d||(d=Z.navigatorH);if(typeof i=="undefined"||i===null){i=0}if(typeof f=="undefined"||f===null){f=0}aF||(aF=Z.NavigatorDisplay),av||(av=aF.style),aC=aF.childNodes[1].firstChild;if(aF&&av&&aC){if(h){var c=1,b=1;h==0?b=Z.viewerW/Z.viewerH:b=aC.width/aC.height,c>1?(d=g,d/=b):(g=d,g*=b)}av.width=g+"px",av.height=d+"px",av.left=i-1+"px",av.top=f-1+"px",ab(g,d)}}function ab(b,a){at||(at=Z.NavigatorDisplay.firstChild.style),aI||(aI=Z.NavigatorDisplay.childNodes[1].style),aC||(aC=Z.NavigatorDisplay.childNodes[1].firstChild),at&&aI&&aC&&(at.width=b+"px",at.height=a+"px",ad(b,a,aC.width,aC.height),aI.width=aC.width+"px",aI.height=aC.height+"px",aI.left=(b-parseFloat(aI.width))/2+"px",aI.top=(a-parseFloat(aI.height))/2+"px",aj())}function ad(g,l,d,b){aC||(aC=Z.NavigatorDisplay.childNodes[1].firstChild);if(aC){var f=d/b,m=g/d,c=l/b,k=0,h=0;m<=c?(d=g,b=g/f,h=(l-b*(g/d))/2):c<m&&(b=l,d=l*f,k=(g-d*(l/b))/2),aC.width=d,aC.height=b}}function aO(){av||(av=Z.NavigatorDisplay.style),av&&(av.zIndex=av.zIndex+100)}function aj(){if(Z.Viewport&&Z.Viewport.getInitialized()){ag();var a=Z.Viewport.calculateCurrentCenterCoordinates();al(a)}}function aa(a){av||(av=Z.NavigatorDisplay.style),av&&(a?av.display="inline-block":av.display="none")}function ag(){if(aC&&aG){var d=aC.width/Z.imageW,b=aC.height/Z.imageH,f=Z.Viewport.getZoom(),c=Z.viewerW*d/f,a=Z.viewerH*b/f;aG.width=c+"px",aG.height=a+"px"}}function al(f){if(aC&&aG&&aI){var b=aC.width/Z.imageW,h=aC.height/Z.imageH,d=f.x*b,a=f.y*h,c=d-parseFloat(aG.width)/2,g=a-parseFloat(aG.height)/2;aG.left=Math.round(c+parseFloat(aI.left))+"px",aG.top=Math.round(g+parseFloat(aI.top))+"px"}}function aE(){if(aG&&aI&&aC){var g=parseFloat(aG.left)-parseFloat(aI.left),c=parseFloat(aG.top)-parseFloat(aI.top),k=g+(parseFloat(aG.width)-1)/2,f=c+(parseFloat(aG.height)-1)/2,b=Z.imageW/aC.width,d=Z.imageH/aC.height,h=k*b,a=f*d;Z.Viewport.syncToNavigator(h,a)}}function ah(){Z.Utils.showMessage(Z.Utils.getResource("ERROR_NAVIGATORIMAGEPATHINVALID"))}function af(a){Z.Viewport.zoomAndPanAllStop();if(aF&&aL&&aG){var a=Z.Utils.event(a);aL.mouseXPrior=a.clientX,aL.mouseYPrior=a.clientY,dragPtStart=new Z.Utils.Point(a.clientX,a.clientY),Z.Utils.addEventListener(aF,"mousemove",ax),Z.Utils.addEventListener(aF,"mouseup",Y),Z.Utils.addEventListener(document,"mouseup",Y)}}function ax(b){if(aL&&aG){var a=parseFloat(aG.left),c=parseFloat(aG.top);return aG.left=a+(b.clientX-aL.mouseXPrior)+"px",aG.top=c+(b.clientY-aL.mouseYPrior)+"px",aL.mouseXPrior=b.clientX,aL.mouseYPrior=b.clientY,aE(),!1}}function Y(c){if(aF&&aL&&aG){document.mousemove=null,document.mouseup=null,Z.Utils.removeEventListener(aF,"mousemove",ax),Z.Utils.removeEventListener(aF,"mouseup",Y),Z.Utils.removeEventListener(document,"mouseup",Y);var c=Z.Utils.event(c),a=new Z.Utils.Point(c.clientX,c.clientY),d=Z.Utils.calculatePointsDistance(dragPtStart.x,dragPtStart.y,a.x,a.y,2);if(d<4){var b=Z.Utils.getElementPosition(Z.NavigatorDisplay);aG.left=c.clientX-b.x-parseFloat(aG.width)/2+"px",aG.top=c.clientY-b.y-parseFloat(aG.height)/2+"px"}aE(),Z.Viewport.updateView()}}function K(c){c.preventDefault();if(aF&&aL&&aG){var a=Z.Utils.getFirstTouch(c);if(a){var d=a.target,b=new Z.Utils.Point(a.pageX,a.pageY);dragPtStart=new Z.Utils.Point(b.x,b.y),aL.mouseXPrior=b.x,aL.mouseYPrior=b.y}}}function an(f){f.preventDefault();if(!Z.mousePan){return}if(aL&&aG){var b=Z.Utils.getFirstTouch(f);if(b){var g=b.target,d=new Z.Utils.Point(b.pageX,b.pageY),a=parseFloat(aG.left),c=parseFloat(aG.top);return aG.left=a+(d.x-aL.mouseXPrior)+"px",aG.top=c+(d.y-aL.mouseYPrior)+"px",aL.mouseXPrior=d.x,aL.mouseYPrior=d.y,aE(),!1}}return !1}function J(h){if(aF&&aL&&aG){var d=Z.Utils.getFirstTouch(h);if(d){var k=d.target,g=new Z.Utils.Point(d.pageX,d.pageY),f=new Z.Utils.Point(g.x,g.y),i=Z.Utils.calculatePointsDistance(dragPtStart.x,dragPtStart.y,f.x,f.y,2),c=Z.mobileDevice?6:3;if(i<c){var b=Z.Utils.getElementPosition(Z.NavigatorDisplay);aG.left=g.x-b.x-parseFloat(aG.width)/2+"px",aG.top=g.y-b.y-parseFloat(aG.height)/2+"px"}}aE(),Z.Viewport.updateView()}}function G(h){if(aF&&aL&&aG){var d=Z.Utils.getFirstTouch(h);if(d){var k=d.target,g=new Z.Utils.Point(d.pageX,d.pageY),f=new Z.Utils.Point(g.x,g.y),i=Z.Utils.calculatePointsDistance(dragPtStart.x,dragPtStart.y,f.x,f.y,2),c=Z.mobileDevice?6:3;if(i<c){var b=Z.Utils.getElementPosition(Z.NavigatorDisplay);aG.left=g.x-b.x-parseFloat(aG.width)/2+"px",aG.top=g.y-b.y-parseFloat(aG.height)/2+"px"}}aE(),Z.Viewport.updateView()}}var au=this,aA=!1,aw,aF,av,az,at,aN,aI,aC,aL,aG,ay,aK=Z.navigatorW,ar=Z.navigatorH,aB=Z.navigatorL-1,aH=Z.navigatorT-1,ao=Z.navigatorFit,aM,aq=null,ai=parseFloat(Z.Utils.getResource("DEFAULT_NAVIGATORBACKALPHA")),V;Q(ap),this.setImagePath=function(a){aN.removeChild(ay),Q(ac)},this.getInitialized=function(){return aD()},this.setSizeAndPosition=function(d,b,f,c,a){a||(a=ao),am(d,b,f,c,a)},this.setVisibility=function(a){aa(a)},this.syncToViewport=function(){aj()},this.syncNavigatorRectangleDimensions=function(){ag()},this.syncNavigatorRectanglePosition=function(a){al(a)},this.validateNavigatorGlobals=function(){aD()?ak():aw=window.setInterval(ak,300)}},Z.NetConnector=function(){function k(v,y,p){var l=null,q=typeof y=="function";if(q){var z=y,y=function(){window.setTimeout(Z.Utils.createCallback(null,z,l),1)}}if(window.ActiveXObject){var m=["Msxml2.XMLHTTP","Msxml3.XMLHTTP","Microsoft.XMLHTTP"];for(var x=0;x<m.length;x++){try{l=new ActiveXObject(m[x]);break}catch(w){continue}}}else{window.XMLHttpRequest&&(l=new XMLHttpRequest)}l||Z.Utils.showMessage(Z.Utils.getResource("ERROR_XMLHTTPREQUESTUNSUPPORTED")),q&&(l.onreadystatechange=function(){l.readyState==4&&(l.onreadystatechange=new Function,y())});try{p===null?(l.open("GET",v,q),l.send(null)):(Z.postingXML=!0,l.open("POST",v,!0),l.setRequestHeader("Content-type","application/x-www-form-urlencoded"),l.setRequestHeader("Content-length",params.length),l.setRequestHeader("Connection","close"),l.send(params))}catch(w){v.indexOf("ImageProperties.xml")!=-1?Z.Utils.showMessage(Z.Utils.getResource("ERROR_MAKINGNETWORKREQUEST-IMAGEXML")):v.toUpperCase().indexOf(".PFF")!=-1?Z.Utils.showMessage(Z.Utils.getResource("ERROR_MAKINGNETWORKREQUEST-IMAGEHEADER")):v.toUpperCase().indexOf("reply_data")!=-1?Z.Utils.showMessage(Z.Utils.getResource("ERROR_MAKINGNETWORKREQUEST-IMAGEOFFSET")):v.indexOf(Z.Utils.getResource("DEFAULT_SKINXMLFILE"))!=-1?Z.Utils.showMessage(Z.Utils.getResource("ERROR_MAKINGNETWORKREQUEST-TOOLBARXML")):v.indexOf(Z.Utils.getResource("DEFAULT_HOTSPOTSXMLFILE"))!=-1?Z.Utils.showMessage(Z.Utils.getResource("ERROR_MAKINGNETWORKREQUEST-HOTSPOTSXML")):v.indexOf(Z.Utils.getResource("DEFAULT_ANNOTATIONSXMLFILE"))!=-1?Z.Utils.showMessage(Z.Utils.getResource("ERROR_MAKINGNETWORKREQUEST-ANNOTATIONSXML")):v.toUpperCase().indexOf(Z.Utils.getResource("DEFAULT_ANNOTATIONSXMLSAVEHANDLERNAME1"))!=-1||v.toUpperCase().indexOf(Z.Utils.getResource("DEFAULT_ANNOTATIONSXMLSAVEHANDLERNAME1"))!=-1?Z.Utils.showMessage(Z.Utils.getResource("ERROR_MAKINGNETWORKREQUEST-ANNOTATIONSSAVEHANDLER")):Z.Utils.showMessage(Z.Utils.getResource("ERROR_MAKINGNETWORKREQUEST")),l.onreadystatechange=null,l=null}return q?null:l}function f(q){if(!q){Z.Utils.showMessage(Z.Utils.getResource("ERROR_NETWORKSECURITY"))}else{if(q.status!==200&&q.status!==0){var x=q.status,m=x==404?"Not Found":q.statusText;Z.Utils.showMessage(Z.Utils.getResource("ERROR_NETWORKSTATUS")+x+" - "+m)}else{var i=null;if(q.responseXML&&q.responseXML.documentElement){i=q.responseXML,c(i)}else{if(q.responseText){var y=q.responseText;if(Z.postingXML){Z.postingXML=!1,Z.Utils.showMessage(Z.Utils.getResource("ALERT_ANNOTATIONSAVESUCCESSFUL")),Z.Viewport&&Z.Viewport.setAllHotspotsSaved()}else{if(Z.tileSource=="ZoomifyImageFolder"){i=Z.Utils.convertXMLTextToXMLDoc(y),c(i)}else{if(Z.tileSource=="ZoomifyImageFile"){if(y.toUpperCase().indexOf("PFFHEADER")!=-1){var l=y.indexOf("reply_data=")+"reply_data=".length;y=y.substring(l,y.length)}else{var w=y.indexOf("begin=")+"begin=".length,v=y.indexOf("&",w);beginValue=y.substring(w,v);var p=y.indexOf("reply_data=")+"reply_data=".length;replyDataValue=y.substring(p,y.length),y='<PFFOFFSET BEGIN="'+beginValue+'" REPLYDATA="'+replyDataValue+'" />'}i=Z.Utils.convertXMLTextToXMLDoc(y),c(i)}}}}}}}}function c(l){if(l&&l.documentElement){var i=l.documentElement.tagName;i=="COPYRIGHT"?d("copyright",l):i=="IMAGE_PROPERTIES"||i=="PFFHEADER"?d("image",l):i=="PFFOFFSET"?d("offset",l):i=="SKINDATA"?d("skin",l):i=="DATA"?d("hotspots",l):i=="ZAS"?d("annotations",l):Z.Utils.showMessage(Z.Utils.getResource("ERROR_XMLINVALID"))}else{Z.Utils.showMessage(Z.Utils.getResource("ERROR_XMLDOCINVALID"))}}function d(m,i){if(m=="copyright"){var o=i.documentElement.getAttribute("STATEMENTTEXT"),l=i.documentElement.getAttribute("DECLINEDTEXT");Z.Utils.isStrVal(o)?Z.Utils.showCopyright(o,l):Z.Utils.showMessage(Z.Utils.getResource("ERROR_IMAGEXMLINVALID"))}else{m=="image"?(Z.tileSource=="ZoomifyImageFolder"||Z.tileSource=="ZoomifyImageFile"||Z.tileSource=="OtherTileSource")&&Z.Viewport&&Z.Viewport.parseImageXML(i):m=="offset"?Z.Viewport&&Z.Viewport.parseOffsetChunk(i):m=="skin"?Z.Toolbar&&Z.Toolbar.parseSkinXML(i):m=="hotspots"?Z.Viewport&&Z.Viewport.parseHotspotsXML(i):m=="annotations"&&Z.Viewport&&Z.Viewport.parseAnnotationsXML(i)}}function h(l,o,m){g--;if(typeof l=="function"){try{l(m)}catch(e){Z.Utils.showMessage(e.name+Z.Utils.getResource("ERROR_EXECUTINGCALLBACK")+o+" "+e.message)}}}function a(q,u,p){function t(e){l.onload=null,l.onabort=null,l.onerror=null,m&&window.clearTimeout(m),window.setTimeout(function(){u(q,e?l:null)},1)}var l=null,m=null;this.start=function(){l=new Image;var o=function(){t(!0)},i=function(){t(!1)},e=function(){Z.Utils.showMessage(Z.Utils.getResource("ERROR_IMAGEREQUESTTIMEDOUT")+q),t(!1),Z.debug==2&&Z.Utils.trace("Image request for "+p+" timeout: "+q)};l.onload=o,l.onabort=i,l.onerror=i,m=window.setTimeout(e,b),l.src=q}}var g=0,b=parseFloat(Z.Utils.getResource("DEFAULT_IMAGELOADTIMEOUT"));this.loadXML=function(i){k(i,f,null)},this.postXML=function(l,i){k(l,f,i)},this.loadImage=function(l,p,o){if(g>=parseInt(Z.Utils.getResource("DEFAULT_IMAGESLOADINGMAX"),10)){return !1}var e=Z.Utils.createCallback(null,h,p),m=new a(l,e,o);return g++,m.start(),!0}},Z.Utils={declareGlobals:function(){Z.pageContainerID=null,Z.imagePath=null,Z.skinPath=null,Z.skinMode=null,Z.parameters=null,Z.browsers=null,Z.browser=null,Z.browserVersion=null,Z.canvasSupported=null,Z.cssTransformsSupported=null,Z.cssTransformProperty=null,Z.cssTransformNoUnits=null,Z.alphaSupported=null,Z.renderQuality=null,Z.mobileDevice=null,Z.initialX=null,Z.initialY=null,Z.initialZ=null,Z.minZ=null,Z.maxZ=null,Z.zoomSpeed=null,Z.panSpeed=null,Z.fadeInSpeed=null,Z.toolbarVisible=null,Z.toolbarW=null,Z.toolbarH=null,Z.toolbarPosition=null,Z.navigatorVisible=null,Z.navigatorW=null,Z.navigatorH=null,Z.navigatorL=null,Z.navigatorT=null,Z.navigatorFit=null,Z.clickZoom=null,Z.clickPan=null,Z.mousePan=null,Z.keys=null,Z.constrainPan=null,Z.tooltipsVisible=null,Z.watermarkPath=null,Z.copyrightPath=null,Z.hotspotPath=null,Z.hotspotListTitle=null,Z.annotationPath=null,Z.saveHandlerPath=null,Z.postingXML=!1,Z.sliderVisible=null,Z.fullPageVisible=null,Z.fullPageInitial=null,Z.progressVisible=null,Z.logoVisible=null,Z.logoCustomPath=null,Z.canvas=null,Z.debug=null,Z.imageProperties=null,Z.serverIP=null,Z.serverPort=null,Z.tileHandlerPath=null,Z.tileHandlerPathFull=null,Z.tileSource=null,Z.editMode=!1,Z.polygonEditing=!1,Z.Viewer=null,Z.ViewerDisplay=null,Z.Viewport=null,Z.Toolbar=null,Z.ToolbarDisplay=null,Z.TooltipDisplay=null,Z.Navigator=null,Z.NavigatorDisplay=null,Z.MessageDisplay=null,Z.CopyrightDisplay=null,Z.AnnotationPanelDisplay=null,Z.imageW=null,Z.imageH=null,Z.imageX=0,Z.imageY=0,Z.imageZ=0,Z.fitZ=null,Z.zooming="stop",Z.panningX="stop",Z.panningY="stop",Z.fullPage=!1,Z.useCanvas=!0,Z.TraceDisplay=null,Z.traces=null},enforceCopyright:function(){var a=this.readCookie("imageCopyright");a?Z.Viewer.configureViewer():this.loadCopyrightText()},loadCopyrightText:function(){var a=new Z.NetConnector;a.loadXML(Z.copyrightPath)},showCopyright:function(K,x){var D=this.getResource("DEFAULT_COPYRIGHTSCREENCOLOR"),A=this.getResource("DEFAULT_COPYRIGHTBUTTONCOLOR");Z.CopyrightDisplay=this.createContainerElement("div","CopyrightDisplay","inline-block","absolute","hidden",Z.viewerW-2+"px",Z.viewerH-2+"px","0px","0px","solid","1px",D,"0px","0px","normal"),Z.ViewerDisplay.appendChild(Z.CopyrightDisplay);var G=440,z=200,C=parseFloat(Z.CopyrightDisplay.style.width)/2-G/2,w=parseFloat(Z.CopyrightDisplay.style.height)/2-z/2,O=this.createContainerElement("div","textBox","inline-block","absolute","hidden",G+"px",z+"px",C+"px",w+"px","none","0px","transparent none","0px","0px","normal");O.id="textBox",Z.CopyrightDisplay.appendChild(O);var J=document.createTextNode(K);O.appendChild(this.createCenteredElement(J)),this.setTextStyle(J,"black","verdana","16px","none","normal","normal","normal","normal","1em","justify","none");var F=document.createTextNode(x);O.appendChild(F);var M=80,H=20,B=30,L=20,q=C+G/2-(M*2+B)/2,E=w+z+L,I=this.getResource("DEFAULT_COPYRIGHTAGREEBUTTONTEXT"),k=new Z.Utils.Button("buttonAgree",I,null,null,null,null,M+"px",H+"px",q+"px",E+"px","mousedown",this.copyrightAgreeButtonHandler,"TIP_COPYRIGHTAGREE","solid","1px",A,"0px","0px");Z.CopyrightDisplay.appendChild(k.elmt),q+=M+B,I=this.getResource("DEFAULT_COPYRIGHTEXITBUTTONTEXT");var N=new Z.Utils.Button("buttonExit",I,null,null,null,null,M+"px",H+"px",q+"px",E+"px","mousedown",this.copyrightExitButtonHandler,"TIP_COPYRIGHTEXIT","solid","1px",A,"0px","0px");Z.CopyrightDisplay.appendChild(N.elmt)},hideCopyright:function(){var c=document.getElementById("textBox"),a=c.childNodes[1].nodeValue;c.firstChild.firstChild.firstChild.firstChild.nodeValue=a;var d=document.getElementById("buttonAgree");this.removeEventListener(d,"mousedown",this.copyrightAgreeButtonHandler),Z.CopyrightDisplay.removeChild(d);var b=document.getElementById("buttonExit");this.removeEventListener(b,"mousedown",this.copyrightExitButtonHandler),Z.CopyrightDisplay.removeChild(b)},copyrightAgreeButtonHandler:function(a){Z.ViewerDisplay.removeChild(Z.CopyrightDisplay),document.cookie="imageCopyright=confirmed",Z.Viewer.configureViewer()},copyrightExitButtonHandler:function(a){Z.Utils.hideCopyright();return},Button:function(ab,J,Q,M,W,K,P,H,af,aa,U,ad,X,O,ac,G,R,Y,B,ae){var F=Z.Utils.createContainerElement("span",ab,"inline-block","absolute","hidden",P,H,af,aa,O,ac,G,R,Y,B,ae);if(!Z.Utils.isStrVal(J)){Q=Z.Utils.removeTrailingSlashCharacters(Q);var I=Z.Utils.createGraphicElement(Q+"/"+M),z=Z.Utils.createGraphicElement(Q+"/"+W),D=Z.Utils.createGraphicElement(Q+"/"+K);I.id=F.id+"-imgUp",z.id=F.id+"-imgOver",D.id=F.id+"-imgDown",F._imgUpID=I.id,F._imgOverID=z.id,F._imgDownID=D.id;var q=I.style,A=z.style,L=D.style;q.position=A.position=L.position="absolute",q.width=A.width=A.width=P,q.height=A.height=A.height=H,q.top=A.top=L.top="0px",q.left=A.left=L.left="0px",Z.browser==Z.browsers.FIREFOX&&Z.browserVersion<3&&(q.top=A.top=L.top=""),A.visibility="hidden",L.visibility="hidden",F.appendChild(I),F.appendChild(z),F.appendChild(D),Z.Utils.addEventListener(I,"contextmenu",Z.Utils.preventDefault),Z.Utils.addEventListener(z,"contextmenu",Z.Utils.preventDefault),Z.Utils.addEventListener(D,"contextmenu",Z.Utils.preventDefault)}else{var V=document.createTextNode(J);F.appendChild(Z.Utils.createCenteredElement(V)),Z.Utils.setTextStyle(V,"black","verdana","13px","none","normal","normal","normal","normal","1em","center","none"),Z.Utils.disableTextInteraction(V),Z.Utils.addEventListener(F,"contextmenu",Z.Utils.preventDefault)}Z.tooltipsVisible&&Z.Utils.isStrVal(X)&&(F.title=Z.Utils.getResource(X)),Z.mobileDevice?Z.Utils.addEventListener(F,"touchstart",ad):(Z.Utils.addEventListener(F,"mousedown",Z.Utils.preventDefault),Z.Utils.addEventListener(F,"mouseover",Z.Utils.stopPropagation),Z.Utils.addEventListener(F,"mouseout",Z.Utils.stopPropagation),Z.Utils.addEventListener(F,U,ad)),this.elmt=F},buttonSize:function(k,p,d){var b=k.style;b.width=p+"px",b.height=d+"px";var g=document.getElementById(k._imgUpID),q=document.getElementById(k._imgOverID),c=document.getElementById(k._imgDownID);if(g&&q&&c){var m=g.style,l=q.style,h=c.style;m.width=p+"px",m.height=d+"px",l.width=p+"px",l.height=d+"px",h.width=p+"px",h.height=d+"px"}},Graphic:function(k,p,d,b,g,q,c){p=Z.Utils.removeTrailingSlashCharacters(p);var m=d?p+"/"+d:p,l=Z.Utils.createGraphicElement(m),h=l.style;h.width=b,h.height=g;var d=Z.Utils.createContainerElement("span",k,"inline-block","absolute","hidden",b,g,q,c,"none","0px","transparent none","0px","0px","normal");d.appendChild(l),this.elmt=d,Z.mobileDevice?Z.Utils.addEventListener(l,"touchstart",Z.Utils.preventDefault):Z.Utils.addEventListener(l,"mousedown",Z.Utils.preventDefault),Z.Utils.addEventListener(l,"contextmenu",Z.Utils.preventDefault)},graphicSize:function(f,b,g){var d=f.style;d.width=b+"px",d.height=g+"px";var a=f.firstChild,c=a.style;c.width=b+"px",c.height=g+"px"},addCrossBrowserPrototypes:function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(c,a){a?a<0&&(a=Math.max(0,this.length+a)):a=0;for(var d=a,b=this.length;d<b;d++){if(this[d]===c){return d}}return -1}),Array.prototype.indexOfObjectValue||(Array.prototype.indexOfObjectValue=function(d,b,f){f?f<0&&(f=Math.max(0,this.length+f)):f=0;for(var c=f,a=this.length;c<a;c++){if(this[c][d]===b){return c}}return -1}),Array.prototype.indexOfObjectValueSubstring||(Array.prototype.indexOfObjectValueSubstring=function(d,b,f){f?f<0&&(f=Math.max(0,this.length+f)):f=0;for(var c=f,a=this.length;c<a;c++){if(this[c][d].indexOf(b)!=-1){return c}}return -1}),Array.prototype.push||(Array.prototype.push=function(a){this[this.length]=a}),Array.prototype.splice||(Array.prototype.subarr=function(c,a){if(c>=this.length||a&&a<=0){return[]}c<0&&(Math.abs(c)>this.length?c=0:c=this.length+c);if(!a||a+c>this.length){a=this.length-c}var d=[];for(var b=c;b<c+a;b++){d.push(this[b])}return d},Array.prototype.subarray=function(c,a){c<0&&(c=0);if(!a||a>this.length){a=this.length}if(c==a){return[]}var d=[];for(var b=c;b<a;b++){d.push(this[b])}return d},Array.prototype.splice=function(g,l){l<0&&(l=0);var d=[];if(arguments.length>2){for(var b=2,f=arguments.length;b<f;b++){d.push(arguments[b])}}var m=this.subarray(0,g),c=this.subarr(g,l),k=this.subarray(g+l),h=m.concat(d,k);this.length=0;for(var b=0,f=h.length;b<f;b++){this.push(h[b])}return c}),String.prototype.multiply||(String.prototype.multiply=function(){var b=Array.prototype.join,a={};return function(c){return a.length=c+1,b.call(a,this)}}())},addCrossBrowserMethods:function(){document.addEventListener?(this.disableTextInteraction=function(a){a&&(tnS=a.parentNode.style,tnS&&(a.parentNode.unselectable="on",tnS.userSelect="none",tnS.MozUserSelect="none",tnS.webkitUserSelect="none",tnS.webkitTouchCallout="none",tnS.webkitTapHighlightColor="transparent"))},this.renderQuality=function(b,a){if(a){var c=a=="high"?"optimizeQuality":"optimizeSpeed";b.style.setProperty("image-rendering",c,null)}},this.setOpacity=function(b,a,c){Z.alphaSupported?b.style.opacity=a:c&&(b.style.backgroundColor=c)}):document.attachEvent&&(this.disableTextInteraction=function(a){a&&(a.parentNode.unselectable="on",a.parentNode.onselectstart=function(){return !1})},this.renderQuality=function(b,a){if(a){var c=a=="high"?"bicubic":"nearest-neighbor";b.style.msInterpolationMode=c}},this.setOpacity=function(b,a,c){Z.alphaSupported?(a*=100,b.style.zoom=1,b.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity="+a+")",b.style.filter="alpha(opacity="+a+")",a==100&&(b.style.filter="")):c&&(b.style.backgroundColor=c)})},addCrossBrowserEvents:function(){document.addEventListener?(this.addEventListener=function(b,a,c){a=="mousewheel"&&elmt.addEventListener("DOMMouseScroll",c,!1),b.addEventListener(a,c,!1)},this.removeEventListener=function(b,a,c){a=="mousewheel"&&elmt.addEventListener("DOMMouseScroll",c,!1),b&&b.removeEventListener(a,c,!1)},this.event=function(a){return a},this.target=function(a){return a.target},this.relatedTarget=function(a){return a.relatedTarget},this.isRightMouseButton=function(b){var a=!1;if(b.which==2||b.which==3){a=!0}return a},this.preventDefault=function(a){a.preventDefault()},this.stopPropagation=function(a){a.stopPropagation()}):document.attachEvent&&(this.addEventListener=function(g,c,k){if(this._findListener(g,c,k)!=-1){return}var f=function(){var e=window.event;Function.prototype.call?k.call(g,e):(g._currentListener=k,g._currentListener(e),g._currentListener=null)};g.attachEvent("on"+c,f);var b={target:g,eventName:c,handler:k,handler2:f},d=g.document||g,h=d.parentWindow,a="l"+this._listenerCounter++;h._allListeners||(h._allListeners={}),h._allListeners[a]=b,g._listeners||(g._listeners=[]),g._listeners[g._listeners.length]=a,h._unloadListenerAdded||(h._unloadListenerAdded=!0,h.attachEvent("onunload",this._removeAllListeners))},this.removeEventListener=function(g,c,k){if(g){var f=this._findListener(g,c,k);if(f==-1){return}var b=g.document||g,d=b.parentWindow,h=g._listeners[f],a=d._allListeners[h];g.detachEvent("on"+c,a.handler2),g._listeners.splice(f,1),delete d._allListeners[h]}},this.event=function(a){return window.event},this.target=function(a){return a.srcElement},this.relatedTarget=function(b){var a=null;return b.type=="mouseover"?a=b.fromElement:b.type=="mouseout"&&(a=b.toElement),a},this.isRightMouseButton=function(b){var a=!1;return b.button==2&&(a=!0),a},this.preventDefault=function(a){a&&(a.returnValue=!1)},this.stopPropagation=function(a){a.cancelBubble=!0},this._findListener=function(g,l,d){var b=g._listeners;if(!b){return -1}var f=g.document||g,m=f.parentWindow;for(var c=b.length-1;c>=0;c--){var k=b[c],h=m._allListeners[k];if(h.eventName==l&&h.handler==d){return c}}return -1},this._removeAllListeners=function(){var b=this;for(id in b._allListeners){var a=b._allListeners[id];a.target.detachEvent("on"+a.eventName,a.handler2),delete b._allListeners[id]}},this._listenerCounter=0)},detectBrowserInfo:function(){Z.browsers={UNKNOWN:0,IE:1,FIREFOX:2,SAFARI:3,CHROME:4,OPERA:5};var U=Z.browsers.UNKNOWN,G=0,L=navigator.appName,I=navigator.appVersion,O=!1,H=!1,K=navigator.userAgent.toLowerCase();if(L!="Microsoft Internet Explorer"||!window.attachEvent||!window.ActiveXObject){if(L!="Netscape"||!window.addEventListener){L=="Opera"&&!!window.opera&&!!window.attachEvent&&(U=Z.browsers.OPERA,G=parseFloat(I))}else{var Y=K.indexOf("firefox"),R=K.indexOf("safari"),N=K.indexOf("chrome");if(Y>=0){U=Z.browsers.FIREFOX,G=parseFloat(K.substring(Y+8))}else{if(R>=0){var W=K.substring(0,R).lastIndexOf("/");U=N>=0?Z.browsers.CHROME:Z.browsers.SAFARI,G=parseFloat(K.substring(W+1,R))}}var P=new Image;P.style.getPropertyValue&&(H=P.style.getPropertyValue("image-rendering"))}}else{var D=K.indexOf("msie");U=Z.browsers.IE,G=parseFloat(K.substring(D+5,K.indexOf(";",D))),O=typeof document.documentMode!="undefined"}var J=document.documentElement||{},V=J.style||{},C=!1,M=["transform","WebkitTransform","MozTransform"],Q,z;while(Q=M.shift()){if(typeof V[Q]!="undefined"){C=!0,z=/webkit/i.test(Q);break}}var X=document.createElement("canvas").getContext&&document.createElement("canvas").getContext("2d"),B=!(U==Z.browsers.SAFARI&&G<4||U==Z.browsers.CHROME&&G<2),F=X&&B,q=!(U==Z.browsers.CHROME&&G<2),A=O||H?"high":null,k=K.indexOf("android")>-1||K.indexOf("iphone")>-1||K.indexOf("ipad")>-1||K.indexOf("ipod")>-1;Z.browser=U,Z.browserVersion=G,Z.canvasSupported=F,Z.useCanvas=Z.canvasSupported,Z.cssTransformsSupported=C,Z.cssTransformProperty=Q,Z.cssTransformNoUnits=z,Z.alphaSupported=q,Z.renderQuality=A,Z.mobileDevice=k},isStrVal:function(a){return a!=null&&a!=""&&a!="null"},getCurrentUTCDateAsString:function(){var f=new Date,b=(f.getUTCMonth()+1<10?"0":"")+(f.getUTCMonth()+1),g=(f.getUTCDate()<10?"0":"")+f.getUTCDate(),d=(f.getUTCHours()<10?"0":"")+f.getUTCHours(),a=(f.getUTCMinutes()<10?"0":"")+f.getUTCMinutes(),c=(f.getUTCSeconds()<10?"0":"")+f.getUTCSeconds();return f.getUTCFullYear()+b+g+d+a+c},getElementPosition:function(f){var b=0,g=0,d=this.getElementStyle(f).position=="fixed",a=this.getOffsetParent(f,d);while(a){b+=f.offsetLeft,g+=f.offsetTop;if(d){var c=this.getPageScroll();b+=c.x,g+=c.y}f=a,d=this.getElementStyle(f).position=="fixed",a=this.getOffsetParent(f,d)}return new this.Point(b,g)},getOffsetParent:function(b,a){return a&&b!=document.body?document.body:b.offsetParent},getElementSize:function(a){return new this.Point(a.clientWidth,a.clientHeight)},getElementStyle:function(a){if(a.currentStyle){return a.currentStyle}if(window.getComputedStyle){return window.getComputedStyle(a,"")}this.showMessage(this.getResource("ERROR_UNKNOWNELEMENTSTYLE"))},getElementStyleProperty:function(b,a){if(b.currentStyle){return b.currentStyle[a]}if(window.getComputedStyle){return document.defaultView.getComputedStyle(b,null).getPropertyValue(a)}this.showMessage(this.getResource("ERROR_UNKNOWNELEMENTSTYLE"))},getEventTargetCoords:function(a){return getElementPosition(Z.Utils.target(a))},getFirstTouch:function(c){var a=null,d=c.touches,b=c.changedTouches;return d!==undefined?a=d[0]:b!==undefined&&(a=b[0]),a},getMousePosition:function(b){var a=0,c=0;return b.type=="DOMMouseScroll"&&browser==Browser.FIREFOX&&browserVersion<3?(a=b.screenX,c=b.screenY):typeof b.pageX=="number"?(a=b.pageX,c=b.pageY):typeof b.clientX=="number"?(a=b.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,c=b.clientY+document.body.scrollTop+document.documentElement.scrollTop):this.showMessage(this.getResource("ERROR_UNKNOWNMOUSEPOSITION")),new this.Point(a,c)},getMouseScroll:function(b){var a=0;return typeof b.wheelDelta=="number"?a=b.wheelDelta:typeof b.detail=="number"?a=b.detail*-1:this.showMessage(this.getResource("ERROR_UNKNOWNMOUSESCROLL")),a?a/Math.abs(a):0},getPageScroll:function(){var c=0,a=0,d=document.documentElement||{},b=document.body||{};if(typeof window.pageXOffset=="number"){c=window.pageXOffset,a=window.pageYOffset}else{if(b.scrollLeft||b.scrollTop){c=b.scrollLeft,a=b.scrollTop}else{if(d.scrollLeft||d.scrollTop){c=d.scrollLeft,a=d.scrollTop}}}return new this.Point(c,a)},getWindowSize:function(){var c=0,a=0,d=document.documentElement||{},b=document.body||{};return typeof window.innerWidth=="number"?(c=window.innerWidth,a=window.innerHeight):d.clientWidth||d.clientHeight?(c=d.clientWidth,a=d.clientHeight):b.clientWidth||b.clientHeight?(c=b.clientWidth,a=b.clientHeight):this.showMessage(this.getResource("ERROR_UNKNOWNWINDOWSIZE")),new this.Point(c,a)},nodeIsInViewer:function(b){var a=!1,c=b;while(a==0){if(!c){break}c.id?c.id=="ViewerDisplay"?a=!0:c=c.parentNode:c=c.parentNode}return a},readCookie:function(d){var b=d+"=",f=document.cookie.split(";");for(var c=0;c<f.length;c++){var a=f[c];while(a.charAt(0)==" "){a=a.substring(1,a.length)}if(a.indexOf(b)==0){return a.substring(b.length,a.length)}}return null},removeTrailingSlashCharacters:function(b){var a=b.slice(-1,b.length)=="/"?b.slice(0,b.length-1):b;return a},cacheProofPath:function(a){return a+="?noCacheSfx="+(new Date).getTime().toString(),a},easing:function(d,b,f,c){var a=b-d;return(f/=c/2)<1?a/2*f*f*f*f*f+d:a/2*((f-=2)*f*f*f*f+2)+d},parseParameters:function(b){var a;return b&&(a=b.split("&")),a},setParameters:function(K){var x=this.getResource("DEFAULT_PARAMETERSENABLETEST"),D=this.getResource("DEFAULT_PARAMETERSDISABLEVALUE"),A=this.getResource("DEFAULT_PARAMETERSDISABLEDALERT"),G=this.getResource("DEFAULT_PFFSUPPORTENABLETEST"),z=this.getResource("DEFAULT_PFFSUPPORTDISABLEVALUE"),C=this.getResource("DEFAULT_PFFSUPPORTDISABLEDALERT"),w=G!=z?!0:!1,O=this.getResource("DEFAULT_ANNOTATIONSUPPORTENABLETEST"),J=this.getResource("DEFAULT_ANNOTATIONSUPPORTDISABLEVALUE"),F=this.getResource("DEFAULT_ANNOTATIONSUPPORTDISABLEDALERT"),M=O!=J?!0:!1;Z.skinPath=this.getResource("DEFAULT_SKINXMLPATH"),Z.skinMode=this.getResource("DEFAULT_SKINMODE"),isNaN(parseFloat(this.getResource("DEFAULT_INITIALX")))||(Z.initialX=parseFloat(this.getResource("DEFAULT_INITIALX"))),isNaN(parseFloat(this.getResource("DEFAULT_INITIALY")))||(Z.initialY=parseFloat(this.getResource("DEFAULT_INITIALY"))),isNaN(parseFloat(this.getResource("DEFAULT_INITIALZOOM")))||(Z.initialZ=parseFloat(this.getResource("DEFAULT_INITIALZOOM"))),isNaN(parseFloat(this.getResource("DEFAULT_MINZOOM")))||(Z.minZ=parseFloat(this.getResource("DEFAULT_MINZOOM"))),isNaN(parseFloat(this.getResource("DEFAULT_MAXZOOM")))||(Z.maxZ=parseFloat(this.getResource("DEFAULT_MAXZOOM"))),isNaN(parseFloat(this.getResource("DEFAULT_ZOOMSPEED")))||(Z.zoomSpeed=parseFloat(this.getResource("DEFAULT_ZOOMSPEED"))),isNaN(parseFloat(this.getResource("DEFAULT_PANSPEED")))||(Z.panSpeed=parseFloat(this.getResource("DEFAULT_PANSPEED"))),isNaN(parseFloat(this.getResource("DEFAULT_FADEINSPEED")))||(Z.fadeInSpeed=parseFloat(this.getResource("DEFAULT_FADEINSPEED"))),Z.toolbarVisible=parseInt(this.getResource("DEFAULT_TOOLBARVISIBLE"),10),Z.toolbarPosition=parseFloat(this.getResource("DEFAULT_TOOLBARPOSITION")),Z.tooltipsVisible=this.getResource("DEFAULT_TOOLTIPSVISIBLE")!="0",Z.navigatorVisible=parseInt(this.getResource("DEFAULT_NAVIGATORVISIBLE"),10),Z.navigatorW=parseInt(this.getResource("DEFAULT_NAVIGATORWIDTH"),10),Z.navigatorH=parseInt(this.getResource("DEFAULT_NAVIGATORHEIGHT"),10),Z.navigatorL=parseInt(this.getResource("DEFAULT_NAVIGATORLEFT"),10),Z.navigatorT=parseInt(this.getResource("DEFAULT_NAVIGATORTOP"),10),Z.navigatorFit=this.getResource("DEFAULT_NAVIGATORFIT"),Z.clickZoom=this.getResource("DEFAULT_CLICKZOOM")!="0",Z.clickPan=this.getResource("DEFAULT_CLICKPAN")!="0",Z.mousePan=this.getResource("DEFAULT_MOUSEPAN")!="0",Z.keys=this.getResource("DEFAULT_KEYS")!="0",Z.constrainPan=this.getResource("DEFAULT_CONSTRAINPAN")!="0",Z.sliderVisible=this.getResource("DEFAULT_SLIDERVISIBLE")!="0",Z.fullPageVisible=this.getResource("DEFAULT_FULLPAGEVISIBLE")!="0",Z.fullPageInitial=this.getResource("DEFAULT_FULLPAGEINITIAL")!="0",Z.progressVisible=this.getResource("DEFAULT_PROGRESSVISIBLE")!="0",Z.logoVisible=this.getResource("DEFAULT_LOGOVISIBLE")!="0",Z.logoCustomPath=this.getResource("DEFAULT_LOGOCUSTOMPATH"),Z.canvas=this.getResource("DEFAULT_CANVAS")!="0",Z.debug=parseInt(this.getResource("DEFAULT_DEBUG"),10);if(this.isStrVal(K)){for(var H=0,B=K.length;H<B;H++){var L=K[H],q=L.indexOf("=");if(q>0){var E=L.substring(0,q),I=L.substring(q+1);if(this.isStrVal(I)){switch(E){case"zInitialX":isNaN(parseFloat(I))||(Z.initialX=parseFloat(I));break;case"zInitialY":isNaN(parseFloat(I))||(Z.initialY=parseFloat(I));break;case"zInitialZoom":isNaN(parseFloat(I))||(Z.initialZ=parseFloat(I),Z.initialZ&&(Z.initialZ/=100));break;case"zMinZoom":!isNaN(parseFloat(I))&&parseFloat(I)>0.01&&(Z.minZ=parseFloat(I),Z.minZ&&(Z.minZ/=100));break;case"zMaxZoom":isNaN(parseFloat(I))||(Z.maxZ=parseFloat(I),Z.maxZ&&(Z.maxZ/=100));break;case"zNavigatorVisible":Z.navigatorVisible=parseInt(I,10);break;case"zToolbarVisible":Z.toolbarVisible=parseInt(I,10);break;case"zLogoVisible":I=="0"&&(Z.logoVisible=!1);break;case"zSliderVisible":I=="0"&&(Z.sliderVisible=!1);break;case"zFullPageVisible":I=="0"&&(Z.fullPageVisible=!1);break;case"zFullPageInitial":I=="1"&&(Z.fullPageInitial=!0);break;case"zProgressVisible":I=="0"&&(Z.progressVisible=!1);break;case"zTooltipsVisible":I=="0"&&(Z.tooltipsVisible=!1);break;case"zSkinPath":Z.skinPath=I;break;default:if(x==D){alert(A+" "+E)}else{switch(E){case"zZoomSpeed":Z.zoomSpeed=parseInt(I,10);break;case"zPanSpeed":Z.panSpeed=parseInt(I,10);break;case"zFadeInSpeed":Z.fadeInSpeed=parseInt(I,10);break;case"zToolbarPosition":Z.toolbarPosition=parseInt(I,10);break;case"zNavigatorWidth":isNaN(parseFloat(I))||(Z.navigatorW=parseFloat(I));break;case"zNavigatorHeight":isNaN(parseFloat(I))||(Z.navigatorH=parseFloat(I));break;case"zNavigatorLeft":isNaN(parseFloat(I))||(Z.navigatorL=parseFloat(I));break;case"zNavigatorTop":isNaN(parseFloat(I))||(Z.navigatorT=parseFloat(I));break;case"zNavigatorFit":isNaN(parseFloat(I))||(Z.navigatorFit=parseInt(I,10));break;case"zClickZoom":I=="0"&&(Z.clickZoom=!1);break;case"zClickPan":I=="0"&&(Z.clickPan=!1);break;case"zMousePan":I=="0"&&(Z.mousePan=!1);break;case"zKeys":I=="0"&&(Z.keys=!1);break;case"zConstrainPan":I=="0"&&(Z.constrainPan=!1);break;case"zWatermarkPath":Z.watermarkPath=I;break;case"zCopyrightPath":Z.copyrightPath=I;break;case"zHotspotPath":Z.hotspotPath=I;break;case"zHotspotListTitle":Z.hotspotListTitle=I;break;case"zAnnotationPath":Z.annotationPath=I;break;case"zLogoCustomPath":Z.logoCustomPath=I;break;case"zCanvas":I=="0"&&(Z.canvas=!1);if(!Z.canvasSupported||!Z.canvas){Z.useCanvas=!1}break;case"zDebug":Z.debug=parseInt(I,10);break;case"zImageProperties":Z.imageProperties=I;break;case"zServerIP":Z.serverIP=I;break;case"zServerPort":Z.serverPort=I;break;case"zTileHandlerPath":Z.tileHandlerPath=I;break;case"zEditMode":Z.editMode=I;break;case"zSaveHandlerPath":Z.saveHandlerPath=I}}}}}}}if(!Z.Utils.isStrVal(Z.tileHandlerPath)){Z.tileSource="ZoomifyImageFolder"}else{if(Z.imagePath.toLowerCase().indexOf(".pff")!=-1){if(w){Z.tileSource="ZoomifyImageFile";var k=Z.tileHandlerPath;Z.tileHandlerPathFull=k}else{alert(C)}}else{Z.tileSource="OtherTileSource"}}if(Z.Utils.isStrVal(Z.annotationPath)||Z.Utils.isStrVal(Z.saveHandlerPath)){if(M){if(Z.Utils.isStrVal(Z.saveHandlerPath)){var N=Z.saveHandlerPath;Z.saveHandlerPath=N}}else{Z.annotationPath="",alert(F)}}},removeDups:function(b){for(var a=1;a<b.length;){b[a-1]==b[a]?b.splice(a,1):a++}return b},intersect:function(f,b){var h=[];for(var d=0;d<f.length;d++){var a=f[d],c=!1;for(var g=0;g<b.length&&a>=(elmt2=b[g]);g++){if(elmt2==a){c=!0;break}}c&&h.push(f[d])}return h},subtract:function(f,b){for(var g=0;g<f.length;g++){var d=f[g],a=!1;for(var c=0;c<b.length&&d>=(elmt2=b[c]);c++){if(elmt2==d){a=!0;break}}a&&f.splice(g--,1)}return f},clone:function(g,c,k){k=[];switch(g){case"hotspots":for(var f=0,b=c.length;f<b;f++){polygonPtsTemp=[];var d=c[f].polygonPts;if(c[f].polygonPts!==null){for(var h=0,a=d.length;h<a;h++){polygonPtsTemp.push({x:d[h].x,y:d[h].y})}}k.push({id:c[f].id,internalID:c[f].internalID,name:c[f].name,media:c[f].media,mediaType:c[f].mediaType,image:c[f].image,iW:c[f].iW,iH:c[f].iH,x:c[f].x,y:c[f].y,zoom:c[f].zoom,xScale:c[f].xScale,yScale:c[f].yScale,url:c[f].url,urlTarget:c[f].urlTarget,visibility:c[f].visibility,rollover:c[f].rollover,caption:c[f].caption,tooltip:c[f].tooltip,textColor:c[f].textColor,backColor:c[f].backColor,lineColor:c[f].lineColor,fillColor:c[f].fillColor,textVisible:c[f].textVisible,backVisible:c[f].backVisible,lineVisible:c[f].lineVisible,fillVisible:c[f].fillVisible,captionPosition:c[f].captionPosition,saved:c[f].saved,polygonPts:polygonPtsTemp})}break;case"pois":for(var f=0,b=c.length;f<b;f++){k.push({text:c[f].text,value:c[f].value,x:c[f].x,y:c[f].y,zoom:c[f].zoom})}break;case"notes":for(var f=0,b=c.length;f<b;f++){k.push({text:c[f].text,value:c[f].value,noteText:c[f].noteText,poiID:c[f].poiID})}break;case"labels":for(var f=0,b=c.length;f<b;f++){k.push({text:c[f].text,value:c[f].value,poiID:c[f].poiID})}}return k},calculatePointsDistance:function(c,a,d,b){return Math.sqrt((c-=d)*c+(a-=b)*a)},getDimensionsFromPolygonPoints:function(g){var l=g[0].x,d=g[0].y,b=g[0].x,f=g[0].y;for(var m=1,c=g.length;m<c;m++){g[m].x<l&&(l=g[m].x),g[m].x>b&&(b=g[m].x),g[m].y<d&&(d=g[m].y),g[m].y>f&&(f=g[m].y)}var k=b-l,h=f-d;return new Z.Utils.Point(k,h)},getCenterOfPolygonPoints:function(g){var l=g[0].x,d=g[0].y,b=g[0].x,f=g[0].y;for(var m=1,c=g.length;m<c;m++){l=Math.min(l,g[m].x),d=Math.min(d,g[m].y),b=Math.max(b,g[m].x),f=Math.max(f,g[m].y)}var k=l+(b-l)/2,h=d+(f-d)/2;return new Z.Utils.Point(k,h)},createCallback:function(d,b){var f=[];for(var c=2,a=arguments.length;c<a;c++){f.push(arguments[c])}return function(){var h=f.concat([]);for(var e=0,g=arguments.length;e<g;e++){h.push(arguments[e])}return b.apply(d,h)}},createContainerElement:function(H,q,A,x,D,w,z,k,K,G,C,J,E,y,I,b){var B=document.createElement(H);this.isStrVal(q)&&(B.id=q);var F=B.style;return F.display=this.isStrVal(A)?A:"inline-block",F.position=this.isStrVal(x)?x:"static",F.overflow=this.isStrVal(D)?D:"hidden",H=="canvas"?(this.isStrVal(w)&&B.setAttribute("width",w),this.isStrVal(z)&&B.setAttribute("height",z)):(this.isStrVal(w)&&(F.width=w),this.isStrVal(z&&z)&&(F.height=z)),this.isStrVal(k)&&(F.left=k),this.isStrVal(K)&&(F.top=K),F.borderStyle=this.isStrVal(G)?G:"none",F.borderWidth=this.isStrVal(C)?C:"0px",F.borderColor="#696969",F.background=this.isStrVal(J)?J:"transparent none",F.margin=this.isStrVal(E)?E:"0px",F.padding=this.isStrVal(y)?y:"0px",F.whiteSpace=this.isStrVal(I)?I:"normal",this.isStrVal(b)&&(F.cursor=b),B},createCenteredElement:function(d){var b=this.createContainerElement("div"),f=[];f.push('<div style="display:table; height:100%; width:100%;'),f.push("border:none; margin:0px; padding:0px;"),f.push('#position:relative; overflow:hidden; text-align:left;">'),f.push('<div style="#position:absolute; #top:50%; width:100%; '),f.push("border:none; margin:0px; padding:0px;"),f.push('display:table-cell; vertical-align:middle;">'),f.push('<div style="#position:relative; #top:-50%; width:100%; '),f.push("border:none; margin:0px; padding:0px;"),f.push('text-align:center;"></div></div></div>'),b.innerHTML=f.join(""),b=b.firstChild;var c=b,a=b.getElementsByTagName("div");while(a.length>0){c=a[0],a=c.getElementsByTagName("div")}return c.appendChild(d),b},createGraphicElement:function(b){var a=this.createContainerElement("img"),c=null;return Z.browser==Z.browsers.IE&&Z.browserVersion<7?(c=this.createContainerElement("span",null,"inline-block"),a.onload=function(){c.style.width=c.style.width||a.width+"px",c.style.height=c.style.height||a.height+"px",a.onload=null,a=null},c.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+b+"', sizingMethod='scale')"):(c=a,c.src=b),c},createTextElement:function(H,q,A,x,D,w,z,k,K,G,C,J,E,y){var I=Z.Utils.createContainerElement("div","textBoxFor"+H,"inline-block","absolute","hidden",A,x,D,w,k,K,"white","0px",z,"normal"),b=document.createElement("textarea");I.appendChild(b);var B=b,F=B.style;return B.id=H,B.value=q,B.readOnly=C,B.overflowY=G,F.width="100%",F.height="100%",F.margin="0",F.border="0",F.fontFamily=J,F.fontSize=E,F.resize=y,I},createSelectElement:function(k,p,d,b,g,q,c,m){sList=document.createElement("select"),sList.id=k,Z.Utils.isStrVal(p)&&(sList.options[0]=new Option(p,null));for(var l=0,h=d.length;l<h;l++){sList.options[sList.options.length]=new Option(d[l].text,d[l].value)}return sList.onchange=m,sList.style.width=b+"px",sList.style.position="absolute",sList.style.left=g+"px",sList.style.top=q+"px",sList.style.visibility=c,sList},updateSelectElement:function(c,a){if(c){c.innerHTML="";for(var d=0,b=a.length;d<b;d++){c.options[c.options.length]=new Option(a[d].text,a[d].value)}}},setTextStyle:function(v,z,g,b,m,A,d,y,x,q,k,w){var p=v.parentNode.style;p.color=z,p.fontFamily=g,p.fontSize=b,p.fontSizeAdjust=m,p.fontStyle=A,p.fontStretch=d,p.fontVariant=y,p.fontWeight=x,p.lineHeight=q,p.textAlign=k,p.textDecoration=w},convertXMLTextToXMLDoc:function(c){var a=null;if(window.ActiveXObject){try{a=new ActiveXObject("Microsoft.XMLDOM"),a.async=!1,a.loadXML(c)}catch(d){this.showMessage(d.name+this.getResource("ERROR_CONVERTINGXMLTEXTTODOC")+d.message)}}else{if(window.DOMParser){try{var b=new DOMParser;a=b.parseFromString(c,"text/xml")}catch(d){this.showMessage(d.name+this.getResource("ERROR_CONVERTINGXMLTEXTTODOC")+d.message)}}else{this.showMessage(this.getResource("ERROR_XMLDOMUNSUPPORTED"))}}return a},convertXMLDocToXMLText:function(b){var a=null;if(window.ActiveXObject){try{a=b.xml}catch(c){this.showMessage(c.name+this.getResource("ERROR_CONVERTINGXMLDOCTOTEXT")+c.message)}}else{if(window.DOMParser){try{a=(new XMLSerializer).serializeToString(b)}catch(c){this.showMessage(c.name+this.getResource("ERROR_CONVERTINGXMLDOCTOTEXT")+c.message)}}else{this.showMessage(this.getResource("ERROR_XMLDOMUNSUPPORTED"))}}return a},Point:function(b,a){this.x=typeof b=="number"?b:0,this.y=typeof a=="number"?a:0},Point3D:function(b,a,c){this.x=typeof b=="number"?b:0,this.y=typeof a=="number"?a:0,this.z=typeof c=="number"?c:0},getResource:function(b){var a="";switch(b){case"DEFAULT_PARAMETERSENABLETEST":a="Enable Developer parameters";break;case"DEFAULT_PARAMETERSDISABLEVALUE":a="Changing This Violates License Agreement";break;case"DEFAULT_PARAMETERSDISABLEDALERT":a="Support for this parameter is enabled only in the Zoomify Image Viewer included in the Zoomify HTML5 Developer edition: ";break;case"DEFAULT_PFFSUPPORTENABLETEST":a="Changing this violates License Agreement";break;case"DEFAULT_PFFSUPPORTDISABLEVALUE":a="Changing this violates License Agreement";break;case"DEFAULT_PFFSUPPORTDISABLEDALERT":a="Support for PFF single file storage is enabled only in the Zoomify Image Viewer included in the Zoomify Enterprise products.";break;case"DEFAULT_ANNOTATIONSUPPORTENABLETEST":a="Changing this violates License Agreement";break;case"DEFAULT_ANNOTATIONSUPPORTDISABLEVALUE":a="Changing this violates License Agreement";break;case"DEFAULT_ANNOTATIONSUPPORTDISABLEDALERT":a="Support for annotations is enabled only in the Zoomify Image Viewer included in the Zoomify Enterprise products.";break;case"DEFAULT_IMAGESLOADINGMAX":a="200";break;case"DEFAULT_IMAGELOADTIMEOUT":a="30000";break;case"DEFAULT_TIERSMAXSCALEUP":a="1.15";break;case"DEFAULT_TILESMAXCACHE":Z.mobileDevice?a="50":a="300";break;case"DEFAULT_BACKFILLTHRESHOLD2":a="6";break;case"DEFAULT_BACKFILLTHRESHOLD1":a="3";break;case"DEFAULT_BACKFILLCHOICE2":a="3";break;case"DEFAULT_BACKFILLCHOICE1":a="2";break;case"DEFAULT_BACKFILLCHOICE0":a="0";break;case"DEFAULT_PANBUFFER":Z.mobileDevice?a="1":a="1.5";break;case"DEFAULT_PANSPEED":a="5";break;case"DEFAULT_PANSTEPDISTANCE":a="10";break;case"DEFAULT_ZOOMSPEED":a="5";break;case"DEFAULT_ZOOMSTEPDISTANCE":a="0.02";break;case"DEFAULT_ZAPSTEPDURATION":a="30";break;case"DEFAULT_ZAPTVSTEPS":a="20";break;case"DEFAULT_ZAPTVDURATION":a="800";break;case"DEFAULT_CLICKZOOMTIERSKIPTHRESHOLD":a="0.2";break;case"DEFAULT_GESTURETESTDURATION":a="10";break;case"DEFAULT_FADEINSPEED":a="5";break;case"DEFAULT_FADEINSTEP":a="0.067";break;case"DEFAULT_TOOLBARVISIBLE":a="4";break;case"DEFAULT_TOOLBARPOSITION":a="1";break;case"DEFAULT_TOOLTIPSVISIBLE":a="1";break;case"DEFAULT_NAVIGATORVISIBLE":a="2";break;case"DEFAULT_NAVIGATORWIDTH":a="150";break;case"DEFAULT_NAVIGATORHEIGHT":a="100";break;case"DEFAULT_NAVIGATORLEFT":a="0";break;case"DEFAULT_NAVIGATORTOP":a="0";break;case"DEFAULT_NAVIGATORFIT":a=null;break;case"DEFAULT_NAVIGATORBACKCOLOR":a="#ffffff";break;case"DEFAULT_NAVIGATORBACKCOLORNOALPHA":a="#fbfafa";break;case"DEFAULT_NAVIGATORBACKALPHA":a="0.75";break;case"DEFAULT_ANNOTATIONPANELBACKCOLOR":a="#ffffff";break;case"DEFAULT_ANNOTATIONPANELBACKCOLORNOALPHA":a="#fbfafa";break;case"DEFAULT_ANNOTATIONPANELBACKALPHA":a="0.75";break;case"DEFAULT_NAVIGATORRECTANGLECOLOR":a="blue";break;case"DEFAULT_SKINXMLFILE":a="skinFiles.xml";break;case"DEFAULT_SKINXMLPATH":a="Assets/Skins/Default";break;case"DEFAULT_SKINMODE":a="0";break;case"DEFAULT_CONSTRAINPAN":a="1";break;case"DEFAULT_SLIDERVISIBLE":a="1";break;case"DEFAULT_SLIDERTESTDURATION":a="10";break;case"DEFAULT_FULLPAGEVISIBLE":a="1";break;case"DEFAULT_FULLPAGEINITIAL":a="0";break;case"DEFAULT_FULLPAGEBACKCOLOR":a="white";break;case"DEFAULT_FPCANCELBUTTONTEXT":a="X";break;case"DEFAULT_FPCANCELBUTTONCOLOR":a="	#F8F8F8";break;case"DEFAULT_PROGRESSVISIBLE":a="1";break;case"DEFAULT_PROGRESSDURATION":a="500";break;case"DEFAULT_PROGRESSTEXT":a=" ";break;case"DEFAULT_LOGOVISIBLE":a="1";break;case"DEFAULT_LOGOCUSTOMPATH":a=null;break;case"DEFAULT_CANVAS":a="1";break;case"DEFAULT_DEBUG":a="0";break;case"DEFAULT_MESSAGESCREENCOLOR":a="lightgray";break;case"DEFAULT_MESSAGEBUTTONCOLOR":a="white";break;case"DEFAULT_MESSAGEOKBUTTONTEXT":a="OK";break;case"DEFAULT_MESSAGECANCELBUTTONTEXT":a="Cancel";break;case"DEFAULT_COPYRIGHTSCREENCOLOR":a="lightgray";break;case"DEFAULT_COPYRIGHTBUTTONCOLOR":a="white";break;case"DEFAULT_COPYRIGHTAGREEBUTTONTEXT":a="Agree";break;case"DEFAULT_COPYRIGHTEXITBUTTONTEXT":a="Exit";break;case"DEFAULT_WATERMARKALPHA":a="0.6";break;case"DEFAULT_WATERMARKMINSCALE":a="0.33";break;case"DEFAULT_WATERMARKSPANW":a="512";break;case"DEFAULT_WATERMARKSPANH":a="384";break;case"DEFAULT_HOTSPOTSXMLFILE":a="hotspots.xml";break;case"DEFAULT_HOTSPOTCAPTIONPADDING":a="6";break;case"DEFAULT_MINHOTSPOTCAPTIONPADDING":a="2";break;case"DEFAULT_MAXHOTSPOTCAPTIONPADDING":a="7";break;case"DEFAULT_HOTSPOTCAPTIONFONTSIZE":a="14";break;case"DEFAULT_MINHOTSPOTCAPTIONFONTSIZE":a="3";break;case"DEFAULT_MAXHOTSPOTCAPTIONFONTSIZE":a="14";break;case"DEFAULT_FONTTOPIXELSCONVERSIONFACTOR":a="1.8";break;case"DEFAULT_HOTSPOTSINITIALVISIBILITY":a=!0;break;case"DEFAULT_POLYGONLINEWIDTH":a=1;break;case"DEFAULT_CONTROLPOINTLINEWIDTH":a="1";break;case"DEFAULT_CONTROLPOINTSTROKECOLOR":a="#ffffff";break;case"DEFAULT_FIRSTCONTROLPOINTFILLCOLOR":a="#ffffff";break;case"DEFAULT_STANDARDCONTROLPOINTFILLCOLOR":a="#999999";break;case"DEFAULT_CONTROLPOINTRADIUS":a="10";break;case"DEFAULT_HOTSPOTLISTTITLE":a="Hotspots";break;case"DEFAULT_HOTSPOTLISTSOURCE":a="NAME";break;case"DEFAULT_HOTSPOTLISTWIDTH":a="200";break;case"DEFAULT_HOTSPOTLISTPOSITION":a="2";break;case"DEFAULT_ANNOTATIONSXMLFILE":a="annotations.xml";break;case"DEFAULT_ANNOTATIONSXMLSAVEHANDLERNAME1":a="save";break;case"DEFAULT_ANNOTATIONSXMLSAVEHANDLERNAME2":a="upload";break;case"DEFAULT_ANNOTATIONSINITIALVISIBILITY":a=!0;break;case"DEFAULT_ANNOTATIONPANELWIDTH":a="220";break;case"DEFAULT_ANNOTATIONPANELHEIGHT":a="200";break;case"DEFAULT_ANNOTATIONLISTWIDTH":a="160";break;case"DEFAULT_ANNOTATIONNOTEWIDTH":a="189";break;case"DEFAULT_ANNOTATIONNOTEHEIGHT":a="88";break;case"DEFAULT_ANNOTATIONNOTEPADDING":a="6";break;case"DEFAULT_ANNOTATIONNOTEFONTSIZE":a="11";break;case"DEFAULT_ANNOTATIONNOTEVISIBILITY":a=!0;break;case"DEFAULT_ANNOTATIONPANELLABELFONTSIZE":a="11";break;case"DEFAULT_INITIALX":a=null;break;case"DEFAULT_INITIALY":a=null;break;case"DEFAULT_INITIALZOOM":a=null;break;case"DEFAULT_MINZOOM":a=null;break;case"DEFAULT_MAXZOOM":a="1";break;case"DEFAULT_CLICKZOOM":a="1";break;case"DEFAULT_CLICKPAN":a="1";break;case"DEFAULT_MOUSEPAN":a="1";break;case"DEFAULT_KEYS":a="1";break;case"DEFAULT_TRACEDISPLAYDEBUGINFOTEXT":a="This panel is enabled using the HTML parameter 'zDebug=1' (basic) or 'zDebug=2' (adds tile tracing). It can be called in JavaScript as follows:\n\n   Z.Utils.trace('value to display');  \n\nThe buttons below display or modify important state values.  Web designers new to JavaScript will also benefit from the console, trace, profiling, and other debugging features of leading browsers.";break;case"DEFAULT_TRACEDISPLAYSCREENCOLOR":a="lightgray";break;case"DEFAULT_TRACEDISPLAYBUTTONCOLOR":a="white";break;case"DEFAULT_TRACEDISPLAYSHOWGLOBALSBUTTONTEXT":a="Show Globals";break;case"DEFAULT_TRACEDISPLAYTOGGLEDISPLAYBUTTONTEXT":a="Toggle Display";break;case"DEFAULT_TRACEDISPLAYTOGGLEBACKFILLBUTTONTEXT":a="Toggle Backfill";break;case"DEFAULT_TRACEDISPLAYTOGGLECONSTRAINPANBUTTONTEXT":a="Toggle Constrain Pan";break;case"ALERT_POLYGONSREQUIRECANVAS":a="Displaying or editing polygon hotspots requires a browser that supports the HTML5 canvas feature.";break;case"ALERT_CANCELLINGUNSAVEDEDITS":a="Cancelling all unsaved edits.";break;case"ALERT_SAVINGUNSAVEDEDITS":a="Saving unsaved edits.";break;case"ALERT_ANNOTATIONSAVESUCCESSFUL":a="XML save complete.";break;case"ALERT_SAVEDISABLEDFORDEMOKEY":a="SAVEDISABLEDFORDEMO";break;case"ALERT_SAVEDISABLEDFORDEMOTEXT":a="Edits to this demo are saved only for the duration of the browser session.";break;case"ERROR_XMLHTTPREQUESTUNSUPPORTED":a="Browser does not support XMLHttpRequest.";break;case"ERROR_MAKINGNETWORKREQUEST-IMAGEXML":a="Error loading image: please make sure image path in web page matches image folder location on webserver.";break;case"ERROR_MAKINGNETWORKREQUEST-IMAGEHEADER":a="Error loading image: image header request invalid.";break;case"ERROR_MAKINGNETWORKREQUEST-IMAGEOFFSET":a="Error loading image: image offset request invalid.";break;case"ERROR_MAKINGNETWORKREQUEST-TOOLBARXML":a="Error loading toolbar - skin files not found: please verify that the folders 'Assets/Skins/Default' are in same folder as the web page displaying the Viewer, or add zSkinPath parameter to web page.";break;case"ERROR_MAKINGNETWORKREQUEST-HOTSPOTSXML":a="Error loading hotspots: please make sure hotspot path in web page matches hotspot folder location on webserver.";break;case"ERROR_MAKINGNETWORKREQUEST-ANNOTATIONSXML":a="Error loading annotations: please make sure annotation path in web page matches annotation folder location on webserver.";break;case"ERROR_MAKINGNETWORKREQUEST-ANNOTATIONSSAVEHANDLER":a="Error saving annotations: please make sure save handler path in web page matches save handler file location on webserver.";break;case"ERROR_MAKINGNETWORKREQUEST":a="Error making network request: possible invalid path or network error.";break;case"ERROR_IMAGEPATHINVALID":a="Image failed to load: possible invalid path, missing image, or network error.";break;case"ERROR_TILEPATHINVALID":a="Sorry!  Part of this view isn't refreshing.  The network may be slow, or the website might be missing a file:  ";break;case"ERROR_HOTSPOTPATHINVALID":a="Hotspot media failed to load: possible invalid path, missing file, or legacy hotspot media such as library clip of Flash-based viewer.";break;case"ERROR_HOTSPOTMEDIAINVALID":a="Media of one or more hotspots unsupported: hotspot media of type 'symbol' depend on internal Library of Flash-based viewers.";break;case"ERROR_XMLSAVEHANDLERPATHINVALID":a="Annotations cannot be saved: missing or incorrect save handler path parameter, or missing file on server.";break;case"ERROR_NETWORKSECURITY":a="Error related to network security: ";break;case"ERROR_NETWORKSTATUS":a="Error related to network status: ";break;case"ERROR_CONVERTINGXMLTEXTTODOC":a=" converting XML text to XML doc (DOMParser): ";break;case"ERROR_CONVERTINGXMLDOCTOTEXT":a=" converting XML doc to XML text (DOMParser): ";break;case"ERROR_XMLDOMUNSUPPORTED":a="Browser does not support XML DOM.";break;case"ERROR_XMLDOCINVALID":a="XML Doc invalid.";break;case"ERROR_XMLINVALID":a="XML invalid.";break;case"ERROR_IMAGEXMLINVALID":a="Image XML invalid.";break;case"ERROR_IMAGEPROPERTIESPARAMETERINVALID":a="Image properties parameter invalid.";break;case"ERROR_IMAGETILECOUNTINVALID":a="Image tile count does not match value in image XML. If the count is invalid display problems can result.";break;case"ERROR_EXECUTINGCALLBACK":a=" while executing callback: ";break;case"ERROR_IMAGEREQUESTTIMEDOUT":a="Image timed out: ";break;case"ERROR_NAVIGATORIMAGEPATHINVALID":a="Navigator image failed to load: possible invalid path, missing image, or network error.";break;case"ERROR_SKINXMLINVALID":a="Skin XML invalid.";break;case"ERROR_SKINXMLMISSINGNAMES":a="The skin XML file has one or more faulty name lines.";break;case"ERROR_WATERMARKPATHINVALID":a="Watermark image failed to load: ";break;case"ERROR_UNKNOWNELEMENTSTYLE":a="Unknown element style - no known method to identify.";break;case"ERROR_UNKNOWNMOUSEPOSITION":a="Unknown mouse position - no known method to calculate.";break;case"ERROR_UNKNOWNMOUSESCROLL":a="Unknown mouse scroll - no known method to calculate.";break;case"ERROR_UNKNOWNWINDOWSIZE":a="Unknown window size - no known method to calculate.";break;case"TIP_LOGO":a="Launch Zoomify Website";break;case"TIP_MINIMIZE":a="Minimize Toolbar";break;case"TIP_EXPAND":a="Expand Toolbar";break;case"TIP_ZOOMOUT":a="Zoom Out";break;case"TIP_SLIDER":a="Zoom In And Out";break;case"TIP_ZOOMIN":a="Zoom In";break;case"TIP_PANLEFT":a="Pan Left";break;case"TIP_PANUP":a="Pan Up";break;case"TIP_PANDOWN":a="Pan Down";break;case"TIP_PANRIGHT":a="Pan Right";break;case"TIP_RESET":a="Reset Initial View";break;case"TIP_TOGGLEFULLPAGE":a="Toggle Full Page View";break;case"TIP_CANCELFULLPAGE":a="Cancel Full Page View";break;case"TIP_TOGGLEEDITMODE":a="Toggle Label Editing";break;case"TIP_EDITDELETE":a="Delete Label Selected in Choicelist";break;case"TIP_EDITCANCEL":a="Cancel Edits To Current Label";break;case"TIP_EDITSAVE":a="Save All Label Edits";break;case"TIP_MESSAGEOK":a="Accept and close message";break;case"TIP_MESSAGECANCEL":a="Decline and close message";break;case"TIP_COPYRIGHTAGREE":a="Agree to copyright and view images";break;case"TIP_COPYRIGHTEXIT":a="Exit and do not view images";break;case"TIP_SHOWGLOBALS":a="Toggle Full Page View";break;case"TIP_TOGGLEDISPLAY":a="Toggle Viewport Display";break;case"TIP_TOGGLEBACKFILL":a="Toggle Viewport Backfill";break;case"TIP_TOGGLECONSTRAINPAN":a="Toggle Constrain Pan";break;case"UI_ANNOTATIONPANELLABELPOI":a="POI";break;case"UI_ANNOTATIONPANELLABELNOTE":a="Note";break;case"UI_ANNOTATIONPANELLABELLABEL":a="Label";break;case"CONTENT_SKIPUSERNAMENAME":a="Anonymous";break;case"CONTENT_POINAME":a="Unnamed Point Of Interest";break;case"CONTENT_POIUSER":a=this.getResource("CONTENT_SKIPUSERNAMENAME");break;case"CONTENT_NOTENAME":a="Unnamed Note";break;case"CONTENT_NOTETEXT":a="Note text";break;case"CONTENT_NOTEUSER":a=this.getResource("CONTENT_SKIPUSERNAMENAME");break;case"CONTENT_LABELNAME":a="Unnamed Label";break;case"CONTENT_LABELUSER":a=this.getResource("CONTENT_SKIPUSERNAMENAME");break;case"CONTENT_ANNOTATIONPLACEHOLDERLISTTEXT":a="List creation in progress...";break;case"CONTENT_ANNOTATIONPLACEHOLDERNOTETEXT":a="Note loading in progress...";break;case"CONTENT_ANNOTATIONSCAPTIONTEXTCOLOR":a="#000000";break;case"CONTENT_ANNOTATIONSCAPTIONBACKCOLOR":a="#ffffff";break;case"CONTENT_ANNOTATIONSCAPTIONBACKVISIBLE":a="1";break;case"CONTENT_ANNOTATIONSCAPTIONPOSITION":a="8";break;case"CONTENT_POLYGONLINECOLOR":a="#ffff00";break;case"CONTENT_POLYGONFILLCOLOR":a="#ffffff";break;case"CONTENT_POLYGONLINEVISIBLE":a="1";break;case"CONTENT_POLYGONFILLVISIBLE":a="1";break;default:a="Unexpected resource request"}return a},showGlobals:function(){var a="";a+="\n",a+="                            ZOOMIFY IMAGE VIEWER - CURRENT VALUES\n",a+="\n",a+="IMAGE & SKIN:    ",a+="Z.imagePath="+Z.imagePath+",   ",a+="Z.skinPath="+Z.skinPath+",   ",a+="Z.skinMode="+Z.skinMode+",   ",a+="Z.imageW="+Z.imageW+",   ",a+="Z.imageH="+Z.imageH+",   ",a+="tierCount="+Z.Viewport.getTierCount()+",   ",a+="TILE_SIZE="+Z.Viewport.getTileSize()+"\n",a+="\n",a+="PAGE & BROWSER:    ",a+="Z.pageContainer="+Z.pageContainer+",   ",a+="Z.browser="+Z.browser+",   ",a+="Z.browserVersion="+Z.browserVersion+",   ",a+="Z.canvasSupported="+Z.canvasSupported+",   ",a+="Z.cssTransformsSupported="+Z.cssTransformsSupported+",   ",a+="Z.cssTransformProperty="+Z.cssTransformProperty+",   ",a+="Z.cssTransformNoUnits="+Z.cssTransformNoUnits+",   ",a+="Z.alphaSupported="+Z.alphaSupported+",   ",a+="Z.renderQuality="+Z.renderQuality+",   ",a+="Z.mobileDevice="+Z.mobileDevice+"\n",a+="\n",a+="VIEWER OPTIONS & DEFAULTS:    ",a+="Z.initialX="+Z.initialX+",   ",a+="Z.initialY="+Z.initialY+",   ",a+="Z.initialZ="+Z.initialZ+",   ",a+="Z.minZ="+Z.minZ+",   ",a+="Z.maxZ="+Z.maxZ+",   ",a+="Z.fitZ="+Z.fitZ+",   ",a+="Z.zoomSpeed="+Z.zoomSpeed+",   ",a+="Z.panSpeed="+Z.panSpeed+",   ",a+="Z.fadeInSpeed="+Z.fadeInSpeed+",   ",a+="Z.toolbarVisible="+Z.toolbarVisible+",   ",a+="Z.toolbarW="+Z.toolbarW+",   ",a+="Z.toolbarCurrentW="+Z.toolbarCurrentW+",   ",a+="Z.toolbarH="+Z.toolbarH+",   ",a+="Z.toolbarPosition="+Z.toolbarPosition+",   ",a+="Z.tooltipsVisible="+Z.tooltipsVisible+",   ",a+="Z.navigatorVisible="+Z.navigatorVisible+",   ",a+="Z.navigatorW="+Z.navigatorW+",   ",a+="Z.navigatorH="+Z.navigatorH+",   ",a+="Z.navigatorL="+Z.navigatorL+",   ",a+="Z.navigatorT="+Z.navigatorT+",   ",a+="Z.navigatorFit="+Z.navigatorFit+",   ",a+="Z.clickZoom="+Z.clickZoom+",   ",a+="Z.clickPan="+Z.clickPan+",   ",a+="Z.mousePan="+Z.mousePan+",   ",a+="Z.keys="+Z.keys+",   ",a+="Z.constrainPan="+Z.constrainPan+",   ",a+="Watermark alpha = "+Z.Utils.getResource("DEFAULT_WATERMARKALPHA")+",   ",a+="Z.watermarkPath="+Z.watermarkPath+",   ",a+="Z.copyrightPath="+Z.copyrightPath+",   ",a+="Z.hotspotPath="+Z.hotspotPath+",   ",a+="Z.annotationPath="+Z.annotationPath+",   ",a+="Z.saveHandlerPath="+Z.saveHandlerPath+",   ",a+="Z.sliderVisible="+Z.sliderVisible+",   ",a+="Z.fullPageVisible="+Z.fullPageVisible+",   ",a+="Z.fullPageInitial="+Z.fullPageInitial+",   ",a+="Z.progressVisible="+Z.progressVisible+",   ",a+="Z.logoVisible="+Z.logoVisible+",   ",a+="Z.logoCustomPath="+Z.logoCustomPath+",   ",a+="Z.canvas="+Z.canvas+",   ",a+="Z.debug="+Z.debug+",   ",a+="Z.imageProperties="+Z.imageProperties+",   ",a+="Z.serverIP="+Z.serverIP+",   ",a+="Z.serverPort="+Z.serverPort+",   ",a+="Z.tileHandlerPath="+Z.tileHandlerPath+",   ",a+="Z.tileHandlerPathFull="+Z.tileHandlerPathFull+",   ",a+="Z.tileSource="+Z.tileSource+",   ",a+="Z.zEditMode="+Z.zEditMode+"\n",a+="\n",a+="INTERNAL VALUES:    ",a+="\n",a+="displayW="+Z.Viewport.getW()+",   ",a+="displayH="+Z.Viewport.getH()+",   ",a+="tierCurrent="+Z.Viewport.getTierCurrent()+",   ",a+="tierScale="+Z.Viewport.getTierScale()+",   ",a+="TIERS_MAX_SCALE_UP="+Z.Viewport.getTiersMaxScaleUp()+",   ",a+="TIERS_MAX_SCALE_DOWN="+Z.Viewport.getTiersMaxScaleDown()+",   ",a+="TILES_MAX_CACHE="+Z.Viewport.getTilesMaxCache()+",   ",a+="Z.useCanvas="+Z.useCanvas+"\n",a+="\n",a+="INTERNAL LISTS:    ",a+="tierWs="+Z.Viewport.getTierWs()+",   ",a+="tierHs="+Z.Viewport.getTierHs()+",   ",a+="tierTileCounts="+Z.Viewport.getTierTileCounts()+",   ",a+="tilesLoadingNames="+Z.Viewport.getTilesLoadingNames()+"\n",a+="\n",alert(a)},showMessage:function(a){Z.MessageDisplay?(Z.messages&&(Z.messages.value=a),Z.MessageDisplay.style.display="inline-block",typeof Z.MessageDisplay.messageTimer!="undefined"&&Z.MessageDisplay.messageTimer!==null&&window.clearTimeout(Z.MessageDisplay.messageTimer)):Z.Utils.configureMessageDisplay(a),Z.MessageDisplay.messageTimer=window.setTimeout(Z.Utils.hideMessageTimerHandler,2000)},hideMessage:function(){Z.MessageDisplay.style.display="none"},hideMessageTimerHandler:function(){Z.MessageDisplay.messageTimer&&(window.clearTimeout(Z.MessageDisplay.messageTimer),Z.MessageDisplay.messageTimer=null),Z.Utils.hideMessage()},configureMessageDisplay:function(z){var F=430,m=100,b=Z.viewerW-F-80,w=Z.viewerH-m-80,G=this.getResource("DEFAULT_MESSAGESCREENCOLOR"),k=this.getResource("DEFAULT_MESSAGEBUTTONCOLOR");Z.MessageDisplay=this.createContainerElement("div","MessageDisplay","inline-block","absolute","hidden",F+"px",m+"px",b+"px",w+"px","solid","1px",G,"0px","0px","normal"),Z.ViewerDisplay.appendChild(Z.MessageDisplay);var E=Z.Utils.createTextElement("messageBox",z,F-18+"px",m-40+"px","4px","4px","4px","solid","1px","auto",!0,"verdana","12px","none");Z.MessageDisplay.appendChild(E),Z.messages=document.getElementById("messageBox");var C=56,y=18,q=10,B=5,x=F,g=m-y-B,A;x-=C+q,A=this.getResource("DEFAULT_MESSAGEOKBUTTONTEXT");var D=new Z.Utils.Button("buttonOk",A,null,null,null,null,C+"px",y+"px",x+"px",g+"px","mousedown",this.messageOkButtonHandler,"TIP_MESSAGEOK","solid","1px",k,"0px","0px");Z.MessageDisplay.appendChild(D.elmt)},messageOkButtonHandler:function(a){return Z.Utils.hideMessage(),!0},messageCancelButtonHandler:function(a){return Z.Utils.hideMessage(),!1},showTraces:function(){Z.TraceDisplay?Z.TraceDisplay.style.display="inline-block":Z.Utils.configureTraceDisplay()},hideTraces:function(){Z.TraceDisplay.style.display="none"},configureTraceDisplay:function(){var H=Z.viewerW/3,q=Z.viewerH/3+45,A=10,x=Z.viewerH/3,D=this.getResource("DEFAULT_TRACEDISPLAYSCREENCOLOR");Z.TraceDisplay=this.createContainerElement("div","TraceDisplay","inline-block","absolute","hidden",H+"px",q+"px",A+"px",x+"px","solid","1px",D,"0px","10px","normal"),Z.ViewerDisplay.appendChild(Z.TraceDisplay);var w="Trace Values\n",z=Z.Utils.createTextElement("debugTraces",w,H-15+"px",q-60+"px","10px","10px","5px","solid","1px","auto",!0,"verdana","10px","none");Z.TraceDisplay.appendChild(z),Z.traces=document.getElementById("debugTraces");var k=58,K=42,G=20,C=q-K/2-10,J=10,E=this.getResource("DEFAULT_TRACEDISPLAYBUTTONCOLOR"),y=this.getResource("DEFAULT_TRACEDISPLAYSHOWGLOBALSBUTTONTEXT"),I=new this.Button("buttonShowGlobals",y,null,null,null,null,k+"px",K+"px",G+"px",C+"px","mousedown",this.showGlobals,"TIP_SHOWGLOBALS","solid","1px",E,"0px","0px");Z.TraceDisplay.appendChild(I.elmt),G+=k+J;var y=this.getResource("DEFAULT_TRACEDISPLAYTOGGLEDISPLAYBUTTONTEXT"),b=new this.Button("buttonToggleDisplay",y,null,null,null,null,k+"px",K+"px",G+"px",C+"px","mousedown",Z.Viewport.toggleDisplay,"TIP_TOGGLEDISPLAY","solid","1px",E,"0px","0px");Z.TraceDisplay.appendChild(b.elmt),G+=k+J;var y=this.getResource("DEFAULT_TRACEDISPLAYTOGGLEBACKFILLBUTTONTEXT"),B=new this.Button("buttonToggleBackfill",y,null,null,null,null,k+"px",K+"px",G+"px",C+"px","mousedown",Z.Viewport.toggleBackfill,"TIP_TOGGLEBACKFILL","solid","1px",E,"0px","0px");Z.TraceDisplay.appendChild(B.elmt),G+=k+J,k+=12;var y=this.getResource("DEFAULT_TRACEDISPLAYTOGGLECONSTRAINPANBUTTONTEXT"),F=new this.Button("buttonToggleConstrainPan",y,null,null,null,null,k+"px",K+"px",G+"px",C+"px","mousedown",Z.Viewport.toggleConstrainPan,"TIP_TOGGLECONSTRAINPAN","solid","1px",E,"0px","0px");Z.TraceDisplay.appendChild(F.elmt)},trace:function(a){Z.TraceDisplay||Z.Utils.configureTraceDisplay(),Z.traces&&(Z.traces.value+="\n"+a+"\n")},drawCenterLines:function(d,b,f){var c=Z.Utils.createContainerElement("div","viewportCenterLineVertical","inline-block","absolute","visible","1px",f+"px",b/2+"px","0px","solid","1px","transparent none","0px","0px","normal"),a=Z.Utils.createContainerElement("div","viewportCenterLineHorizontal","inline-block","absolute","visible",b+"px","1px","0px",f/2+"px","solid","1px","transparent none","0px","0px","normal");d.appendChild(a),d.appendChild(c)}};